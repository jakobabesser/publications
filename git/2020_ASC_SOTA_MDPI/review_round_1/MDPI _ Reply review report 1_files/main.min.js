(function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};window.sortItems=function(t){var n,i,r,a,o;return r=t.data("field"),n=$.url(!0).param("sort_field"),i=$.url(!0).param("sort"),i=r===n?"ASC"===i?"DESC":"ASC":"ASC"===i?"ASC":"DESC",o=window.location.href.replace(/&?sort_field=[\w\.]+&?/,"").replace(/&?sort=\w+&?/i,""),a="sort_field="+r+"&sort="+i,window.location=e.call(o,"?")>=0?o+"&"+a:o+"?"+a},window.showNotes=function(e,t,n,i,r,a){var o,l,s;return null==n&&(n=!0),null==i&&(i=null),null==r&&(r=null),null==a&&(a={}),o=$(t).dialog({modal:n,autoOpen:!1,width:null!=(l=a.width)?l:500,height:null!=(s=a.height)?s:300,resizable:!0}),i&&o.on("dialogopen",function(e,t){return i(e,t)}),r&&o.on("dialogclose",function(e,t){return r(e,t)}),$("body").on("click",e,function(n){return n.preventDefault(),e=$(this),$(t).load(e.data("load-url"),function(){return $("html").data("notes_icon",e.find("img")),o.dialog("open")})}),window.showWarnMsg=function(e,t,n){return $(e).on("blur",function(e){var i,r,a,o,l,s,c;return e.preventDefault(),l=$(t).data("user-info"),r=l.indexOf(","),s=l.substring(0,r),c=s.substring(0,s.indexOf(" "))+"."+s.substring(s.indexOf(" ")),a=s.substring(0,1)+"."+s.substring(s.indexOf(" ")),o=l.substring(r+1),(i=$(this).val()).indexOf(o)>=0||i.indexOf(s)>=0||i.indexOf(a)>=0||i.indexOf(c)>=0?$("#showWarnMsg").html("<div style='color:red'>"+n+"</div>"):$("#showWarnMsg").html("")})}},window.tableFilter=function(e){var t;return t={clearFiltersControls:[$("#cleanfilters")]},$(e).tableFilter(t)},window.tableSorter=function(e){var t;return t={widgets:["zebra"],widthFixed:!0,textExtraction:function(e){return $(e).data("sort-value")?$(e).data("sort-value"):$(e).text()}},$(e).tablesorter(t)},$.clearFormData=function(){return $("form.autoSave").each(function(e,t){var n;return n=$(t).attr("action"),$(t).data("auto-save-key")&&(n=$(t).data("auto-save-key")),$.localStorage(n,null)})},$.alertSuccess=function(e,t){return null==t&&(t="Success"),$.alert({icon:"fa fa-check",type:"blue",title:t,content:e})},$.alertError=function(e,t){return null==t&&(t="Error"),$.alert({icon:"fa fa-warning",type:"red",title:t,content:e})},$.fn.extend({preventDuplicateSubmission:function(){return $(this).on("submit",function(e){return!0===$(this).data("submitted")?e.preventDefault():$(this).data("submitted",!0)}),this}}),$.fn.extend({scrollToError:function(){var e;if((e=$(this).find(".error:visible").first())&&e.length>0)return $("html, body").animate({scrollTop:e.offset().top},500)}}),$(function(){return $(document).ajaxError(function(e,t){if(401===t.status&&t.responseText)return window.location=t.responseText})}),$(function(){return window.tableFilter(".table-filter"),window.tableSorter(".table-sorter")}),$(function(){var e;return $("input[data-url]").on("click",function(){return $(this).prop("disabled",!0),window.location=$(this).data("url")}),$("body").find("div[data-auto-load-url]").each(function(){return $(this).load($(this).data("auto-load-url"))}),$("table").on("click","th[data-field]",function(){return sortItems($(this))}),$(".sticky-block").mdpiSticky(),$("#review_information_left_block").mdpiSticky(),$(".open-new-window").on("click",function(e){var t;return e.preventDefault(),t=$(this).prop("href"),window.open(t,"popUp","width=1200,height=800,scrollbars=yes")}),(e=function(){var e;return(e=$(window).scrollTop())>200?$("#scrolltop").fadeIn():$("#scrolltop").fadeOut(),document.body.scrollHeight-e>$(window).height()+200?$("#scrollbottom").fadeIn():$("#scrollbottom").fadeOut()})(),$(window).scroll(function(){return e()}),$("#scrolltop").click(function(){return $("html,body").animate({scrollTop:0})}),$("#scrollbottom").click(function(){return $("html,body").animate({scrollTop:document.body.scrollHeight})}),function(){var e,t;return e=$("li.active").parent(".menu"),t=e.prev(".menu-caption"),t.find("i.arrow").removeClass("fa-angle-right fa-angle-down").addClass("fa-angle-down"),e.show()}(),function(){return $(".menu").find("a[data-notify-url]").each(function(){var e,t;return t=$(this).data("notify-url"),e=$(this).siblings(".notify-num"),$.get(t,function(t){return t>0?(t>=100&&(t="99+"),e.html(t).show()):e.html("").hide()})})}(),$(".menu-caption span").on("click",function(e){var t,n,i,r;return r=$(this).parent(),i=r.next("ul.menu"),t=r.find("i.arrow"),n=i.is(":visible")?"fa-angle-right":"fa-angle-down",t.removeClass("fa-angle-right fa-angle-down").addClass(n),i.slideToggle(function(e){var t,n;return t={},$("#left-menu-main-container ul.menu").each(function(e,n){return t[$(this).data("menu")]=$(this).is(":visible")?1:0}),n=SusyConfig.url.user_save_menus_url,$.post(n,{data:t})})})}),$(function(){return $(".chosen-select").chosen({width:"100%",search_contains:!0}),$(".date-select").datepicker({dateFormat:"yy-mm-dd",showAnim:"fadeIn",changeMonth:!0,changeYear:!0,onChangeMonthYear:function(e,t,n){var i;if(i=$(this).datepicker("getDate"))return e!==i.getYear()||t-1!==i.getMonth()?(i.setYear(e),i.setMonth(t-1),$(this).datepicker("setDate",i)):void 0}}),$(".send-mail-to").on("click",function(e){var t,n,i,r,a,o;if(e.preventDefault(),i=$(this).data("email-prefix"))return n=i+"@mdpi.com",r={},(a=$(this).data("subject"))&&(r.subject=a),(t=$(this).data("body"))&&(r.body=t),o="mailto:"+n,Object.keys(r).length>0&&(o+="?"+$.param(r).replace(/\+/g,"%20")),window.location.href=o}),$(".tag-editor").tagEditor({delimiter:";",maxLength:200,forceLowercase:!1,joinWithSpace:!0}),$(".export-report-btn").on("click",function(e){var t;return e.preventDefault(),t=$(this).data("uri"),$.post(t,function(e){return"success"===e.status&&e.message?$.alertSuccess(e.message):$.alertError("Failed!")}).fail(function(){return $.alertError("Failed!")})})}),$(function(){var e;if(0!==$(".more_supplement_description").length)return e=$("<div></div>").dialog({modal:!0,autoOpen:!1,width:600,height:400,resizeable:!0,title:"Supplement Description"}),$(".more_supplement_description").on("click",function(t){var n;return n=$(this).data("supplement-description"),e.dialog("open"),e.html(n)})}),$(function(){return $("#apc-confirmed-edit").on("click",function(){var e;return(e=$(this).parents("div.apc-area")).hide(),e.prev().show()})}),$(function(){return $("#confirm-signature").on("click",function(e){return e.preventDefault(),$(this).remove(),$(".message.error").remove(),$("#send-to-billing").attr("type","button")})}),$(function(){if(0!==$("#maincol").data("clear-upload"))return $("input[type='file']").on("change",function(e){var t;return t='<a style="cursor: pointer;" class="clear-file">Clear</a>',$(this).nextAll().eq(0).hasClass("clear-file")||$(this).parent().append(t),$(".row").on("click",".clear-file",function(e){var t;return e.preventDefault(),(t=$(this).prev()).val(""),t.attr("type",""),t.attr("type","file"),$(this).remove()})})}),$(function(){var e;if(0!==$("#mdpi_privacy_policy_dialog").length)return(e=$("#mdpi_privacy_policy_dialog").dialog({modal:!0,autoOpen:!1,width:600,height:"auto",resizeable:!1,dialogClass:"no-close"})).dialog("open"),$(".no-close .ui-dialog-titlebar-close").hide(),$("#mdpi_privacy_policy_subscribed").on("change",function(){return $(this).is(":checked")?$("#mdpi_privacy_policy_submit").prop("disabled",!1):$("#mdpi_privacy_policy_submit").prop("disabled",!0)}),$("#mdpi_privacy_policy_submit").on("click",function(t){var n;return n=$("#mdpi_privacy_policy_dialog").data("uri"),t.preventDefault(),$.post(n,{is_subscribed:1},function(){return e.dialog("close"),window.location.reload(!0)})})}),$(function(){if(0!==$("#manuscript-feed-browser").length||0!==$("#feed").length||0!==$("#feed_browser").length)return $("#manuscript-feed-browser, #feed, #feed_browser").on("click","a.feed-details",function(e){return e.preventDefault(),$("#feed-details-dialog").dialog({modal:!1,autoOpen:!1,width:700,height:500,resizable:!0}).html("").load($(this).data("url")).dialog("open")}),$("#manuscript-feed-browser, #feed, #feed_browser, #feed-details-dialog").on("click","#show-more-feeds",function(e){var t;return e.preventDefault(),t=$(this).data("url"),$.get(t,function(e){return $("#show-more-feeds").remove(),$(".search-feed-list").parent().append(e)})})}),$(function(){var e;if(0!==$(".show-dialog-btn").length)return e=function(e){var t;for(null==e&&(e=8),t="";t.length<e;)t+=Math.random().toString(36).substr(2);return t.substr(0,e)},$(".show-dialog-btn").on("click",function(t){var n,i,r,a;if(t.preventDefault(),r=$(this).data("title"),a=$(this).data("url"))return $.blockUI({message:"<p class='margin-1'>"+SusyConfig.image.loading+" Loading ...</p>"}),i="dialog-"+e(),$("body").append("<div id='"+i+"'></div>"),n=$("#"+i).dialog({title:r,modal:!0,autoOpen:!1,width:800,height:"auto",resizable:!0,close:function(){return $("#"+i).dialog("destroy").remove()}}),$.get(a).done(function(e){return n.html(e).dialog("open")}).fail(function(){return $.alertError("Failed")}).always(function(){return $.unblockUI()})})}),$(function(){var e;if(0!==$(".contact-skype").length)return e=SusyConfig.url.get_skype_url,$(".contact-skype").each(function(){var t,n;if(t=$(this),n=t.data("email"))return $.get(e,{email:n},function(e){if(e.skype&&t.prop("href","skype:"+e.skype+"?chat").show(),e.user_name)return t.prop("title","Contact "+e.user_name+" with Skype")})})}),$(function(){return $("body").on("click",".delete-btn",function(e){var t,n,i;return e.preventDefault(),i=$(this).prop("href"),(n=$(this).data("title"))||(n="Delete item"),(t=$(this).data("confirm-message"))||(t="Are you sure to delete this item?"),$.confirm({icon:"fa fa-trash",type:"red",title:n,content:t,buttons:{confirm:{btnClass:"btn-red",action:function(){return $.ajax({url:i,type:"DELETE"}).done(function(e){return e.redirect_url?window.location.href=e.redirect_url:"success"===e.status?window.location.reload(!0):e.message?$.alert(e.message):$.alert("Error!")})}},cancel:function(){}}})}),$("body").on("click",".post-btn",function(e){var t,n,i;return e.preventDefault(),i=$(this).prop("href"),(n=$(this).data("title"))||(n="Add item"),(t=$(this).data("confirm-message"))||(t="Are you sure to add this item?"),$.confirm({icon:"fa fa-plus",type:"blue",title:n,content:t,buttons:{confirm:{btnClass:"btn-blue",action:function(){return $.ajax({url:i,type:"POST"}).done(function(e){return e.redirect_url?window.location.href=e.redirect_url:"success"===e.status?window.location.reload(!0):e.message?$.alert(e.message):$.alert("Error!")})}},cancel:function(){}}})}),$("table").on("click",".table-show-hide-btn",function(e){var t;return e.preventDefault(),t=$(this),t.parents("table").find(".show-hide-tr").toggle(function(){return $(this).is(":visible")?t.html("Show less"):t.html("Show more")})}),$("body").on("click",".view-btn",function(e){var t,n;return e.preventDefault(),$.blockUI({message:"<p class='margin-1'>"+SusyConfig.image.loading+" Loading ...</p>"}),n=$(this).data("uri"),t=$(this).data("title"),!!n&&(t||(t="View"),$.ajax({url:n,type:"GET"}).done(function(e){return $.dialog({icon:"fa fa-info-circle",type:"blue",boxWidth:"100%",useBootstrap:!1,title:t,content:e})}).fail(function(){return $.alert({icon:"fa fa-warning",type:"red",title:"Error",content:"Unknown Error"})}).always(function(){return $.unblockUI()}))})})}).call(this),function(){$(function(){if(1===$("#reloadCaptcha").length)return $("#reloadCaptcha").on("click",function(e){return e.preventDefault(),$("#captchaImg").attr("src",$("#captchaImg").attr("src").split("?")[0]+"?"+(new Date).getTime())})})}.call(this),function(){function e(e){return"string"==typeof e&&(e=c.getElementById(e)),e}function t(e,t,n){if(u.addEventListener)e.addEventListener(t,n,!1);else if(u.attachEvent){e.attachEvent("on"+t,function(){n.call(e,u.event)})}}function n(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function i(e,t){n(e,t)||(e.className+=" "+t)}function r(e,t){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}function a(e){var t,n,i,r,a=h(e);return t=a.left,i=a.top,n=t+e.offsetWidth,r=i+e.offsetHeight,{left:t,right:n,top:i,bottom:r}}function o(e){if(!e.pageX&&e.clientX){var t=1,n=document.body;if(n.getBoundingClientRect){var i=n.getBoundingClientRect();t=(i.right-i.left)/n.clientWidth}return{x:e.clientX/t+c.body.scrollLeft+c.documentElement.scrollLeft,y:e.clientY/t+c.body.scrollTop+c.documentElement.scrollTop}}return{x:e.pageX,y:e.pageY}}function l(e){return e.replace(/.*(\/|\\)/,"")}function s(e){return/[.]/.exec(e)?/[^.]+$/.exec(e.toLowerCase()):""}var c=document,u=window,d=function(){var e=c.createElement("div");return function(t){e.innerHTML=t;var n=e.childNodes[0];return e.removeChild(n),n}}();if(document.documentElement.getBoundingClientRect)h=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,i=n.body,r=n.documentElement,a=r.clientTop||i.clientTop||0,o=r.clientLeft||i.clientLeft||0,l=1;if(i.getBoundingClientRect){var s=i.getBoundingClientRect();l=(s.right-s.left)/i.clientWidth}return l>1&&(a=0,o=0),{top:t.top/l+(window.pageYOffset||r&&r.scrollTop/l||i.scrollTop/l)-a,left:t.left/l+(window.pageXOffset||r&&r.scrollLeft/l||i.scrollLeft/l)-o}};else var h=function(e){if(u.jQuery)return jQuery(e).offset();var t=0,n=0;do{t+=e.offsetTop||0,n+=e.offsetLeft||0}while(e=e.offsetParent);return{left:n,top:t}};var f=function(){var e=0;return function(){return"ValumsAjaxUpload"+e++}}();Ajax_upload=AjaxUpload=function(t,n){if(t.jquery?t=t[0]:"string"==typeof t&&/^#.*/.test(t)&&(t=t.slice(1)),t=e(t),this._input=null,this._button=t,this._disabled=!1,this._submitting=!1,this._justClicked=!1,this._parentDialog=c.body,window.jQuery&&jQuery.ui&&jQuery.ui.dialog){var i=jQuery(this._button).parents(".ui-dialog");i.length&&(this._parentDialog=i[0])}this._settings={action:"upload.php",name:"userfile",data:{},autoSubmit:!0,responseType:!1,onChange:function(e,t){},onSubmit:function(e,t){},onComplete:function(e,t){}};for(var r in n)this._settings[r]=n[r];this._createInput(),this._rerouteClicks()},AjaxUpload.prototype={setData:function(e){this._settings.data=e},disable:function(){this._disabled=!0},enable:function(){this._disabled=!1},destroy:function(){this._input&&(this._input.parentNode&&this._input.parentNode.removeChild(this._input),this._input=null)},_createInput:function(){var e=this,n=c.createElement("input");n.setAttribute("type","file"),n.setAttribute("name",this._settings.name);var i={position:"absolute",margin:"-5px 0 0 -175px",padding:0,width:"220px",height:"30px",fontSize:"14px",opacity:0,cursor:"pointer",display:"none",zIndex:2147483583};for(var r in i)n.style[r]=i[r];"0"!==n.style.opacity&&(n.style.filter="alpha(opacity=0)"),this._parentDialog.appendChild(n),t(n,"change",function(){var t=l(this.value);0!=e._settings.onChange.call(e,t,s(t))&&e._settings.autoSubmit&&e.submit()}),t(n,"click",function(){e.justClicked=!0,setTimeout(function(){e.justClicked=!1},2500)}),this._input=n},_rerouteClicks:function(){var e,n=this,l={top:0,left:0},s=!1;t(n._button,"mouseover",function(t){n._input&&!s&&(s=!0,e=a(n._button),n._parentDialog!=c.body&&(l=h(n._parentDialog)))}),t(document,"mousemove",function(t){var a=n._input;if(a&&s){if(n._disabled)return r(n._button,"hover"),void(a.style.display="none");var c=o(t);if(c.x>=e.left&&c.x<=e.right&&c.y>=e.top&&c.y<=e.bottom)a.style.top=c.y-l.top+"px",a.style.left=c.x-l.left+"px",a.style.display="block",i(n._button,"hover");else{s=!1;var u=setInterval(function(){n.justClicked||(s||(a.style.display="none"),clearInterval(u))},25);r(n._button,"hover")}}})},_createIframe:function(){var e=f(),t=d('<iframe src="javascript:false;" name="'+e+'" />');return t.id=e,t.style.display="none",c.body.appendChild(t),t},submit:function(){var e=this,n=this._settings;if(""!==this._input.value){var i=l(this._input.value);if(0!=n.onSubmit.call(this,i,s(i))){var r=this._createIframe(),a=this._createForm(r);a.appendChild(this._input),a.submit(),c.body.removeChild(a),a=null,this._input=null,this._createInput();var o=!1;t(r,"load",function(t){if("javascript:'%3Chtml%3E%3C/html%3E';"!=r.src&&"javascript:'<html></html>';"!=r.src){var a=r.contentDocument?r.contentDocument:frames[r.id].document;if(!(a.readyState&&"complete"!=a.readyState||a.body&&"false"==a.body.innerHTML)){if(a.XMLDocument)l=a.XMLDocument;else if(a.body)l=a.body.innerHTML,n.responseType&&"json"==n.responseType.toLowerCase()&&(a.body.firstChild&&"PRE"==a.body.firstChild.nodeName.toUpperCase()&&(l=a.body.firstChild.firstChild.nodeValue),l=l?window.eval("("+l+")"):{});else var l=a;n.onComplete.call(e,i,l),o=!0,r.src="javascript:'<html></html>';"}}else o&&setTimeout(function(){c.body.removeChild(r)},0)})}else c.body.removeChild(this._input),this._input=null,this._createInput()}},_createForm:function(e){var t=this._settings,n=d('<form method="post" enctype="multipart/form-data"></form>');n.style.display="none",n.action=t.action,n.target=e.name,c.body.appendChild(n);for(var i in t.data){var r=c.createElement("input");r.type="hidden",r.name=i,r.value=t.data[i],n.appendChild(r)}return n}}}(),function(){$(function(){var e,t,n,i,r,a,o,l,s;return 3e3,i=!1,n=$("form.autoSave"),o=/^(?:select)$/i,a=/^(?:radio|checkbox)$/i,l=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|reset|search|submit|tel|text|textarea|time|url|week)$/i,s=function(){if(i)return n.each(function(e,t){var n,i;return t=$(t),n=t.attr("action"),t.data("auto-save-key")&&(n=t.data("auto-save-key")),i=JSON.stringify($(":input",t).not(".auto-save-exclude-field").not('input[name="form[_token]"]').serializeArray()),$.localStorage(n,i)})},r=function(){return n.each(function(e,t){var n,r,s;if(s=$(t).attr("action"),$(t).data("auto-save-key")&&(s=$(t).data("auto-save-key")),null!=s)return(n=$.localStorage(s))&&(r=JSON.parse(n),$.each(r,function(e,n){var i;if(i=n.value)return $(t).find('input[name="'+n.name+'"], textarea[name="'+n.name+'"], select[name="'+n.name+'"]').each(function(e,t){var r,s;if(t=$(t),r=t.attr("type"),s=t[0].tagName,(l.test(r)||"TEXTAREA"===s)&&t.val(n.value),a.test(r)&&t.attr("value")===i&&t.attr("checked","checked"),o.test(r)||"SELECT"===s)return t.find("option").each(function(e,t){if((t=$(t)).attr("value")===i)return t.attr("selected","selected")})})})),i=!0})},e=function(){return i=!1,n.each(function(e,t){var n;return n=$(t).attr("action"),$(t).data("auto-save-key")&&(n=$(t).data("auto-save-key")),$.localStorage(n,null)}),!0},r(),setInterval(function(){return s()},3e3),$("input#addAuthor").on("click",function(){return s()}),$("input#si-add-guest-editor-btn").on("click",function(){return s()}),$("input.auto-save-form-btn").on("click",function(){return s()}),$("input.clear-form-data-btn").on("click",function(){return e()}),n.on("submit",function(t){return e()}),$("a.clearFormData").on("click",function(t){return e()}),t=function(e,t){var n,r,a,o;return i=!1,a=$(e).attr("action"),$(e).data("auto-save-key")&&(a=$(e).data("auto-save-key")),n=$.localStorage(a),r=JSON.parse(n),o=[],$.each(r,function(e,n){var i,r,a,l,s;if(a=n.value,r=n.name,(i=r.replace(/[^0-9]/gi,""))<t&&o.push(n),i>t)return s=r.replace(/\d+/gi,parseInt(i)-1),l={name:s,value:a},o.push(l)}),$.localStorage(a,JSON.stringify(o))},$("a.clearFormData_author").on("click",function(e){var n,i;return i=$("a.clearFormData_author").index(this)+1,n=$(this).parents("form"),t(n,i)})})}.call(this),function(){$(function(){var e;if(1===(e=$("#form_password")).length&&1===$("form.show-password-tips").length)return e.passStrengthener(),e.on("change",function(e){var t,n,i;return t=$(this).parent(),i=$(this).val(),n=t.find("#password_error_message"),i.length>=8&&/[0-9]/.test(i)&&/[a-z]/.test(i)&&/[A-Z]/.test(i)?(n.length>0&&n.html("").hide(),!0):(0===n.length&&(t.append('<div id="password_error_message" style="display: none; color: #ff0000;"></div>'),n=t.find("#password_error_message")),n.html("<div>The password needs to meet all requirements below:</div><div>- minimum 8 characters</div><div>- minimum one small letter</div><div>- minimum one capital letter</div><div>- minimum one number</div>").show(),!1)})})}.call(this),$(function(){$("#manuscript-coverletter-browser").dialog({modal:!0,autoOpen:!1,width:500,height:430,resizable:!0}),$("#display_coverletter").click(function(){return $.ajax({url:$(this).data("url"),success:function(e){$("#manuscript-coverletter-browser").html(e),$("#manuscript-coverletter-browser").dialog("open")}}),!1})}),$(function(){$("#manuscriptDetails").attr("data-rel");$("#crosscheck_editor_choose").click(function(){return $("#editor-choose-browser").attr("title","Editors"),$("#editor-choose-browser").dialog({modal:!1,autoOpen:!1,width:660,height:410,resizable:!1}),$.ajax({dataType:"json",url:"/ajax/submission_get_crosscheck_editor/",success:function(e){var t=e.data,n=e.suggestions;if(t.length==n.length){for(var i="",r=0;r<t.length;r++)i+=n[r]+"<br/>";$("#editor-choose-browser").html(i),$("#editor-choose-browser").dialog("open"),$(".choose_editor").click(function(){var e=$(this).attr("href").substring($(this).attr("href").lastIndexOf("#")+1),t=$("#hash_key").text();return""!=e&&void 0!=e&&$.ajax({url:"/ajax/submission_set_crosscheck_editor/"+t+"/"+e,success:function(e){""!=e&&void 0!=e&&($("#crosscheck_editor_name").html(e),$("#editor-choose-browser").dialog("close"),window.location.href="/user/assigned/process_form/"+t+"#editorsForm-active")}}),!1})}}}),!1})}),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d;if(0!==$("#mailForm").length){for(i="#mailTo, #mailCc, #mailBcc",".mailTo, .mailCc, .mailBcc",r=function(){return $("#mailForm").attr("action")},a=function(e){return $("span.dynamicEmail",$("#"+e).parent("div")).map(function(){return $(this).attr("data-rel")})},o=function(e){return $.trim($("#"+e).val())},t=function(e,t){return null==t&&(t="<div>The field can't be blank</div>"),$("#"+e).parent("div").addClass("error").append(t)},d=function(e,t){var n;return t=t.replace("<","&lt;").replace("<","&gt;"),e.after('<div class="error">'+t+"</div>"),(n=e.next("div.error")).delay(3e3).fadeOut(1e3,function(){return n.remove()})},e=function(e,t,n){var i,r,a,o,l,s,c,u,h;if(a=t.parent("div").find("div.displayEmails"),10===(l=e.which)||13===l||n){for(e.preventDefault(),s=0,c=(r=$.trim(t.val()).split(", ")).length;s<c;s++)i=r[s],-1===a.html().indexOf(i)&&-1!==i.indexOf("@")&&(t.val(""),h=i,(u=/<([^>]+)>/.exec(h))&&(h=u[1]),/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(h)?(o=i.replace("<","&lt;").replace("<","&gt;"),$('<span class="dynamicEmail" data-rel="'+i+'">'+o+'<a href="#" class="_removeEmail">x</a></span><br>').appendTo(a)):d(t,"<"+h+"> is not a valid email"));return $("#mailForm").on("click","a._removeEmail",function(e){var t,n;return e.preventDefault(),n=$(this).parent("span"),t=n.next("br"),n.remove(),t.remove()})}},$(i).bind("keypress",function(t,n){return e(t,$(this),n)}).blur(function(t){return e(t,$(this),!0)}),$(".mailTo, .mailCc, .mailBcc").bind("keypress",function(t,n){return e(t,$(this),n)}).blur(function(t){return e(t,$(this),!0)}),$(i).trigger("keypress",[!0]),$(".mailTo, .mailCc, .mailBcc").trigger("keypress",[!0]),$("#sendingEmail").click(function(e){var n,i,l,s,c,u,d,h,f;return h=o("emailTemplates"),c=o("mailFrom"),f=a("mailTo"),l=a("mailCc"),n=a("mailBcc"),d=o("mailSubject"),i=o("mailBody"),""===c?t("mailFrom"):0===f.length?t("mailTo",'Please add one or more "TO" recipients'):""===d?t("mailSubject","The mail subject can't be empty"):""===i?t("mailBody","The mail body can't be empty"):(s=$(this).parents("form"),(u=$(this)).hide().after("<div style='display: inline-block; height: 24px; line-height: 24px;'>"+SusyConfig.image.loading+" Sending email ...</div>"),$.post(r(),{action_uri:r(),template:h,from:c,to:f.get().join(", "),cc:l.get().join(", "),bcc:n.get().join(", "),subject:d,body:i},function(e){var t;return+e>0?("",1===$("#refererUrl").length&&(t=$("#refererUrl").data("url"),$("#refererUrl").data("autoredirect"))?window.location=t:s.replaceWith('<div>Your message has been successfully delivered. <a href="'+t+'">Back to the previous page</a></div>')):(u.next("div").remove(),u.show(),s.append('<div class="error"> Sorry, it seems something went wrong, send email failed! Error: '+e+"</div>"))}))}),$("#emailTemplates").on("change",function(){return $.post($(this).data("url"),{id:$(this).val(),placeholders:$("#placeholders").val()},function(e){if(e.body)return $("#mailSubject").val(e.subject),$("#mailBody").val(e.body)})}),u=[],l=0,s=(c=i.split(", ")).length;l<s;l++)n=c[l],u.push(function(e){return $(e).autocomplete({source:$("#autocompleteUrl").attr("data-rel"),minLength:3,select:function(t,n){return setTimeout(function(){return $(e).trigger("keypress",[!0]),$(e).val("")},200)}})}(n));return u}})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f,p,m,v;for(r=$("#emailTemplatesMultipleReminder"),u=[],r.length>0&&((c=r.data("invoices"))&&(c=String(c)),u=c.split(",")),d=0,f=u.length;d<f;d++){if(s=u[d],m="#mailForm"+s,0===$(m).length)return;for(n="#mailTo"+s+", #mailCc"+s+", #mailBcc"+s,i=".mailTo, .mailCc, .mailBcc",o=function(e){return $("span.dynamicEmail",$("#"+e).parent("div")).map(function(){return $(this).attr("data-rel")})},l=function(e){return $.trim($("#"+e).val())},t=function(e,t){return null==t&&(t="<div>The field can't be blank</div>"),$("#"+e).parent("div").addClass("error").append(t)},e=function(e,t,n){var i,r,a,o,l,s,c;if(a=t.parent("div").find("div.displayEmails"),10===(l=e.which)||13===l||n){for(e.preventDefault(),s=0,c=(r=$.trim(t.val()).split(", ")).length;s<c;s++)i=r[s],-1===a.html().indexOf(i)&&-1!==i.indexOf("@")&&(o=i.replace("<","&lt;").replace("<","&gt;"),t.val(""),$('<span class="dynamicEmail" data-rel="'+i+'">'+o+'<a href="#" class="_removeEmail">x</a></span><br>').appendTo(a));return $(m).on("click","a._removeEmail",function(e){var t,n;return e.preventDefault(),n=$(this).parent("span"),t=n.next("br"),n.remove(),t.remove()})}},$(n).bind("keypress",function(t,n){return e(t,$(this),n)}).blur(function(t){return e(t,$(this),!0)}),$(i).bind("keypress",function(t,n){return e(t,$(this),n)}).blur(function(t){return e(t,$(this),!0)}),$(n).trigger("keypress",[!0]),$(i).trigger("keypress",[!0]),a=function(e){return $(e).autocomplete({source:$("#autocompleteUrl"+s).attr("data-rel"),minLength:3,select:function(t,n){return setTimeout(function(){return $(e).trigger("keypress",[!0]),$(e).val("")},200)}})},h=0,p=(v=n.split(", ")).length;h<p;h++)a(v[h])}return $("#sendingEmailMultipleReminders").on("click",function(e){var n,i,r,a,c,d,h,f,p,v,g,b;for(f=u.length,v=0,d=0,h=u.length;d<h;d++){if(s=u[d],c=l("mailFrom"+s),b=o("mailTo"+s),r=o("mailCc"+s),n=o("mailBcc"+s),g=l("mailSubject"+s),i=l("mailBody"+s),""===c)return t("mailFrom"+s);if(0===b.length)return t("mailTo"+s,'Please add one or more "TO" recipients');if(""===g)return t("mailSubject"+s,"The mail subject can't be empty");if(""===i)return t("mailBody"+s,"The mail body can't be empty");$(this).parents("form"),p=$(this),m="#mailForm"+s,a=$(m).attr("action"),$.post(a,{action_uri:a,from:c,to:b.get().join(", "),cc:r.get().join(", "),bcc:n.get().join(", "),subject:g,body:i,invoice_id:s,action:a},function(e){var t;return+e>0?(v++,f===v?1===$("#refererUrl").length&&(t=$("#refererUrl").data("url"),$("#refererUrl").data("autoredirect"))?window.location=t:$("#sending_email").replaceWith('<div>Your message has been successfully delivered. <a href="'+t+'">Back to the previous page</a></div>'):void 0):(p.next("div").remove(),p.show(),p.after('<div class="error"> Sorry, it seems something went wrong, send email failed! Error: '+e+'<br>Click <a href="'+a+'" target="_blank">here</a> to send email again.</div>'))})}return(p=$(this)).hide().after("<div id='sending_email' style='display: inline-block; height: 24px; line-height: 24px;'>"+SusyConfig.image.loading+" Sending email ...</div>")}),r.on("change",function(){var e,t,n;if($(this).val()>0){for(n=[],e=0,t=u.length;e<t;e++)s=u[e],n.push($.ajax({type:"POST",url:$("#mailBody"+s).data("url"),ajaxI:s,data:{placeholders:$("#placeholders"+s).val(),id:$(this).val()}}).done(function(e){var t;if(e.body)return t=this.ajaxI,$("#mailSubject"+t).val(e.subject),$("#mailBody"+t).val(e.body)}));return n}})})}.call(this),function(){$(function(){return $("#selectEditorForCrosscheck").click(function(e){var t;return e.preventDefault(),(t=$("#select-editos-for-crosscheck")).dialog({modal:!0,autoOpen:!1,width:700,height:500,resizable:!0}),$.get($(this).data("url"),function(e){return t.html(e),t.dialog("open")})}),$("#invite-crosscheck-editor > a").click(function(e){return e.preventDefault(),window.location=$(this).data("url")+"?user_id="+$("#crosscheck-user-name").data("user-id")}),$("#author-proofreading-form").find('input[type="submit"]').on("click",function(e){var t,n;return e.preventDefault(),t=$(this).parents("form"),(n=$(this).prop("name"))&&t.append("<input name='"+n+"' type='hidden' value='1'>"),$.confirm({icon:"fa fa-warning",type:"orange",boxWidth:"100%",useBootstrap:!1,title:"Caution",content:'<p>Does this manuscript contain any published material (figures, schemes, tables, or any extract of a text) that does not fall into the public domain, or for which the authors do not hold the copyright? (<a href="https://www.mdpi.com/authors/rights" target="_blank" rel="noopener noreferrer">https://www.mdpi.com/authors/rights</a>)</p>',buttons:{No:{btnClass:"btn-blue",action:function(){return $.confirm({icon:"fa fa-warning",type:"orange",boxWidth:"100%",useBootstrap:!1,title:"Caution",content:"Have you combined main text and reference?",buttons:{confirm:{btnClass:"btn-blue",action:function(){var e;return t.data("is-author-central")&&t.data("acknowledgments-content")?(e=t.data("acknowledgments-content"),$.confirm({icon:"fa fa-warning",type:"orange",title:"Caution",boxWidth:"100%",useBootstrap:!1,content:'Please add this text to the "Funding" section of the manuscript. The authors must accept it according to IOAP\'s request.<br>"'+e+'"',buttons:{confirm:{btnClass:"btn-blue",action:function(){return t.submit()}},cancel:function(){if(n)return t.find("input[name='"+n+"'][type='hidden']").remove()}}})):t.submit()}},cancel:function(){if(n)return t.find("input[name='"+n+"'][type='hidden']").remove()}}})}},Yes:{btnClass:"btn-default",action:function(){if(n)return t.find("input[name='"+n+"'][type='hidden']").remove()}}}})})})}.call(this),function(){$(function(){if(0!==$("#selectSubmissionEditorForMakeDecision").length||0!==$("#selectEditorForMakeDecision").length)return $("body").on("click","#selectEditorForMakeDecision, #selectSubmissionEditorForMakeDecision",function(e){var t;return e.preventDefault(),(t=$("#select-editos-for-make-decision")).dialog({modal:!1,autoOpen:!1,width:1200,height:800,resizable:!0}),$.blockUI({message:"<p class='margin-1'>"+SusyConfig.image.loading+" Loading ...</p>"}),$.get($(this).data("url")).done(function(e){return t.html(e),t.dialog("open")}).fail(function(){return $.alertError("Failed")}).always(function(){return $.unblockUI()})}),$("body").on("click","#chooseSameEditor",function(e){var t;return e.preventDefault(),t=$(this),$.get(t.data("invite-url"),function(){return window.location=t.data("email-url")})}),$("#show_user_decisions").click(function(e){var t;return e.preventDefault(),(t=$("#show-pre-decisons-by-editor")).dialog({modal:!1,autoOpen:!1,width:700,height:500,resizable:!0}),$.get($(this).data("url"),function(e){return t.html(e),t.dialog("open")})}),window.showNotes("a.forDecisionNotes","#for-decision-notes"),window.showNotes("a.NotetoEditor","#note_to_academic_editor")})}.call(this),function(){$(function(){var fillFrom,form,formEmailValue,hideInvitions,input,preventDialogAutoFocus,review_ips,reviewer_rel_ids,showAddForm,showExistOption,showIsEditorOrAuthor,submitForm;if(String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),$("a.historyInvitations").length>=1&&$("a.historyInvitations").click(function(e){var t;return e.preventDefault(),$(this).css({color:"#934E4E"}),(t=$("#manuscript-history-reviewer-invitations")).dialog({modal:!0,autoOpen:!1,width:600,height:300,resizable:!0}),$.get($(this).data("url"),function(e){return t.html(e),t.dialog("open")})}),$("a.displayReviewerInfo").length>=1&&$("a.displayReviewerInfo").click(function(e){return e.preventDefault(),$("#display-reviewer-info").dialog({modal:!0,autoOpen:!1,width:700,height:"auto",resizable:!0}).html($(this).prev("div").html()).dialog("open")}),$("a.displayReviewerWarning").length>=1&&$("a.displayReviewerWarning").click(function(e){return e.preventDefault(),$("#display-reviewer-warning").dialog({modal:!0,autoOpen:!1,width:400,height:250,resizable:!0}).html($(this).prev("div").html()).dialog("open")}),$("a.editReviewerInfo").length>=1&&($("#edit-reviewer-info").on("click","a.closeDialog",function(e){return e.preventDefault(),$("#edit-reviewer-info").dialog("close")}),$("a.editReviewerInfo").click(function(e){var t;return e.preventDefault(),(t=$("#edit-reviewer-info")).dialog({modal:!0,autoOpen:!1,width:800,resizable:!0}),$.get($(this).data("editurl"),function(e){return t.html(e).dialog("open")})})),0!==$("#reviewersForm").length)return preventDialogAutoFocus=function(){return $.ui.dialog.prototype._focusTabbable=function(){return!1}},$("#searchInReviewerDB").click(function(e){var t;return e.preventDefault(),preventDialogAutoFocus(),(t=$("#reviewer-db-list")).dialog({modal:!0,autoOpen:!1,open:function(){return $(this).find("input").first().focus()},width:700,height:500,resizable:!0,buttons:[{text:"Add Selected Reviewer",click:function(){var e;return(e=$("#rdb-reviewer-list").find("#addReviewersBtn")).length>0?e.click():alert("No Reviewer found")}},{text:"Close",click:function(){return $(this).dialog("close")}}]}),$.get($(this).data("url"),function(e){return t.html(e),t.dialog("open")})}),$("#searchAndAddReviewers").click(function(e){var t;return e.preventDefault(),preventDialogAutoFocus(),(t=$("#search-and-add-reviewers")).dialog({modal:!0,autoOpen:!1,open:function(){return $(this).find("input").first().focus()},width:700,height:500,resizable:!0}),$.get($(this).data("url"),function(e){return t.html(e),t.dialog("open")})}),form=$("#reviewersForm"),submitForm=function(){return form.append('<input type="hidden" name="senddata" value="Submit">'),form[0].submit()},form.on("click","a.resetReviewer",function(e){return e.preventDefault(),form[0].reset(),$("#addReviewerBtn").prev("div").remove(),$("#addReviewerBtn").next("a").remove(),$("#addReviewerBtn").val("Add reviewer")}),formEmailValue=null,showAddForm=function(){return $("#addReviewerForm").show(),$(".reviewWarn").html(""),$("#form_email").attr("readonly",!0),$("#cancelBtn").show(),$("#nextBtn").hide(),$("#nextBtn2").hide(),$("#backBtn").hide()},$("#form_country").children("option").map(function(){if("00"===$(this).val())return $(this).attr("disabled","disabled")}),$("#nextBtn").click(function(_this){return function(e){var emailStatus;return formEmailValue=$.trim($("#form_email").val()),emailStatus=$("#email_status"),/.+?@((?:[\w\-_]+\.)+)([a-zA-Z]{2,4})/.test(formEmailValue)?(emailStatus.html(""),$("#form_email").attr("readonly",!0),$.get(form.data("reviewer-checking-url"),{email:formEmailValue},function(data){var json_data,result;return""===(data=$.trim(data))?(showAddForm(),$("#invitations_row").hide()):(showExistOption(),result=data,$(".reviewWarn").html(result),json_data=$("#json_reviewer").html(),((json_data=eval("("+json_data+")")).isEditor||json_data.isAuthor)&&showIsEditorOrAuthor(),json_data.firstname&&($("#nextBtn2").hide(),$("#backBtn").hide(),fillFrom(json_data),$("#invitations_row").show(),$.get(json_data.invitations_url,function(e){return $("#invitations").html(e)})),json_data.hasSameDomain?($("#nextBtn2").hide(),$("#backBtn").hide()):void 0)})):(emailStatus.html("invalid email"),emailStatus.css("color","red"))}}(this)),$("#cancelBtn").click(function(e){return $("#addReviewerForm").hide(),$("#form_email").removeAttr("readonly"),$("#nextBtn").css("display","inline-block"),$("#resetBtn").click(),$("#form_email").val(formEmailValue),hideInvitions()}),$("#form_email").on("keydown",function(e){if(13===(e.keyCode||e.which))return setTimeout(function(){return $("#nextBtn").trigger("click")},100),!1}),$("#backBtn").click(function(e){return $("#backBtn").hide(),$(".reviewWarn").html(""),$("#nextBtn").css("display","inline-block"),$("#nextBtn2").hide(),$("#resetBtn").click(),$("#form_email").val(formEmailValue),$("#form_email").removeAttr("readonly"),hideInvitions()}),hideInvitions=function(){return $("#invitations_row").find("#invitations").html(""),$("#invitations_row").hide()},form.on("click","#specialBackBtn",function(e){return e.preventDefault(),$("#backBtn").click()}),showExistOption=function(){return $("#nextBtn").hide(),$("#backBtn").css("display","inline-block")},fillFrom=function(e){return $("#form_firstname").val(e.firstname),$("#form_lastname").val(e.lastname),$("#form_affiliation").val(e.affiliation),$("#form_telephone").val(e.telephone),$("#form_title").val(e.title),$("#form_url").val(e.url),$("#form_h_index").val(e.h_index),$("#form_hindex_url").val(e.hindex_url),$("#form_country").val(e.country),$("#form_research_keywords").val(e.research_keywords)},showIsEditorOrAuthor=function(){return $("#backBtn").css("display","inline-block"),$("#nextBtn").hide(),$("#nextBtn2").css("display","inline-block")},$("#nextBtn2").click(function(e){return showAddForm()}),form.on("click","#updateRviewer",function(e){return e.preventDefault(),$("#form_rewrite").val(1),showAddForm()}),form.on("click","#keepRviewer",function(e){return $("#form_rewrite").val(0),$("#submitBtn").click()}),$("#submitBtn_check").on("click",function(e){if(""!==$.trim($("#form_firstname").val())&&""!==$.trim($("#form_lastname").val()))return $.get($(this).data("lastname-check-url"),{email:$("#form_email").val(),lastname:$.trim($("#form_lastname").val())},function(e){return"0"===e?$("#submitBtn").click():confirm("The last name is the same as one of the authors")?$("#submitBtn").click():$("#cancelBtn").click()})}),form.on("click","#seeMore",function(e){return e.preventDefault(),$("#blocked-info").dialog({modal:!0,autoOpen:!1,width:400,height:250,resizable:!0}),$.get($("#blocked-info").data("blocked-info-url"),{hash_key:$("#blocked-info").data("hash_key"),email:formEmailValue},function(e){return $("#blocked-info").html(e),$("#blocked-info").dialog("open")})}),$("#searchAndAddReviewersInOalit").click(function(e){var t;return e.preventDefault(),preventDialogAutoFocus(),(t=$("#search-and-add-reviewers")).dialog({modal:!0,autoOpen:!1,open:function(){return $(this).find("input").first().focus()},width:700,height:500,resizable:!0}),$.get($(this).data("url"),function(e){return t.html(e),t.dialog("open")})}),$("#SearchVolunteerReviewers").on("click",function(e){var t;return e.preventDefault(),preventDialogAutoFocus(),(t=$("#search-and-add-reviewers")).dialog({modal:!0,autoOpen:!1,open:function(){return $(this).find("input").first().focus()},width:700,height:500,resizable:!0}),$.get($(this).data("url"),function(e){return t.html(e),t.dialog("open")})}),$("#rev_coauthor_error").length>=1&&($("#toggle_rev_author_rel").click(function(){return $("#rev_coauthor_error_msg").toggle()}),$("#rev_coauthor_error_msg").on("click","#more_details_blast_function",function(e){return alert("What do these percentages mean? \nThey are the probability that the reviewer has co-authored with one of the authors.\n\n- 95%: Reviewer email WITH Author email \n- 80%: Reviewer email WITH Author Name \n- 75%: Reviewer Name (full or 'f[.] lastname') WITH Author email\n- 64%: Reviewer Name (full) WITH Author Name (full)\n- 60%: Reviewer Name (full) WITH Author Name ('f[.] lastname')\n- 60%: Reviewer Name ('f[.] lastname') WITH Author Name (full)\n- 56%: Reviewer Name ('f[.] lastname') WITH Author Name ('f[.] lastname')")}),input=$("#rev_coauthor_error_msg"),$(input).append('<br><br><img border="0" src="'+$("#loading_img_value").html()+'" alt="Loading..." title="Loading..." width="16" height="16"/>'),$.ajax({url:"/user/reviewer/blast/"+$.trim($("#hashkey_value").html()),dataType:"json",success:function(e){return $(input).html(e),$(".rev_matching_email").each(function(){var e,t,n,i;if(n=$(this).parent().attr("style"),i="",e="black",n.split("color:").forEach(function(t){if(t&&(i=t),i)return i.split("!important;").forEach(function(t){if(t)return e=t})}),e)return t=$(this).attr("href"),$(""+t.trim()).css({color:e})})}}),$(".quickSendInvite").on("click",function(){var e,t;return(t=$(this)).hide(),e=$(this).parents(".row").wrap("<div></div>").parent(),$.get($(this).data("url"),function(n){return n.error?(t.show(),alert(n.error),!1):(e.html(n),e.find(".cell:last-child").append("<div class='successInvite success'>Successfully Invited</div>"),e.find(".successInvite").fadeIn(1e3).fadeOut(2e3))})})),$(".review_ip").length>0?(review_ips=$(".review_ip").map(function(){return $(this).data("ip-location")}).toArray(),reviewer_rel_ids=$(".review_ip").map(function(){return $(this).data("reviewer-rel-id")}).toArray(),$(".review_ip").each(function(e,t){var n,i,r,a,o,l,s,c;for(a=(n=$(this)).data("ip-location"),c=n.data("reviewer-rel-id"),r=n.data("img-src"),s=[],i=o=0,l=review_ips.length;o<l;i=++o){if(review_ips[i]===a&&i!==e&&reviewer_rel_ids[i]!==c){n.after(' <img src="'+r+'" alt="Same IP" title="Same Review IP detected">');break}s.push(void 0)}return s})):void 0}),window.showNotes("a.reviewerNotes","#reviewer-notes")}.call(this),function(){$(function(){var reviewRating;if($('input[data-next-url*="close_review"]').on("click",function(e){var canceled_url;return e.preventDefault(),canceled_url=$(this).data("canceled-url"),$.ajax({url:$(this).data("next-url"),success:function(msg){return""!==msg&&(msg=eval("("+msg+")"),$.each(msg,function(e,t){return $("#un_rated_viewer").append("<b> Reviewer"+t+" </b>")})),0===msg.length||""===msg?window.location.href=canceled_url:$("#revew-rating-confirm").dialog({resizable:!1,height:350,width:700,modal:!0,buttons:{Close:function(){return $(this).dialog("close"),$("html, body").animate({scrollTop:$('.displayVoucher[data-voucher-granted="false"]').offset().top-100},500)}}})}})}),0!==(reviewRating=$("select.reviewRating")).length)return reviewRating.on("change",function(){return $.post($(this).data("url"),{rating:$(this).val()})})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c;if($(".reviewer-comments").each(function(e){return $(this).on("click",function(t){return $(".reviewer-comments").eq(e).css("display","none"),$(".reviewer-comments").eq(e).prev().hide(),$(".reviewer-comments").eq(e).next(".extra-comments").css("display","block")})}),$(".reviewer-comments-less").each(function(e){return $(this).on("click",function(t){return $(".reviewer-comments").eq(e).css("display","inline"),$(".reviewer-comments").eq(e).prev().show("slow").css("display","block"),$(".reviewer-comments").eq(e).next(".extra-comments").css("display","none")})}),$(".toggle-report").on("click",function(){var e,t,n,i,r;return e=$(this),i=e.parent("div.report"),t=i.next(".element-reviwer"),n=e.prop("title"),r=e.data("toggle-title"),t.toggle(),e.prop("title",r),e.html(r),e.data("toggle-title",n),t.is(":visible")?e.append(" [ - ]"):e.append(" [ + ]")}),0!==$("#reivew_report_submit").length)return a=$("#reivew_report_submit"),(n=$("#reivew_report_submit .error:visible").first())&&n.length>0&&(r=n.parents("table.group-table"),c=n.offset().top,r&&r.length>0&&(c=r.offset().top),$("html, body").animate({scrollTop:c},1e3)),$(".btn_submit").on("click",function(){return a.find("[required='required']").each(function(){return $(this).removeAttr("required")}),a.attr("action",a.data("draft-url")),a.submit()}),s=$("#see_revised_version_row"),o=$("#reviewer_no_need_to_see_revised_info"),l=$("#reviewer_see_revised_info"),e=function(){return s.show(),o.show(),l.hide()},t=function(){return s.show(),o.hide(),l.show()},(i=function(){var n;return"1"===(n=$("#form_recommendation input:checked")).val()||"2"===n.val()?e():"3"===n.val()||"4"===n.val()?t():void 0})(),$("#form_recommendation input").on("change",i)})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d;if(0!==(e=$("#review_decline_submit")).length)return e.find('input[type="submit"]').on("click",function(t){var n,i,a;return i="1"===$('input[name="form[acceptance]"]:checked').val(),a=$("#same-ip-confirm-dialog"),n=1===a.data("ip-equal"),r()?i&&n?(t.preventDefault(),a.dialog({modal:!0,width:400,height:200,resizable:!1,buttons:{Confirm:function(){return e.submit()},Cancel:function(){return $(this).dialog("close")}}})):void 0:(t.preventDefault(),!1)}),o=$("#review_decline_comment_row"),a=$("#form_review_decline_comment"),l=$("#review_recommend_reviewer_row"),s=$("#review_acceptance_reminder_way"),d=$("#review_acceptance_reminder_way_select_date"),c=$("#review_acceptance_inappropriate_date"),u=$("#review_acceptance_reminder_way_phone_num"),t=function(){var e;return"0"===(e=$('input[name="form[acceptance]"]:checked').val())?(o.show(),l.show(),a.show(),s.hide()):"1"!==e?(o.hide(),l.hide(),a.hide(),s.hide()):(o.hide(),o.find("input[type=radio]").attr("checked",!1),$("#form_inappropriate_date").val(""),c.hide(),l.hide(),a.hide(),s.data("is-sci")?void 0:s.show())},i=function(){return"0"===$('input[name="form[in_two_weeks]"]:checked').val()?d.show():($("#form_select_date").val(""),d.hide()),$("#form_by_message").is(":checked")?u.show():u.hide()},n=function(){return"1"===$('input[name="form[decline_comments]"]:checked').val()?c.show():($("#form_inappropriate_date").val(""),c.hide())},t(),i(),n(),$('input[name="form[acceptance]"]').on("change",t),$('input[name="form[in_two_weeks]"]').on("change",i),$("#form_by_message").on("change",i),$('input[name="form[decline_comments]"]').on("change",n),r=function(){var e,t,n;return n=$("#form_select_date"),"1"!==$('input[name="form[acceptance]"]:checked').val()||"0"!==$('input[name="form[in_two_weeks]"]:checked').val()||(t=n.next("span"),n.val()?(t&&t.remove(),!0):(e="Please fill out this field.",1===t.length?(t.html(e),t.fadeIn(400).fadeOut(400).fadeIn(400)):n.after('<span class="error">'+e+"</span>"),!1))}})}.call(this),function(){$(function(){var e,t,n,i,r,a;if(r=$("a.manuscriptNotes img"),0!==$("a.manuscriptNotes").length&&0!==r.length)return a=r.offset(),e=$("#container"),t=e.offset(),n=e.outerWidth(),(i=$(".quickform").eq(0).height()/2)<300&&(i=300),window.showNotes("a.manuscriptNotes","#manuscript-notes",!1,function(e,r){return $("#manuscript-notes").parents("div.ui-dialog").css({top:t.top+"px",left:t.left+n-350+"px",width:"350px",height:i+"px",opacity:1})},function(e,t){return $("#manuscript-notes").parents("div.ui-dialog").show().animate({opacity:0,width:"1px",height:"1px",top:a.top+"px",left:a.left+"px"},function(){return $(this).hide()})},{height:i}),-1!==r.attr("src").indexOf("plus")&&$("a.manuscriptNotes").trigger("click"),$(".pre-manuscript-notes-btn").on("click",function(e){var t,n,i;return e.preventDefault(),n=$(this).data("title"),i=$(this).data("load-url"),(t=$("#pre-manuscript-notes").dialog({title:n,modal:!0,autoOpen:!1,width:500,height:300,resizable:!0})).load(i,function(){return t.dialog("open")})})})}.call(this),function(){$(function(){var e;if(0!==$("#manuscript-status").length)return e=$("#manuscript-status").dialog({modal:!0,autoOpen:!1,width:450,height:200,resizable:!0}),$("a.changeManuscriptStatus").on("click",function(t){return t.preventDefault(),e.dialog({width:400,title:"Change manuscript's status"}),e.load($(this).data("load-url")).dialog("open")}),$("a.changeManuscriptJournal").on("click",function(t){return t.preventDefault(),e.dialog({width:600,title:"Change manuscript's journal"}),e.load($(this).data("load-url")).dialog("open")}),$("a.changeManuscriptType").on("click",function(t){return t.preventDefault(),e.dialog({width:350,title:"Change manuscript's type"}),e.load($(this).data("load-url")).dialog("open")}),$("a.changeManuscriptFileType").on("click",function(t){return t.preventDefault(),e.dialog({width:400,title:"Change manuscript's file type"}),e.load($(this).data("load-url")).dialog("open")})})}.call(this),function(){$(function(){var e;if(0!==$("#upload-author-rebuttal-link").length)return e=$("#upload-author-rebuttal").dialog({modal:!0,autoOpen:!1,width:800,height:500,resizable:!0}),$("#upload-author-rebuttal-link").on("click",function(t){return t.preventDefault(),e.load($(this).data("load-url")).dialog("open")})})}.call(this),function(){$(function(){if(0!==$("#rebuttal-clk").length)return $("#rebuttal-clk").on("click",function(e){return e.preventDefault(),$(this).blur().parents("div.row").next("div.row").find(".hideit").toggle()})})}.call(this),function(){$(function(){var e;if(0!==$("#display-manuscript-feed").length)return e=$("#manuscript-feed-browser").dialog({modal:!0,autoOpen:!1,width:700,height:500,resizable:!0}),$("#display-manuscript-feed").on("click",function(t){return t.preventDefault(),$.get($(this).data("url"),function(t){return e.html(t).dialog("open")})})})}.call(this),$(function(){function e(e){var t=$(e);0!=t.length&&t.each(function(){var e=$(this),t=e.data("ajax-url");e.autocomplete({source:t,minLength:3,select:function(t,n){e.val(n.item.value),window.location.href=n.item.url}})})}function t(e){var t=$(e);if(0!=t.length){var n=t.data("ajax-url");t.autocomplete({source:n,minLength:3,select:function(e,n){t.val(n.item.value)}})}}e(".quick-search"),e(".submission-quick-search"),e(".submission-english-quick-search"),e(".submission-layout-quick-search"),e(".invoices-quick-search"),function(e){var t=$(e);if(0!=t.length){var n=t.data("ajax-url");t.autocomplete({source:n,select:function(e,n){t.val(n.item.value),window.location.href=n.item.url}})}}(".sponsorships-quick-search"),e(".search-users"),t(".simple-quick-search"),t(".reviewer_email_auto_select"),t(".ge_email_auto_select")}),function(){$(function(){var e,t,n,i,r,a;if($(".assignEditorInfo").length>0&&$(".editorInput").length>0&&(e=[],t=null,$(".editorInput").on("focus",function(){return t=$(this).attr("id")}),$(".editorInput").each(function(){return e[$(this).attr("id")]=$(this).autocomplete({source:$(this).data("uri"),minLength:0,select:function(e,n){var i;return $(".ui-helper-hidden-accessible").remove(),$("#"+t),$(this).next("input.editorData").val(n.item.user_id),i=$(this).next().next().css({display:"block"}),setTimeout(function(){return i.css({display:"inline"})},50)}}).click(function(){return $(this).autocomplete("search","").data("ui-autocomplete")._renderItem=function(e,t){return $("<li></li>").data("item.autocomplete",t).append("<div><a>"+t.label+"</a></div>").appendTo(e)}}),$(this).data("auto-enable")?e[$(this).attr("id")].autocomplete("enable"):e[$(this).attr("id")].autocomplete("disable")}),$(".assignEditorInfo img.pencil").on("click",function(){var n,i;return i=$($(this).parent("div")).hide(),n=i.next("div.assignEditorField").show(),t=$("input",n).attr("id"),e[t].autocomplete("enable")}),$(".assignEditorInfo img.cross").on("click",function(e){var t;return e.preventDefault(),t=$(this),$.confirm({icon:"fa fa-warning",type:"orange",title:"Caution",boxWidth:"50%",useBootstrap:!1,content:"Are you sure to cancel English Editing for "+t.data("editor_name"),buttons:{confirm:{btnClass:"btn-blue",action:function(){return $.post(t.data("uri"),{hash_key:t.data("hash_key"),editor_user_id:t.data("editor_user_id")},function(e){return window.location.reload()})}},cancel:function(){}}})}),$(".assignEditorField .cancel").on("click",function(e){var t;return e.preventDefault(),(t=$($(this).parent("div"))).hide(),t.prev("div.assignEditorInfo").show()}),$(".editorConfirm").on("click",function(){var e,t,n,i,r;return n=$(this).attr("src"),$(this).attr("src",SusyConfig.image_src.loading),r=$(this),t=r.parents("td"),e=1===t.length?t.siblings(".assigned-date"):null,1===$("textarea.reassign_reason").length&&0===$("textarea.reassign_reason").val().length?(alert("Please enter the reason for reassignment"),void r.attr("src",n)):(i=1===$("textarea.reassign_reason").length?$("textarea.reassign_reason").val():null,$.post(r.data("uri"),{hash_key:$(this).data("hash_key"),editor_user_id:$(this).prev("input.editorData").val(),reason:i},function(t){var i;if(r.attr("src",n),r.next("a").show().trigger("click"),(i=r.parent("div").prev("div.assignEditorInfo")).find("span.editorName").html(r.prev().prev().val()),setTimeout(function(){return i.hide().fadeIn("slow"),$(".assigned-editor-info").hide("slow")},500),e&&e.data("uri")&&$.get(e.data("uri"),function(t){return e.text(t).fadeOut().fadeIn()}),window.location.pathname.indexOf("pre_english")>0)return window.location.reload()}).fail(function(){return r.attr("src",n),alert("Failed to assign to the editor. Please choose another one."),r.prev().prev().focus()}))})),$(".allow_external_editor").on("click",function(e){var t,n,i,r,a,o;return e.preventDefault(),o=$(this),n=o.find("img"),t=o.data("hash_key"),i=-1!==n.attr("src").indexOf("lock-unlock.png"),a=i?SusyConfig.eic_cannotsee:SusyConfig.eic_cansee,r=i?SusyConfig.image.locked:SusyConfig.image.unlock,$.get(SusyConfig.url.allow_external_editor,{hash_key:t,is_allow:i?0:1},function(){return o.attr("title",a),n.attr("src",r)})}),$(".allow_guest_editor").on("click",function(e){var t,n,i,r,a,o;return e.preventDefault(),o=$(this),n=o.find("img"),t=o.data("hash_key"),i=-1!==n.attr("src").indexOf("lock-unlock.png"),a=i?SusyConfig.ge_cannotsee:SusyConfig.ge_cansee,r=i?SusyConfig.image.ge_locked:SusyConfig.image.ge_unlock,$.get(SusyConfig.url.allow_guest_editor,{hash_key:t,is_allow:i?0:1},function(){return o.attr("title",a),n.attr("src",r)})}),n=$("#blockedAssigned-dialog").dialog({modal:!0,autoOpen:!1,width:750,height:550,resizable:!0,buttons:{Done:function(){var e,t;return e="",t=SusyConfig.url.update_searched_editors,$("#form_editor_id option:gt(0)").remove(),n.find("a.selected").each(function(t,n){return e=e+$(n).data("assigned-user-id")+", ",$("#form_editor_id").append('<option value="'+$(n).data("assigned-user-id")+'">'+$(n).text()+"</option>")}),e=e.substring(0,e.length-2),$.post(t,{idsAssignedUser:e},function(e){return n.dialog("close")})},UnSelect:function(){return $(this).find("a").removeClass("selected")},Cancel:function(){return $(this).dialog("close")}}}),$("#selectAssignedEditors").on("click",function(e){return e.preventDefault,n.load($(this).data("url"),function(e){return n.dialog("open")})}),n.on("click","a",function(e){return e.preventDefault(),$(this).toggleClass("selected")}),0!==$("#regular_search").length)return i=function(e,t){return $.getJSON(e,function(e){var n,i,r,a,o,l;for(o=[],n=0,a=e.length;n<a;n++){i=e[n];for(r in i)l=i[r],o.push('<option value="'+r+'">'+l+"</option>")}return o.unshift(o.length>0?'<option value="">All</option><option value="-1">None</option>':'<option value="">---</option>'),$("#"+t).html(o.join("")),$("#"+t).trigger("chosen:updated")})},r=function(){return i(SusyConfig.url.list_sections.replace("/journal/0/","/journal/"+ +$("#form_journal_id").val()+"/"),"form_section_id")},a=function(){return i(SusyConfig.url.list_all_special_issues.replace("/journal/0/","/journal/"+ +$("#form_journal_id").val()+"/").replace("/section/0/","/section/"+ +$("#form_section_id").val()+"/"),"form_special_issue_id")},$("#form_journal_id").on("change",function(){return r(),a()}),$("#form_section_id").on("change",function(){return a()})})}.call(this),function(){$(function(){var e;if(0!==$("#publisher-notes-dlg").length)return e=$("#publisher-notes-dlg").dialog({modal:!0,autoOpen:!1,width:600,height:350,resizable:!0}),$(".publisherCheckNotes").on("click",function(t){var n,i;return t.preventDefault(),i=$(this).data("disabled"),n=$(this).children(),$.get($(this).data("url"),function(t){return e.html(t).dialog("open"),"disabled"===i&&($("#form_comments").prop("disabled","disabled"),$("#saveNotes").hide()),$("#saveNotes").on("click",function(t){var i,r;return r=$(this).parents("form").data("url"),i=$("#form_comments").val(),$.post(r,{data:i},function(t){var i,r;return"success"===t.status?(e.dialog("close"),i=n.attr("src").split("?"),i[0]="/bundles/mdpisusy/img/icon/notebook--plus.png",r=i.join("?"),n.attr("src",r)):alert("error")})})})}),$(".checkSign").on("click",function(e){var t,n,i;return n=$(this).prev().attr("id"),t=$(this).prev().val(),$(this).prev().replaceWith("<div id="+n+">"+t+"</div>"),i=$(this).next().children(),$(this).replaceWith("<span>sign</span>"),i.show(),i.on("click",function(){var e,t;return e=i.data("id"),t=i.data("url"),$.post(t,{data:e},function(e){return"success"===e.status?window.location.reload():alert("error")})})}),$(".sendCheckEmail").on("click",function(e){var t,n;return t=$(this),n=t.data("url"),$.post(n,function(e){return"success"===e.status?(t.after("<div class='success'>Ok!</div>"),t.next("div").fadeIn(500).fadeOut(1e3)):alert("Sending email failed, please save notes first.")})})})}.call(this),$(function(){function e(e){$.ajax({url:$("#display_manuscrip_log").data("url"),success:function(e){$("#manuscript-log-browser").html(e),$("#manuscript-log-browser").dialog("open")}})}function t(e,t,n){var a;new AjaxUpload(e,{action:$("#upload_manuscript").data("url").replace("/type","/"+n),name:"manuscript_upload",onSubmit:function(t,n){a=e.text(),e.text(""),e.html(SusyConfig.image.loading),this.disable()},onComplete:function(t,o){e.html(""),e.text(a),window.clearInterval(void 0),this.enable(),console.log(o),""!=o?($("#ajax_upload_message").removeClass("error_message").addClass("info_message").text("File '"+o+"' successfully uploaded.").show(),"manuscript"!=n&&"supplementary"!=n||(i=!0),"review"==n&&(r=!0)):($("#ajax_upload_message").removeClass("info_message").addClass("error_message").text("File '"+t+"' could not be uploaded.").show(),"manuscript"==n&&(i=!1),"review"==n&&(r=!1))}})}function n(){return!!a||(!(!i||!r)||(!(i&&!r)||($("#confirm").dialog("open"),!1)))}if(0!=$("#display_manuscrip_log").length){$("#manuscriptDetails").attr("data-rel");var i=!1,r=!1,a=!1;$("#manuscript-upload").dialog({modal:!0,autoOpen:!1,beforeclose:function(e,t){var r=n();return r&&($("#message").removeClass("info_message").addClass("error_message").text("").hide(),i&&location.reload(!0)),r},width:500,height:400,resizable:!1,buttons:{Done:function(){$(this).dialog("close")}}}),$("#manuscript-log-browser").dialog({modal:!0,autoOpen:!1,width:660,height:410,resizable:!1}),$("#confirm").dialog({bgiframe:!0,autoOpen:!1,width:350,height:180,modal:!0,resizable:!1,buttons:{OK:function(){a=!0,$(this).dialog("close"),$("#manuscript-upload").dialog("close")},Cancel:function(){a=!1,$(this).dialog("close")}}}),$("#upload_manuscript").click(function(){return i=!1,r=!1,a=!1,$("#manuscript-upload").dialog("open"),t($("#upload_word_document"),0,"manuscript"),t($("#upload_peer_review_pdf_document"),0,"review"),t($("#upload_supplementary_document"),0,"supplementary"),t($("#upload_figures_document"),0,"figures"),t($("#upload_graphical_document"),0,"graphical"),t($("#upload_permission_document"),0,"permission"),t($("#upload_nonPublished_document"),0,"non_published_material"),t($("#upload_final_archive_document"),0,"final-archive"),!1}),$("#display_manuscrip_log").click(function(){return e(),!1})}}),function(){$(function(){return $("img.quickform-error").tooltip(),$(".tooltip-error").tooltip(),$(".tooltip-info").tooltip({hide:{effect:"none",delay:0}})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f,p,m,v,g,b,_;if(!($(".uploadManuscript").length<1))return $("form").preventDuplicateSubmission(),$("#uploadSteps td[data-href]").on("click",function(e){return window.location=$(this).data("href")}),l=function(e){return $("<div>").text(e).html()},1===$(".step1").length&&(g=function(e,t){var n;return n=$("#"+t).val(),$.getJSON(e,function(e){var i,r,a,o,l,s,c,u;for(s=[],a=0,l=e.length;a<l;a++){r=e[a];for(o in r)u=r[o],c=o===n?' selected="selected"':"",s.push('<option value="'+o+'"'+c+">"+u+"</option>")}return i="---",s.length>0&&(i="form_article_type_id"===t?"select":"all"),s.unshift("<option value=''>"+i+"</option>"),$("#"+t).html(s.join("")),$("#"+t).trigger("change"),$("#"+t).trigger("chosen:updated")})},h=function(){return g(SusyConfig.url.list_article_types.replace("/journal/0/","/journal/"+ +$("#form_journal_id").val()+"/"),"form_article_type_id")},b=function(){return g(SusyConfig.url.list_sections.replace("/journal/0/","/journal/"+ +$("#form_journal_id").val()+"/"),"form_section_id")},_=function(){return g(SusyConfig.url.list_special_issues.replace("/journal/0/","/journal/"+ +$("#form_journal_id").val()+"/").replace("/section/0/","/section/"+ +$("#form_section_id").val()+"/"),"form_special_issue_id")},v=function(){return g(SusyConfig.url.list_collections.replace("/journal/0/","/journal/"+ +$("#form_journal_id").val()+"/").replace("/section/0/","/section/"+ +$("#form_section_id").val()+"/"),"form_collection")},s=function(e){var t,n;if(t=e.val())return n=SusyConfig.url.ajax_get_parent_section_id.replace("/special_issue/0/","/special_issue/"+ +t+"/"),$.getJSON(n,function(e){return $("#form_section_id").val(e.section_id),$("#form_section_id").trigger("chosen:updated")})},n=function(){var e,t,n,i,r;return e=$("#form_special_issue_id"),i=e.val(),n=$("#special-issue-info-section"),t=n.parents(".row"),i?(r=n.data("uri"),r=r.replace(/\/0$/,"/"+i),$.get(r,function(e){return e.submission_deadline?(n.html('<a href="'+e.si_website_link+'" target="_blank" rel="noopener noreferrer">Deadline for manuscript submissions: <b>'+e.submission_deadline+"</b></a>"),t.show()):t.hide()})):t.hide()},$("#form_journal_id").on("change",function(){return h(),b(),_(),v()}),$("#form_section_id").on("change",function(){return _()}),$("#form_section_id").on("change",function(){return v()})),o=function(){return""!==$("#form_collection").val()?$("#form_special_issue_id").prop("disabled","disabled"):$("#form_special_issue_id").removeAttr("disabled"),$("#form_special_issue_id").trigger("change"),$("#form_special_issue_id").trigger("chosen:updated")},a=function(){return""!==$("#form_special_issue_id").val()?$("#form_collection").prop("disabled","disabled"):$("#form_collection").removeAttr("disabled"),$("#form_collection").trigger("chosen:updated")},$("#form_special_issue_id").on("change",function(){return s($(this)),a(),n()}),$("#form_collection").on("change",function(){return s($(this)),o()}),o(),a(),1===$(".step2").length&&($("input#addAuthor").on("click",function(e){return e.preventDefault(),window.location=$(this).data("uri")}),i=null,r=null,$(".author_email").on("focus",function(){return i=$(this).attr("id"),r=i.replace(/\D+/,"")}),t={source:SusyConfig.url.get_authors_by_email_query,minLength:3,select:function(e,t){var n,i,a,o,l;for(a=0,o=(l=["firstname","lastname","orcid","institution_email","title_id","country_id","affiliation","url","scopus_url","twitter","short_cv"]).length;a<o;a++)i=l[a],void 0!==t.item[i]&&((n=$("#form_"+i+"_"+r)).val(t.item[i]),n.hasClass("chosen-select")&&n.trigger("chosen:updated"));return p()}},e=[],$(".search_author_email").each(function(){return e[$(this).attr("id")]=$(this).autocomplete(t)}),$(".author_reorder").on("click",function(e){var t,n,i;return e.preventDefault(),i=$(this),t=i.parents(".author_info"),n=i.data("order"),c(t,n)}),(p=function(){return setTimeout(function(){var e;return e=[],$('input[id^="form_firstname"]').each(function(t,n){var i,r,a,o;if(i=l($(this).val()),r=l($("#"+$(this).attr("id").replace("firstname","lastname")).val()),a=$.trim(i+" "+r),o=a?"("+a+")":"",$(this).parents(".author_info").find(".author_title_name").html(o),""!==r)return e.push(i+' <span class="author-lastname">'+r+"</span>")}),$("#addedAuthors").html(e.join("; "))},100)})(),(f=function(){var e,t,n,i,r,a,o,l;if(0!==$("#form_contributor_role_ids_1").length){$(".chosen-select").trigger("chosen:updated"),i=[],n=[],$("#form_contributor_role_ids_1 option").each(function(){return i[$(this).val()]=$(this).text()}),$('select[name^="form[contributor_role_ids"]').each(function(){var e,t,i,r,a,o,l,s;if(t=$("#"+$(this).prop("id").replace("contributor_role_ids","firstname")).val(),r=$("#"+$(this).prop("id").replace("contributor_role_ids","lastname")).val(),$.trim(t)&&$.trim(r)&&$(this).val()){for(e=t+" "+r,l=[],i=0,a=(o=$(this).val()).length;i<a;i++)s=o[i],n[s]||(n[s]=[]),l.push(n[s].push(e));return l}}),t="",e=[];for(r in n)a=(l=n[r]).pop(),o=l.length>0?l.join(", ")+" and "+a:a,e.push(i[r]+", "+o);return e.length>0&&(t=e.join("; ")+"."),t?($("#addedAuthorContributions").html(t),$("#addedAuthorContributionsSection").show()):$("#addedAuthorContributionsSection").hide()}})(),c=function(e,t){var n;if(null==t&&(t="up"),$.clearFormData(),"up"===t){if(!(n=e.prev())||!n.hasClass("author_info"))return}else if(!(n=e.next())||!n.hasClass("author_info"))return;return e.find("input[name], textarea[name], select[name]").each(function(e,t){var i;return i=$(t),n.find("input[name], textarea[name], select[name]").each(function(t,n){var r,a,o,l;if(r=$(n),e===t)return"radio"===i.prop("type")||"checkbox"===i.prop("type")?(a=r.is(":checked"),l=i.is(":checked"),i.data("checked",a),r.data("checked",l)):(o=r.val(),r.val(i.val()),i.val(o))})}),e.find("input[name]").each(function(e,t){var n;if("radio"===(n=$(t)).prop("type")||"checkbox"===n.prop("type"))return n.prop("checked",n.data("checked"))}),n.find("input[name]").each(function(e,t){var n;if("radio"===(n=$(t)).prop("type")||"checkbox"===n.prop("type"))return n.prop("checked",n.data("checked"))}),p(),f()},d=function(){return $.clearFormData(),"sort_prefix_",$(".author_info").each(function(e,t){var n,i,r,a;return i=e+1,n=$(t).find("div.author_title .author_title_text"),a=n.text(),r=a.replace(/\d+$/g,i),n.text(r),$(t).find("input[name], textarea[name], select[name]").each(function(){var e,t;return t=$(this).prop("name"),e=t.replace(/_\d+\](?=$|\[)/g,"_"+i+"]"),"radio"===$(this).prop("type")?$(this).prop("name","sort_prefix_"+e):$(this).prop("name",e)})}),$("input[name^='sort_prefix_']").each(function(){var e,t;return t=$(this).prop("name"),e=t.replace("sort_prefix_",""),$(this).prop("name",e)})},$('input[id^="form_firstname"], input[id^="form_lastname"]').on("keyup",function(){return p(),f()}),$('select[name^="form[contributor_role_ids"]').on("change",f),$("#sortable-authors").sortable({placeholder:"ui-state-highlight",update:function(e,t){return d()}}),function(){var e;return e=$(".author_info:first-child"),$(".author_info").each(function(){if(window.location.hash==="#"+$(this).prop("id"))return e=$(this),!1}),$(".author_info").each(function(){if($(this).find(".row .error").length>0)return e=$(this),!1}),$(".author_info").each(function(){return $(this).find(".row .error").length>0&&$(this).addClass("author_error_section"),e.prop("id")===$(this).prop("id")?($(this).find(".author_title_show_hide_btn").prop("title","Hide this author").html("[ - ]"),$(this).children("div.row").not("#add-me").show()):($(this).find(".author_title_show_hide_btn").prop("title","Show this author").html("[ + ]"),$(this).children("div.row").hide())})}(),$(".author_title_bar").on("click",function(e){var t,n;return t=$(this).parents(".author_info"),(n=$(this).find(".author_title_show_hide_btn")).text().indexOf("+")>=0?(t.children("div.row").show(),n.prop("title","Hide this author").html("[ - ]")):(t.children("div.row").hide(),n.prop("title","Show this author").html("[ + ]")),t.siblings(".author_info").children("div.row").hide(),t.siblings(".author_info").find(".author_title_show_hide_btn").prop("title","Show this author").html("[ + ]")}),$(".show-hide-authors").on("click",function(e){return e.preventDefault(),$(this).text().indexOf("+")>=0?($(".author_info").children("div.row").show(),$(".author_info").find(".author_title_show_hide_btn").prop("title","Hide this author").html("[ - ]"),$(this).prop("title","Hide all authors").html("[ - ]")):($(".author_info").children("div.row").hide(),$(".author_info").find(".author_title_show_hide_btn").prop("title","Show this author").html("[ + ]"),$(this).prop("title","Show all authors").html("[ + ]"))}),(m=function(e){var t,n;return null==e&&(e=null),e?(t=e.val().trim(),n=e.parents(".row").next().find(".author-twitter-link"),t?n.html("<a href='https://twitter.com/"+t+"' target='_blank' rel='noopener noreferrer'>"+t+"</a>"):n.html("Twittername")):$('input[name^="form[twitter_"]').each(function(){return m($(this))})})(),$('input[name^="form[twitter_"]').on("keyup",function(){return m($(this))}),$("#add-me").on("click","a",function(e){return e.preventDefault(),$("#form_email_1").val(SusyConfig.current_user.email),$("#form_firstname_1").val(SusyConfig.current_user.firstname),$("#form_lastname_1").val(SusyConfig.current_user.lastname),$("#form_title_id_1").val(SusyConfig.current_user.title_id),$("#form_country_id_1").val(SusyConfig.current_user.email).trigger("chosen:updated"),$("#form_affiliation_1").val(SusyConfig.current_user.organization),$("#add-me").hide()}),u=function(){if(0!==$("#add-me").length)return $("#form_email_1").is(":visible")&&""===$("#form_email_1").val()?$("#add-me").show():$("#add-me").hide()},setTimeout(u,500)),1===$(".step3").length&&($(".step3").find("form").on("submit",function(){var e;return e=$('input[id^="form_included_email_"]').length,$("#form_number_of_included_reviewers").val(e)}),i=null,r=null,$(".reviewerEmail").on("focus",function(){return i=$(this).attr("id"),r=i.replace(/\D+/,""),t={source:SusyConfig.url.get_reviewers_by_email_query,minLength:3,select:function(e,t){var n,a,o,l,s,c;for(l=-1!==i.indexOf("included")?"included":"excluded",c=[],a=0,o=(s=["firstname","lastname","affiliation"]).length;a<o;a++)n=s[a],c.push($("#form_"+l+"_"+n+"_"+r).val(t.item[n]));return c}},e=[],$(".reviewerEmail").each(function(){return e[$(this).attr("id")]=$(this).autocomplete(t)})})),1===$(".step4").length&&$("#addExternalSupplementary").on("click",function(e){return e.preventDefault(),$.ajax({type:"GET",success:function(e){var t;if(e)return t=parseInt($("#step4_form").attr("data-ext-supplement-len"))+1,$("#step4_form").attr("data-ext-supplement-len",t),$("#caption_warning").before(e)},url:$(this).data("url")})}),1===$(".step5").length?$("#cancelSubmission").on("click",function(){return window.location=$(this).data("url")}):void 0})}.call(this),function(){$(function(){if(0!==$("#subscribe-journals").length)return $("input[name=myFrequency]").length>0&&($("input[name=myFrequency]").checkBox(),$("input.checkbox_subs").checkBox(),$("input[name=myFrequency]").checkBox({change:function(e,t){if(t.checked)return $(this).parent().append(SusyConfig.image.loading),$.get(SusyConfig.url.update_alert_frequency+"?frequency="+$(this).val(),{success:function(){return $("#user-subscriptions img").remove()}})}})),$('#subscribe-journals input[id^="sub-journal-"]').checkBox({change:function(e,t){var n,i;return(n=$("#indicate-journal-"+$(this).val())).parent().append(SusyConfig.image.loading),i=SusyConfig.url.update_journal_subscription+"?journal_id="+$(this).val()+"&status="+(t.checked?"1":"0")+"&type="+$(".subscipt").val(),$.ajax({dataType:"json",url:i,success:function(e){if(n.siblings("img").remove(),!0===e.success)return t.checked?n.fadeIn():n.fadeOut()}})}})})}.call(this),function(){$(function(){if(0!==$("#subscribeSubjects").length)return $("#subscribeSubjects input[id^='subject-']").checkBox({change:function(e,t){var n,i;return i=$(this).val(),(n=$("#indicate-subject-"+i)).parent().append(SusyConfig.image.loading),$.post($("#subscribeSubjects").data("url"),{subject_id:i,checked:t.checked},function(e){if(n.siblings("img").remove(),""===e)return t.checked?n.fadeIn():n.fadeOut()})}})})}.call(this),function(){$(function(){var e,t,n;if(n=$("#send-register-email"),t=$("#send-register-email-info"),0!==n.length)return e={success:"<p>Another e-mail has been sent out.</p>",error:"<p>Sorry, we can't resend the registration out.</p>"},n.on("click",function(n){return n.preventDefault(),$.get($(this).data("url"),function(n){return t.html(e[n]).addClass(n).show()}).fail(function(){return t.html(e.error).addClass("error").show()}).always(function(){return setTimeout(function(){return t.hide("slow")},5e3)})})})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};$(function(){var t,n,i;if(0!==$("#blockedJournals-dialog").length)return $(".blacklist_expire_date").datepicker({dateFormat:"yy-mm-dd",showAnim:"fadeIn",changeMonth:!0,changeYear:!0,minDate:-1}),n=$("#blockedJournals-dialog").dialog({modal:!0,autoOpen:!1,width:680,height:550,resizable:!0,buttons:{Done:function(){var e,t,i;if(e="#"+$("#allJournals").attr("class"),$("#allJournals").removeAttr("class"),t=[],i={},n.find("a.selected").each(function(e,n){return t.push($(n).text()),i[$(n).data("journal-id")]=$(n).text()}),$(e).prev().html("<div>"+t.join(", ")+"</div>"),$(e).val(JSON.stringify(i)),$(e).prevAll("label").find("input").removeAttr("checked"),$(this).dialog("close"),n.find("a.selected").length>0)return $(e).parents("td").prev("td").find("input").prop("checked",!0)},SelectAll:function(){return n.find("a").addClass("selected")},UnSelectAll:function(){return n.find("a").removeClass("selected")}}}),i=function(t){var n,i;return i=[],""!==(n=$(t).nextAll(".blacklist_id_journal").val())&&$.each($.parseJSON(n),function(e,t){return i.push(e)}),$("#allJournals a").each(function(t,n){var r;if(r=""+$(n).data("journal-id"),e.call(i,r)>=0)return $(n).addClass("selected")})},$(".selectJournals").on("click",function(e){var t;return e.preventDefault(),t=$(this),n.load($(this).data("url"),function(e){return n.dialog("open"),i(t),$("#allJournals").attr("class",t.nextAll(".blacklist_id_journal").attr("id"))})}),n.on("click","a",function(e){return e.preventDefault(),$(this).toggleClass("selected")}),t="",$(".blacklist_all_journals").on("click",function(e){return this.checked?($(this).parent().nextAll(".selectedJournals").children().hide(),t=$(this).parent().nextAll(".blacklist_id_journal").val(),$(this).parent().nextAll(".blacklist_id_journal").val(""),$(this).parents("td").prev("td").find("input").prop("checked",!0)):($(this).parent().nextAll(".selectedJournals").children().show(),$(this).parent().nextAll(".blacklist_id_journal").val(t))}),"Edit"===$("legend").html()&&$("#form_email").prop({readonly:"true",onfocus:"this.blur()"}),$(".blacklist_id_journal").each(function(){var e;if(""!==$(this).val())return e=[],$.each($.parseJSON($(this).val()),function(t,n){return e.push(n)}),$(this).prev().html("<span>"+e.join(", ")+"</span>")}),$("#blacklist_main_form").on("submit",function(){return 0===$(".blacklist_type:checked").length?(alert("Please choose at least one type."),$(".blacklist_type:first").parent().css("color","red"),$(".blacklist_type:first").focus(),!1):$(".blacklist_type:not(:checked)").parent().next().find("input").attr("checked",!1).val("")}),$("#form_type_authors").on("click",function(){if($("#form_type_authors").is(":checked"))return $("#form_type_mail").prop("checked",!0),$("#form_mail_all_journals").prop("checked",!0),$("#form_type_reviewers").prop("checked",!0),$("#form_reviewers_all_journals").prop("checked",!0)}),$(".blacklist_type").on("click",function(){if($(this).is(":checked"))return $(this).parent().next().find(".blacklist_all_journals").prop("checked",!0)})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f,p,m,v,g;if(0!==$("#feed").length)return c=SusyConfig.url.feed,$("#invoice-feed").length>0&&(c=SusyConfig.url.invoice_feed),20,v=$("title").html(),n=null,i=null,a=null,t=null,function(){return{limit:20}},"feed-users","feed-dates","feed-ms","feed-english",o=$.sessionStorage("feed-dates"),g={limit:20},f=$.sessionStorage("feed-ms"),r=$.sessionStorage("feed-english"),f&&($("#feed-manuscript").val(f.value),i=f),$("#feed-users").html($.sessionStorage("feed-users")),o&&($("#feed-date-start").val(o.stm),$("#feed-date-end").val(o.etm)),r&&(t=r,$("#feed-english-id").val(r.value)),m=function(e){return e.split('class="feed-item"').length-1},p={},d=function(e){if(m(e)<20)return $("#show-more-feed").hide()},h=function(){var e,n,r;return $("#show-more-feed").show(),g.em=$("#feed-users span").map(function(){return $(this).data("feed-user-email")}).get().join(","),r=$("#feed-date-start").val(),e=$("#feed-date-end").val(),a=$("#feed-event-type-select").val(),n=$("#feed-journal-name-select").val(),r&&(g.stm=new Date(r).getTime()/1e3),e&&(g.etm=new Date(e).getTime()/1e3),i&&(g.hk=i.hash_key),t&&(g.ei=t.invoice_id),a?g.et=a:delete g.et,n&&(g.journal_name=n),$.sessionStorage("feed-users",$("#feed-users").html()),$.sessionStorage("feed-dates",{stm:r,etm:e}),$("#feed").load(c,g,function(e){return d(e)})},function(){var e;if(0!==$("#feed .feed-item").length)return e=$.extend({gid:$("#feed .feed-item:first").data("id")},g),$.get(c,e,function(e){return p.items=e,p.nb=m(e),p.nb>0?($("#feed-new-items").html("See "+p.nb+" new update"+(1===p.nb?"":"s")).show(),$("title").html("("+p.nb+") "+v)):($("title").html(v),$("#feed-new-items").html("").hide())})},e=function(e,t){return e.autocomplete({source:e.data("ajax-url"),minLength:3,select:function(e,n){return t(n)}})},u=$("#feed-user"),e(u,function(e){return n=e.item,u.val(n.value)}),s=$("#feed-manuscript"),e(s,function(e){return i=e.item,$("#feed-manuscript").val(i.value),$.sessionStorage("feed-ms",i)}),l=$("#feed-english-id"),e(l,function(e){return t=e.item,l.val(t.value),$.sessionStorage("feed-english",t)}),u.on("keydown",function(e){if(13===(e.keyCode||e.which))return $("#add-feed-user").trigger("click")}),$("#feed-date-start, #feed-date-end").datepicker({dateFormat:"yy-mm-dd",showAnim:"fadeIn",changeMonth:!0,changeYear:!0,maxDate:"+1D"}),$("#add-feed-user").on("click",function(e){if(e.preventDefault(),null!==n)return $("#feed-user").val(""),$("#feed-users").append('<span data-feed-user-email="'+n.email+'" title="'+n.email+'">'+n.value+' <a href="#">X</a></span>'),n=null}),$("#feed-users").on("click","a",function(e){return e.preventDefault(),$(this).parent().remove()}),$("#feed-apply").on("click",function(e){return e.preventDefault(),$("#add-feed-user").trigger("click"),h()}),$("#feed-reset").on("click",function(e){return e.preventDefault(),g={limit:20},n=i=t=null,$.sessionStorage("feed-users",null),$.sessionStorage("feed-dates",null),$.sessionStorage("feed-ms",null),$.sessionStorage("feed-english",null),$("#feed-date-start, #feed-date-end").val(""),$("#feed-users").html(""),$("#feed-manuscript").val(""),$("#feed-english-id").val(""),$("#feed-journal-name-select").val("0"),$("#feed-event-type-select").val("0"),$("#feed-journal-name-select").trigger("chosen:updated"),$("#feed-event-type-select").trigger("chosen:updated"),h()}),$("#show-more-feed").on("click",function(e){var t;return e.preventDefault(),t=$.extend({lid:$("#feed .feed-item:last").data("id")},g),$.get(c,t,function(e){return d(e),$("#feed").append(e)})}),$("#feed-new-items").on("click",function(e){return e.preventDefault(),$("#feed").prepend(p.items),p={},$(this).hide(),$("title").html(v)}),$("#feed-filter-ctl").on("click",function(e){return e.preventDefault(),$("#feed-filter div.row").toggle(),$(this).html(-1===$(this).html().indexOf("+")?"[+]":"[-]")}),$("#invoice-feed-export-button").on("click",function(e){var t,n,i,r,a;return e.preventDefault(),n=$("#invoice-feed-export-form"),r=n.find('input[name="stm"]'),i=n.find('input[name="etm"]'),r.val(""),i.val(""),a=$("#feed-date-start").val(),t=$("#feed-date-end").val(),a&&r.val(new Date(a).getTime()/1e3),t&&i.val(new Date(t).getTime()/1e3),n.submit()}),h()})}.call(this),function(){$(function(){var e,t,n,i;if(0!=="#display-user-info".length)return i=$("#display-user-info").dialog({modal:!0,autoOpen:!1,width:800,height:550,resizable:!0}),t=$("#display-user-publication-history").dialog({modal:!0,autoOpen:!1,width:800,height:550,resizable:!0}),n=$("#display-user-review-history").dialog({modal:!0,autoOpen:!1,width:800,height:550,resizable:!0}),e=function(e,t){return $.blockUI({message:"<p class='margin-1'>"+SusyConfig.image.loading+" Loading ...</p>"}),$.ajax({url:e.data("url"),data:{emails:t},type:"GET"}).done(function(t){return e.html(t).dialog("open")}).fail(function(){return $.alertError("Failed")}).always(function(){return $.unblockUI()})},$("body").on("click","a[data-user-publication-history-emails]",function(n){return n.preventDefault(),e(t,$(this).data("user-publication-history-emails"))}),$("body").on("click","a[data-user-review-history-emails]",function(t){return t.preventDefault(),e(n,$(this).data("user-review-history-emails"))}),$("body").on("click","a[data-user-info-emails]",function(t){return t.preventDefault(),e(i,$(this).data("user-info-emails"))}),$(".show-user-info-btn").on("click",function(t){var n;if(t.preventDefault(),""!==(n=$(this).prev(".user-info-email").val().trim()))return $(this).prop("disabled",!0),e(i,n),$(this).prop("disabled",!1)}),$(".user-info-email").on("keyup",function(e){if(13===(e.keyCode?e.keyCode:e.which))return $(this).next(".show-user-info-btn").trigger("click")})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f,p,m,v,g,b,_,w,y,k,x,C,D,S,I,O,F,j,E,T,A;if(0!==$("#invoiceSearchForm").length&&(p=window.location.hash.substring(1))&&""!==p&&$("#"+p).parent().css("backgroundColor","#FFFF99"),0!==(f=$("#form-invoice")).length){for(1,D={},x=["invoice-fees-apc","invoice-fees-waiver","invoice-total-without-vat","discount-voucher-amount"],$(".author-vouchers").each(function(e,t){return x.push($(t).attr("id"))}),g=0,_=x.length;g<_;g++)k=x[g],D[k]=+$("#"+k).data("value");for(S=f.data("invoice-payment-currency"),D["english-invoice-waiver"]=f.data("english-invoice-waiver"),C={},b=0,w=(t=["invoice-name","invoice-address1","invoice-address2","invoice-city","invoice-zipcode","invoice-country","invoice-telephone","invoice-fax"]).length;b<w;b++)C[e=t[b]]=$("#"+e).val();return h=1,i=f.data("billing-confirmed"),m=f.data("is-all-discounts-allowed"),$("#check-voucher").on("click",function(){return u()}),u=function(){var e,t,n;return t=document.getElementById("check-voucher"),e=t.getAttribute("data-invoice_id"),n=document.getElementById("discount-voucher").value,$.ajax({url:t.getAttribute("data-path"),type:"POST",cache:!1,dataType:"json",data:{voucherCode:n,invoiceId:e,setIsUsed:!0},success:function(e){var t,n,i;return e.isValid?(n=e.discount,"1"===e.isPercentage?document.getElementById("voucher-type").innerHTML="%":(t=(i=document.getElementById("invoice-payment-currency")).options[i.selectedIndex].value,document.getElementById("voucher-type").innerHTML=t),document.getElementById("discount-voucher-amount").value=n,D["discount-voucher-amount"]=n,$("#voucher-success").show().delay(3e3).fadeOut(),E()):(document.getElementById("discount-voucher-amount").value=0,D["discount-voucher-amount"]=0,$("#voucher-fail").show().delay(3e3).fadeOut(),E())}})},I=function(){return $("html, body").animate({scrollTop:$("legend:nth(1)").offset().top},500)},r=function(){var e,t,n,i,r,o,l,s,c,u;for(s=$("#invoice-country").val(),r=-1!==$("#invoice-country").data("western-countries").split(",").indexOf(s),$("#invoice-is-western-country").html(r?"Yes":"No"),u=f.data("vat-countries"),i=f.data("is-billing-manager"),u[s]&&1===i?($("#disable_vat").css("display","inline"),$("#invoice-vat").val($.number(u[s],1,".",""))):($("#disable_vat").css("display","none"),$("#invoice-vat").val("0")),c=$("#invoice-payment-currency").val(),e=["CHF","USD","EUR","GBP"],n="",44===Number(s)&&1===i&&e.unshift("CNY"),o=0,l=e.length;o<l;o++)n+=c===(t=e[o])?'<option value="'+t+'" selected>'+t+"</option>":'<option value="'+t+'">'+t+"</option>";return $("#invoice-payment-currency").html(n).trigger("chosen:updated"),a()},a=function(){var e,t;return t=document.getElementById("invoice-payment-currency"),e=t.options[t.selectedIndex].value,f.data("invoice-exchange-rate"),h=i&&S===e?f.data("invoice-exchange-rate"):f.data("apc-exchange-rates")[e],$("span.invoice-currency").html(e),"%"!==document.getElementById("voucher-type").innerHTML&&(document.getElementById("voucher-type").innerHTML=e),E()},T=function(){if($("#invoice-fees-waiver").val()<0)return $("#invoice-fees-waiver").prop("readonly",!0)},E=function(e){var t,n,i,r,a,o,l,s,c,u,d,p,v,g,b,_,w,y;return null==e&&(e=!0),y=(D["invoice-fees-waiver"]*h).toFixed(2),$("#invoice-fees-waiver").val(y),T(),o=(D["english-invoice-waiver"]*h).toFixed(2),$("#english-invoice-waiver").html(o),a=D["discount-voucher-amount"],"%"!==document.getElementById("voucher-type").innerHTML&&$("#discount-voucher-amount").val((a*h).toFixed(2)),d=0,$(".author-vouchers").each(function(e,t){var n,i,r;if(r=e+1,"%"!==document.getElementById("author-voucher-type"+r).innerHTML)return n=$(t).attr("id"),i=(D[n]*h).toFixed(2),$(t).val(i),d+=parseFloat(i)}),i=+$("#invoice-discount").val(),r=+$("#invoice-discount-membership").val(),i+=r,$(".author-vouchers").each(function(e,t){var n;if(n=e+1,"%"===document.getElementById("author-voucher-type"+n).innerHTML)return i+=parseFloat($(t).val())}),"%"===document.getElementById("voucher-type").innerHTML&&(i+=a),p=$("#invoice-country").val(),n=$("#invoice-payment-currency").val(),_=null!==document.getElementById("disable-vat")&&document.getElementById("disable-vat").checked?0:+p==+f.data("china-id")&&"CNY"!==n?0:+p==+f.data("switzerland-id")&&"CHF"!==n?0:(w=f.data("vat-countries"))[p]?$.number(w[p],1,".",""):0,$("#invoice-vat").val(_),c=-1!==$("#invoice-country").data("western-countries").split(",").indexOf(p),$("#invoice-is-western-country").html(c?"Yes":"No"),l=$("#fees-eng-required").is(":checked")?+f.data("fees-eng"):0,s=$("#fees-format-required").is(":checked")?+f.data("fees-format"):0,t=D["invoice-fees-apc"],u=l+s,$("#invoice-fees-apc").val($.number(t*h,2,".","")),b=$("#invoice-total-without-vat"),$("#invoice-total"),g=t+u,g-=g*(i/100),g*=h,g-=y,g-=d,"%"!==document.getElementById("voucher-type").innerHTML&&(g-=(a*h).toFixed(2)),0===Math.round(g)&&g<0&&(g=0),m||($("#discount-reason").val()>0||$("#author_voucher_container").find('input[name="author_vouchers[]"]').length>0?($("#selectMembershipInstitute").find("option[data-is-other-discount-allowed=0]").prop("disabled",!0),$("#selectMembershipInstitute").trigger("chosen:updated")):($("#selectMembershipInstitute").find("option").prop("disabled",!1),$("#selectMembershipInstitute").trigger("chosen:updated"))),e&&g<0&&alert("Total amount is below zero, please check"),b.val($.number(g,2,".","")),_=+$("#invoice-vat").val(),null!==document.getElementById("disable-vat")&&document.getElementById("disable-vat").checked?($("#invoice-vat").val(0),v=g):v=g+g*_/100,$("#invoice-total").val($.number(v,2,".",""))},(l=function(){return m||1===$("#selectMembershipInstitute option:selected").data("is-other-discount-allowed")?($("#author-voucher-prepare").prop("disabled",!1).parents(".voucher_prepare").show(),$("#discount-reason").prop("disabled",!1)):($("#author-voucher-prepare").prop("disabled",!0).parents(".voucher_prepare").hide(),$("#discount-reason").val("0").trigger("change").prop("disabled",!0),$("#invoice-discount").val("0"),$("#invoice-fees-waiver").val("0.00").trigger("change"))})(),r(),$("#invoice-country").on("change",function(){return r()}),$("#discount-reason").on("change",function(){return"0"===$("#discount-reason").val()?($("#invoice-discount-row").hide(),$("#invoice-discount").val(0),$("#invoice-fees-waiver").val("0.0"),D["invoice-fees-waiver"]="0.0",$("#invoice-waiver-row").hide(),$("#discount-comment").val(""),$("#discount-comment-row").hide(),$("#discount-comment").prop("required",!1)):("7"===$("#discount-reason").val()?($("#discount-comment-row").show(),$("#discount-comment").prop("required",!0)):($("#discount-comment-row").hide(),$("#discount-comment").prop("required",!1)),$("#invoice-discount-row").show(),$("#invoice-waiver-row").show()),E(!1)}),$("#disable-vat").change(function(){return E()}),c=function(e){var t,n,i,r,a,o;return n=!0,a=e.prop("required"),r=e.prop("pattern")?new RegExp(e.prop("pattern")):null,o=e.val(),i=e.parent("div"),t=null,a&&""===o?(i.addClass("error"),t="Please fill out this field.",n=!1):r&&!r.test(o)?(i.addClass("error"),t=e.prop("title")?e.prop("title"):"Please enter a valid value.",n=!1):i.removeClass("error"),F(i,t),n},F=function(e,t){var n;return null==t&&(t=null),n=e.find("div.error_message"),null===t&&n.length>0?n.remove():(0===n.length&&(e.append('<div class="error_message"></div>'),n=e.find("div.error_message")),n.html(t))},s=function(){var e,t,n,i,r,a,o,l,s,u;if(a=!0,f.find("input[name], select[name], textarea[name]").each(function(e,t){c($(this))||(a=!1)}),!a)return r=f.find("div.error").first(),$("html, body").animate({scrollTop:r.offset().top},500),!1;for(n=!1,o=0,l=(t=["invoice-aff-institute","invoice-name"]).length;o<l;o++)e=t[o],""!==(i=$("#"+e)).val()&&(n=!0,i.parent("div").removeClass("error"));for(u=0,s=t.length;u<s;u++)e=t[u],!0===n?i.parent("div").removeClass("error"):i.parent("div").addClass("error");return!1!==n&&(""===$("#discount-comment").val()&&"7"===$("#discount-reason").val()&&($("#invoice-discount").val()>0||parseFloat($("#invoice-fees-waiver").val())!==parseFloat("0"))?($("#invoice-discount-row").show(),$("#invoice-waiver-row").show(),$("#discount-comment-row").show(),alert("Please enter the discount explanation."),!1):!($("#invoice-total").val()<0)||(alert("Total amount is below zero, please check"),!1))},f.on("submit",function(e){return!!s()&&(e.preventDefault(),$("#save-invoice").append(SusyConfig.image.loading),$("#save-invoice .submit").prop("disabled",!0),$.post(f.attr("action"),f.serialize(),function(e){var t,n,r,a;if($("#save-invoice img").remove(),$("#save-invoice .submit").prop("disabled",!1),r=f.data("status"),i=f.data("billing-confirmed"),!f.data("pre-edit")){if("pending"===r&&!i)return n=f.data("send-invoice-url"),a=f.data("open_url"),t=$("#invoice-payment-currency").val(),window.location="CNY"!==S&&"CNY"!==t||S===t?n:a,!0;if("open"===r||"provisional"===r||"paid"===r)return a=f.data("open_url"),window.location=a,!0}return $("#invoice-form-fields").hide().next("fieldset").show(),I()}))}),$("#invoice-payment-currency").on("change",function(){return a()}),$("#invoice-modify-link").on("click",function(e){return e.preventDefault(),$(this).parents("fieldset").hide().prev("fieldset").show(),I()}),$("#invoice-fees-waiver").on("change",function(){var e;return e=document.getElementById("invoice-payment-currency"),e.options[e.selectedIndex].value,+$(this).val()/h>+$("#invoice-total-without-vat").val()/h+ +D[$(this).attr("id")]&&(alert("Invalid waiver"),$(this).val("0.0")),D[$(this).attr("id")]=+$(this).val()/h,E()}),o=function(){var e,t;return t=$("option:selected","#selectMembershipInstitute").data("discount"),e=document.getElementById("invoice-discount"),+$(e).val()>100-t&&(alert("Invalid discount"),$(e).val(0)),D[$(e).attr("id")]=+$(e).val(),E()},$("#invoice-discount").on("change",function(e){return o()}),$("#fees-eng-required, #fees-format-required, #fees-none").on("change",function(e){return E()}),$("#selectMembershipInstitute").chosen({no_results_text:"IOAP not found!",search_contains:!0}).change(function(e){var t,n,i,a,o,s,c,u,d,h,f,p,m,v;if(l(),(d=$("option:selected",this).data("country"))?($("#membershipInstituteImage").show(),$("#membershipInstituteInfo").show(),h=$("option:selected",this).data("discount"),$("#invoice-discount-membership").val(h),t=document.getElementById("invoice-discount"),100==+$(t).val()&&(v=+$(t).val()-h,$(t).val(v))):($("#invoice-name").val(C["invoice-name"]),$("#invoice-address1").val(C["invoice-address1"]),$("#invoice-address2").val(C["invoice-address2"]),$("#invoice-city").val(C["invoice-city"]),$("#invoice-zipcode").val(C["invoice-zipcode"]),$("#invoice-country").val(C["invoice-country"]),$("#invoice-telephone").val(C["invoice-telephone"]),$("#invoice-fax").val(C["invoice-fax"]),$("#membershipInstituteImage").hide(),$("#membershipInstituteInfo").hide(),$("#invoice-discount-membership").val(0)),1!==$("option:selected",this).data("payment")&&3!==$("option:selected",this).data("payment")||!0===(1===$("option:selected",this).data("payment")?confirm("The chosen institution is registered for central billing. Do you want the invoice information to be automatically prefilled with the institutional information? Or click Cancel to leave author's information."):confirm("The chosen institution is registered for split payment billing. Do you want the invoice information to be automatically prefilled and a second split invoice generated?"))&&(p=$("option:selected",this).data("name"),f=$("option:selected",this).data("email"),i=$("option:selected",this).data("institute"),n=$("option:selected",this).data("department"),a=$("option:selected",this).data("address1"),o=$("option:selected",this).data("address2"),u=$("option:selected",this).data("city"),m=$("option:selected",this).data("zipcode"),c=$("option:selected",this).data("author-vat"),s=$("option:selected",this).data("author-comment"),p?$("#invoice-name").val(p):$("#invoice-name").val(""),f?$("#invoice-email").val(f):$("#invoice-email").val(""),i?$("#invoice-aff-institute").val(i):$("#invoice-aff-institute").val(""),n?$("#invoice-aff-department").val(n):$("#invoice-aff-department").val(""),a?$("#invoice-address1").val(a):$("#invoice-address1").val(""),o?$("#invoice-address2").val(o):$("#invoice-address2").val(""),u?$("#invoice-city").val(u):$("#invoice-city").val(""),m?$("#invoice-zipcode").val(m):$("#invoice-zipcode").val(""),c&&$("#author-vat").val(c),s&&$("#invoice-comment").val(s),d&&($("#invoice-country").val(d),$("#membershipInstituteImage").show())),r(),$("#invoice-total").val()<0)return alert("Invalid discount"),$("#invoice-fees-waiver").trigger("change")}),""===f.data("can-edit")&&f.find("input, select, textarea").attr("disabled",!0),$("input[disabled]").css({background:"#D7D7D7",color:"black"}),$("#invoice-display_date").datepicker({dateFormat:"yy-mm-dd",showAnim:"fadeIn",changeMonth:!0,changeYear:!0}),y=$("option:selected","#selectMembershipInstitute").data("country"),"0"===$("#discount-reason").val()?($("#invoice-discount-row").hide(),$("#invoice-waiver-row").hide(),$("#discount-comment-row").hide()):($("#discount-comment-row").show(),"7"===$("#discount-reason").val()?($("#discount-comment-row").show(),$("#discount-comment").prop("required",!0)):($("#discount-comment-row").hide(),$("#discount-comment").prop("required",!1)),$("#invoice-waiver-row").show()),(parseFloat($("#invoice-fees-waiver").val())>parseFloat(0)||+$("#invoice-discount").val()>0)&&"0"===$("#discount-reason").val()&&($("#discount-reason").val(7),$("#discount-comment-row").show(),$("#invoice-discount-row").show(),$("#invoice-waiver-row").show()),""!==(v=f.data("is-member-author-of"))&&void 0===y&&alert('Some of the authors are from the "'+v+'" institution(s) but the membership was not selected. Please check.'),""===f.data("is-submission-user-from-membership")&&void 0!==y&&alert("The author email domain is not compatible with the selected IOAP participant. Please check."),$("#author_voucher_container").on("click",".rm-author-voucher",function(){var e,t;if(t="Are you sure remove "+$(this).parent().prev().text()+" ?",confirm(t))return e=$(this),$.get($(this).data("path"),function(t){if("1"===t)return e.parents(".row").fadeOut(800,function(){return $(this).remove(),n()}),D[e.prevAll(".author-vouchers").attr("id")]=0,E()})}),d=$("#author-voucher-prepare"),A=$("#warning_prepare"),$("#author-voucher-prepare").val(""),$("#add-new-author-voucher").on("click",function(){var e,t;if(!(e=$(this)).data("disabled")){if(t=$(".author-vouchers").length,""!==$.trim(d.val()))return e.data("disabled",!0),e.after(SusyConfig.image.loading),$.get($(this).data("path"),{voucher_length:t,code:$.trim(d.val()),invoice_id:$(this).data("invoice-id")},function(e){if("failed"!==e.status)return $("#author_voucher_container").append(e),n(),A.hide(),$("#author-voucher-prepare").val(""),j("author-voucher"+(t+1));A.html(e.message).css("color","red").fadeOut(100).fadeIn(100)}).always(function(){return e.data("disabled",!1),e.next("img").remove()});A.html("Please enter voucher code.").css("color","red").fadeOut(100).fadeIn(100)}}),j=function(e){return x.push(e),D[e]=$("#"+e).data("value"),a(),E()},n=function(){var e;return e=0,$(".author-vouchers").each(function(t,n){if(0===$(this).data("for-author"))return e++}),$("#non-associate-voucher-num").html(e),e>=3?$("#non-associate-voucher-num").parents(".row").show():$("#non-associate-voucher-num").parents(".row").hide()},function(){var e,t,n;if(n=f.data("membership-institute-id"),t=+f.data("membership-discount"),i=+f.data("billing-confirmed"),e=+$("#invoice-discount-membership").val(),!i&&n&&t!==e)return alert("Please note that the institutional membership discount has been updated from "+t+"% to "+e+"%. Please check.")}(),$("#save-invoice").find("input[type=submit]").on("click",function(e){return e.preventDefault(),"0"!==$("#discount-reason").val()&&+$("#invoice-discount").val()<=0&&0===parseFloat($("#invoice-fees-waiver").val())?alert("You have selected a discount or waiver reason but the discount or waiver number is not correctly entered. Please check."):$("#form-invoice").submit()}),$("#quick-send-invoice").on("click",function(e){var t,n;return t=$(this),e.preventDefault(),t.parent().append(SusyConfig.image.loading),n=t.data("send-url"),s()?(t.prop("disabled",!0),$.post(f.attr("action"),f.serialize(),function(){return $.post(n,function(e){return t.siblings("img").remove(),e>0?window.location=f.data("open_url"):(t.prop("disabled",!1),alert("Invoice sent failed"))})})):(t.siblings("img").remove(),!1)}),$("#set-as-free-btn").on("click",function(){return O()}),O=function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,p;return d=0,u=0,n=+$("#invoice-discount-membership").val(),u+=n,a=D["discount-voucher-amount"],"%"===document.getElementById("voucher-type").innerHTML?u+=parseFloat(a):d+=parseFloat(a),o="Discount Voucher(s): \n",$(".author-vouchers").each(function(e,t){var n,i,r,a;return a=e+1,"%"===document.getElementById("author-voucher-type"+a).innerHTML?(n=parseFloat($(t).val()),o+=n+"% \n",u+=n):(i=$(t).attr("id"),r=parseFloat(D[i]),o+=r+"CHF \n",d+=r)}),l=$("#fees-eng-required").is(":checked")?+f.data("fees-eng"):0,s=$("#fees-format-required").is(":checked")?+f.data("fees-format"):0,e=D["invoice-fees-apc"],c=l+s,h=e+c,"0"===(r=$("#discount-reason")).val()&&h<h*(u/100)+d&&(r.find('option[value="7"]').prop("selected",!0),r.trigger("change"),i="APC: "+e+"CHF \n",$("#discount-comment").val(i+o)),"0"===r.val()?(alert("Please select a discount reason."),!1):(0===d?(t=100-u,$("#invoice-discount").val(t)):(h-=h*(u/100),p=h-=d,D["invoice-fees-waiver"]=p),E())}}})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f,p,m,v,g,b,_,w,y,k,x,C,D,S,I,O,F;if(0!==(k=$("#author-invoice")).length){for(s=k.data("credit-surcharge"),n=k.data("apc-exchange-rates"),O=k.data("vat-countries"),o=+k.data("china-id"),+k.data("switzerland-id"),l=+k.data("credit-payment-id"),y=k.data("save-url"),c=k.data("disable-vat"),_=k.data("invoice-payment-currency"),w=$("#save-invoice-btn"),g={},d=0,f=(t=["invoice-name","invoice-address1","invoice-address2","invoice-city","invoice-zipcode","invoice-country"]).length;d<f;d++)g[e=t[d]]=$("#"+e).val();for(b={},h=0,p=(v=["invoice-fees-apc","invoice-fees-eng","invoice-fees-format","invoice-fees-waiver","invoice-discount","invoice-bankfees","invoice-total","invoice-total-without-vat","discount-voucher-amount"]).length;h<p;h++)b[m=v[h]]=+$("#"+m).data("value");if($("#invoice-author-vouchers").length&&(a=+$("#invoice-author-vouchers").val(),(a+=1)>1))for(u=1,i=0;u<a;)F="voucher-type"+u,r="author-voucher-amount"+u,$("#"+F).length&&(b[F]=+$("#"+r).data("value")),u++;return x=function(){var e,t,o,c,d,h,f,p,m,v,g,w,y,x,C,D;if(o=$("#invoice-payment-currency").val(),$(".invoice-currency").html(o),t=b["invoice-fees-apc"]+b["invoice-fees-eng"]+b["invoice-fees-format"],e=_===o?k.data("invoice-exchange-rate"):+n[o],+$('input[name="payment_method"]:checked').val()===l?(o=$("#invoice-payment-currency").val(),x=s[o]):x=0,$("#invoice-surcharge").val(x),h=$("#invoice-discount-membership").length?+$("#invoice-discount-membership").val():0,c=+$("#invoice-discount").val(),d=h+c,f=b["discount-voucher-amount"],"%"===$("#voucher-type").html()?(d+=f,f=0):$("#discountVoucherAmount").val($.number(f*e,2,".","")),D=t+x,i=0,$("#invoice-author-vouchers").length&&(a=+$("#invoice-author-vouchers").val(),(a+=1)>1))for(u=1,i=0;u<a;)F="voucher-type"+u,r="author-voucher-amount"+u,$("#"+F).length&&("%"!==document.getElementById(F).innerHTML?(i+=b[F],$("#"+r).val($.number(b[F]*e,2,".",""))):d+=Number(document.getElementById(r).value),u++);for(D=D-D*(d/100)+b["invoice-bankfees"]-i-f,D*=e,D-=(b["invoice-fees-waiver"]*e).toFixed(2),$("#invoice-total-without-vat").val($.number(D,2,".","")),C=D+D*(+$("#invoice-vat").val()/100),"CNY"===o&&(C=Math.round(C)),$("#invoice-total").val($.number(C,2,".","")),y=[],m=0,v=(w=["invoice-fees-apc","invoice-fees-eng","invoice-fees-format","invoice-fees-waiver"]).length;m<v;m++)g=b[p=w[m]]*e,y.push($("#"+p).val($.number(g,2,".","")));return y},I=function(){var e,t,n;return e=+$("#invoice-country").val(),t=$("#invoice-payment-currency").val(),+e==+o&&"CNY"!==t?(n=0,$("#invoice-vat").val(n)):O[e]&&0===c?$("#invoice-vat").val(O[e]):$("#invoice-vat").val(0)},C=function(){var e,t,n,i,r,a,o;for(e=+$("#invoice-country").val(),o=$("#invoice-payment-currency").val(),t=["CHF","USD","EUR","GBP"],i="",44===e&&"CNY"===_?(t.unshift("CNY"),$("input:radio[name='payment_method']:eq(0)").attr("checked",!0),$("input:radio[name='payment_method']:gt(0)").parent().hide()):$("input:radio[name='payment_method']:gt(0)").parent().show(),r=0,a=t.length;r<a;r++)i+=o===(n=t[r])?'<option value="'+n+'" selected>'+n+"</option>":'<option value="'+n+'">'+n+"</option>";return $("#invoice-payment-currency").html(i)},D=function(){return $("#invoice-credit-surcharge").hide()},$("#invoice-country").change(function(){return C(),I(),x()}),$('input[name="payment_method"]').on("click",function(){return D(),x()}),$("#invoice-payment-currency").on("change",function(){return I(),x()}),$('input[name="invoice_bankfees"]').on("change",function(){return S()}),w.on("click",function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f,p,m,v,g,b;for(b={},o=0,l=(a=["invoice-membership-institute","invoice-aff-department","invoice-aff-institute","invoice-address1","invoice-address2","invoice-city","invoice-name","invoice-email","invoice-country","invoice-zipcode","invoice-telephone","invoice-fax","invoice-comment","invoice-authorvat","invoice-authorcomment","invoice-bankfees","form__token"]).length;o<l;o++)r=a[o],b[(i=$("#"+r)).attr("name")]=i.val();for(b.payment_method=$('input[name="payment_method"]:checked').val(),p=document.getElementById("invoice-payment-currency"),b.payment_currency=p.options[p.selectedIndex].value,g=!0,d=0,s=(v=["invoice-email","invoice-address1","invoice-city","invoice-country","invoice-zipcode"]).length;d<s;d++)m=v[d],""===(i=$("#"+m)).val()?(g=!1,i.parent("div").addClass("error")):i.parent("div").removeClass("error");for(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test($("#invoice-email").val())?$("#invoice-email").parent("div").removeClass("error"):(g=!1,$("#invoice-email").parent("div").addClass("error")),n=!1,h=0,c=(t=["invoice-aff-institute","invoice-name"]).length;h<c;h++)e=t[h],""!==(i=$("#"+e)).val()&&(n=!0,i.parent("div").removeClass("error"));for(!1===n&&(g=!1),f=0,u=t.length;f<u;f++)e=t[f],!0===n?i.parent("div").removeClass("error"):i.parent("div").addClass("error");if(void 0===b.payment_currency?($("#invoice-payment-currency div").addClass("error"),g=!1):$("#invoice-payment-currency div").removeClass("error"),void 0===b.payment_method?($("#section-payment-method div").addClass("error"),g=!1):$("#section-payment-method div").removeClass("error"),g)return w.after(SusyConfig.image.loading),w.prop("disabled",!0),$.post(y,b,function(e){var t;if(w.next("img").remove(),w.prop("disabled",!1),e)return $("div.author-invoice").hide(),(t=$("div.author-invoice:last")).html(e).show(),$("html, body").animate({scrollTop:t.offset().top},500)});$("html, body").animate({scrollTop:$("#invoice-address-sec").offset().top},500)}),$("div.author-invoice").on("click","#invoice-confirm-btn",function(){return window.location.href=$(this).data("url")}),$("div.author-invoice").on("click","#invoice-modify-link",function(e){return e.preventDefault(),$("div.author-invoice").show(),$("div.author-invoice:last").hide()}),$("input[disabled]").css({background:"#D7D7D7",color:"black"}),C(),D(),I(),x(),S=function(){var e,t,n,i,r,a,o,l;return l=$("#invoice-total-without-vat"),a=$("#invoice-total"),t=$("#invoice-bankfees"),i=$("#invoice-discount"),o=b["invoice-total-without-vat"],r=b["invoice-total"],e=parseInt(t.val()),!1===/^\d+$/.test(e)&&(e=0),n=i.val(),o+=e,r=parseInt(r+e),n>0&&(o-=n*o/100,r-=n*r/100),l.val($.number(o,2,".","")),a.val($.number(r,2,".",""))}}})}.call(this),function(){$(function(){var e,t,n,i,r;return t=$("#ms-rlayout-fdb-dlg").dialog({modal:!0,autoOpen:!1,width:800,height:400,resizable:!0}),n=$("#ms-layout-form-dialog"),e=n.dialog({modal:!0,autoOpen:!1,width:800,height:"auto",resizable:!0}),i=function(){return $.ui.dialog.prototype._focusTabbable=function(){return!1}},r=function(t){var i,r;return i=t.parents("form.ajax-form"),r=i.prop("action"),t.after(SusyConfig.image.loading),t.prop("disabled",!0),$.ajax({url:r,type:"POST",cache:!1,data:new FormData(i[0]),processData:!1,contentType:!1}).always(function(){return t.next("img").remove(),t.prop("disabled",!1)}).done(function(t){return t.redirect_url?(e.dialog("close"),window.location.href=t.redirect_url):"success"===t.status?window.location.reload():t.message?$.alertError(t.message):n.html(t)}).fail(function(){return $.alertError("Failed!")})},$(".ms-rlayout-fdb").on("click",function(e){return e.preventDefault(),$.get($(this).data("url"),function(e){return t.html(e).dialog("open")})}),$(".ms-cancel-layout").on("click",function(e){var t,n,i,r;return e.preventDefault(),r=$(this).data("url"),i=$(this).data("title"),t=$(this).data("message"),n='<p style="text-align: center;">'+t+"</p>",$("#ms-cancel-layout-dlg").html(n).dialog({modal:!0,autoOpen:!1,width:600,height:200,resizable:!0,title:i,buttons:{Yes:function(){return $(this).dialog("close"),$.post(r,{},function(e){return"success"===e.status?window.location.reload():e.message?$.alert(e.message):$.alert("error")})},No:function(){return $(this).dialog("close")}}}).dialog("open")}),$(".ms-layout-form-btn").on("click",function(t){var n,r;return t.preventDefault(),n=$(this).data("title"),r=$(this).data("url"),e.html(""),$.get(r,function(t){return i(),e.dialog({title:n}).html(t).dialog("open")})}),n.on("click",'input[type="submit"]',function(e){var t;return e.preventDefault(),t=$(this),t.parents("form.ajax-form").data("layout-overloaded")&&$("#form_main").is(":checked")?$.confirm({icon:"fa fa-warning",type:"orange",title:"Caution: layout overloaded",boxWidth:"100%",useBootstrap:!1,content:"<p>The production team's work is much heavy. The edited version may be delivered to you tomorrow. <br>Please consider doing layout by yourself.</p>",buttons:{"Insist on sending layout":{btnClass:"btn-red",action:function(){return r(t)}},"Do layout by myself":{btnClass:"btn-blue",action:function(){}}}}):r(t)})})}.call(this),function(){$(function(){var e,t,n,i,r;if(0!==$("#ms-layout-crosscheck-dialog").length)return t=$("#ms-layout-crosscheck-dialog"),e=t.dialog({modal:!0,autoOpen:!1,width:800,height:"auto",resizable:!0}),n=function(){return $.ui.dialog.prototype._focusTabbable=function(){return!1}},i=function(){var e;return e=$("#form_body_pages").parents("div.row"),$("#form_main").is(":checked")?e.show():e.hide()},r=function(){var e;return e=$("#form_ref_num").parents("div.row"),$("#form_ref").is(":checked")?e.show():e.hide()},$(".ms-layout-crosscheck-btn").on("click",function(t){var a,o;return t.preventDefault(),a=$(this).data("title"),o=$(this).data("url"),e.html(""),$.get(o,function(t){return n(),e.dialog({title:a}).html(t).dialog("open"),i(),r()})}),t.on("click",'input[type="submit"]',function(n){var a,o,l;return n.preventDefault(),o=$(this),a=o.parents("form.ajax-form"),l=a.prop("action"),o.after(SusyConfig.image.loading),o.prop("disabled",!0),$.ajax({url:l,type:"POST",cache:!1,data:new FormData(a[0]),processData:!1,contentType:!1}).done(function(n){return o.next("img").remove(),o.prop("disabled",!1),n.redirect_url?(e.dialog("close"),window.location.href=n.redirect_url):"success"===n.status?window.location.reload():(t.html(n),i(),r())})}),t.on("click","#form_main",function(){return i()}),t.on("click","#form_ref",function(){return r()})})}.call(this),function(){$(function(){var e;if(0!==$("#similar-ms-act").length)return e=$("#manuscript-similar-browser").dialog({modal:!0,autoOpen:!1,width:800,height:400,resizable:!0}),$("#similar-ms-act").on("click",function(t){return t.preventDefault(),$.get($(this).data("url"),function(t){return e.html(t).dialog("open")})})})}.call(this),function(){var showConfirmButton,indexOf=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};$(function(){var hasDepartment,membershipInstituteId;if(0!==$("#apc #selectMembershipInstitute").length)return $("#apc").data("pre-selected-membership-institute")&&$("#apc").data("has-departments")||(membershipInstituteId=$("#selectMembershipInstitute").val(),$("#selectMembershipInstitute").length>0&&showConfirmButton(membershipInstituteId),$("#selectDepartment").next().hide()),$("#selectMembershipInstitute").change(function(e){return e.preventDefault(),membershipInstituteId=$(this).val(),$.ajax({type:"GET",data:{id:membershipInstituteId},url:SusyConfig.url.get_membership_departments,success:function(e){return e?($("#selectDepartment").attr("has-department",1),$("#selectDepartment").empty(),$("#selectDepartment").append(e),$("#selectDepartment").next().show(),membershipInstituteId=""):($("#selectDepartment").attr("has-department",0),$("#selectDepartment").empty(),$("#selectDepartment").next().hide()),$("#selectDepartment").trigger("chosen:updated"),$("#selectDepartment").next().css("width",$("#selectDepartment").width())}}),showConfirmButton(membershipInstituteId)}),(hasDepartment=$("#selectDepartment").attr("has-department"))&&$("#selectDepartment").chosen().change(function(e){var t;return t=$(this).val(),showConfirmButton(t),membershipInstituteId=t}),$("#selectMembershipInstitute").trigger("change"),$(".confirm-button").on("click",function(e){return e.preventDefault(),$.get(SusyConfig.url.validate_membership_code_query,{id:membershipInstituteId,type:"secure_code",secure_code:$("#secureCode").val()},function(res){var dialog;if("0"!==res||!membershipInstituteId)return dialog=$("#show-membership-information").dialog({autoOpen:!1,modal:!0,width:"550",buttons:{Cancel:function(){return dialog.dialog("close")},Proceed:function(){var hash_key;return dialog.dialog("close"),hash_key=$(".hash_key").val(),$(".show-flag").hide(),$(".add-institute").hide(),$("#message").hide(),$.ajax({type:"POST",data:{institute_id:membershipInstituteId},success:function(msg){return 1===(msg=eval("("+msg+")")).is_eligible?("non-uk-institute"===msg.college_block&&$("#"+msg.college_block).html(msg.college_page),$("#"+msg.college_block).slideDown(1e3),$("#submitEligible").attr("elementOpen",msg.college_block),$("#submitEligible").show()):$.ajax({type:"POST",data:{hash_key:$(".hash_key").val(),institute_id:membershipInstituteId,is_eligible:0},success:function(){return window.location.reload(!0)},url:SusyConfig.url.submit_membership_eligible})},url:SusyConfig.url.check_membership_eligible})}}}),$.ajax({type:"POST",data:{membership_institute_id:membershipInstituteId,hash_key:$(".hash_key").val()},success:function(e){return dialog.dialog("option","title","Confirm Institutional Open Access Program Eligibility").dialog("open").html(e)},url:SusyConfig.url.list_membership_informations_query});alert("You have entered an incorrect code. Please try again.")})}),$("#submitEligible").on("click",function(e){return e.preventDefault(),$.ajax({type:"POST",data:{hash_key:$(".hash_key").val(),institute_id:$("input[name=membership_id]").val(),is_eligible:$("[name=is_eligible]:checked").val()},url:SusyConfig.url.submit_membership_eligible,success:function(e){return $("#submitEligible").hide(),$("#"+$("#submitEligible").attr("elementOpen")).slideUp(1e3),window.location.reload(!0)}})})}),showConfirmButton=function(e){var t,n;return"reduction on the APC.",t="","3297"===e&&(t='University of Nottingham authors who wish to apply for an article processing charge (APC) to be paid out of central University funds must apply using the form available at: <a href="http://nottingham.ac.uk/library/research/open-access/requesting-oa-funding/funding.aspx" target="_blank" rel="noopener noreferrer">http://nottingham.ac.uk/library/research/open-access/requesting-oa-funding/funding.aspx</a>. If no application is received, the author will be responsible for payment of the APC invoice.'),n=$("#showSecureCode").data("code-ids"),""===e?($("#showDiscountMessage").hide(),$("#showDiscountSeason").hide(),$("#showAdditionalMessage").hide(),$(".confirm-button").hide(),!1):($('input[name="membership_id"]').val(e),n&&(indexOf.call(n,e)>=0?$("#showSecureCode").show():$("#showSecureCode").hide()),$.ajax({type:"POST",data:{hashKey:$(".hash_key").val(),membershipInstituteId:e},url:SusyConfig.url.send_membership_discount_query,success:function(e){return"10-15"===e[0]?($("#showDiscountMessage").html(e[0]+"%* reduction on the APC."),$("#showDiscountMessage").css("width","200px"),$("#showDiscountSeason").html("<p style='font-size:12px'>"+e[1]+"</p>"),$("#showDiscountSeason").show()):$("#showDiscountMessage").html(e[0]+"% reduction on the APC."),null!==e[1]?($("#showDiscountSeason").show(),$("#showDiscountSeason").html("<p style='font-size:12px'>"+e[1]+"</p>")):$("#showDiscountSeason").hide(),$("#showDiscountMessage").show(),$("#showAdditionalMessage").html(t).show(),$(".confirm-button").show()}}))}}.call(this),function(){$(function(){if(0!==$("#funding-info-section").length)return $('input[name="funding_info_choice"]').on("change",function(){return"1"===$(this).val()?$("#funding-info-section").show():$("#funding-info-section").hide()}),$("#funding-info-section").on("keyup.autocomplete","input[data-search-funding-url]",function(){var searchFundingInput,searchUrl;return searchFundingInput=$(this),searchUrl=searchFundingInput.data("search-funding-url"),$(this).autocomplete({html:!0,minLength:2,delay:700,source:function(request,response){return $.get(searchUrl,{descendants:!0,q:request.term},function(res){return response($.map(eval("("+res+")"),function(e){return{label:e.value+'  <span style="color:gray;font-size:10px;">'+e.country+"</span>",value:e.value}}))})},select:function(e,t){var n;return n=t.item.value,$("#search-add-funding-section").find(".funding_body").val(n),searchFundingInput.val(""),!1}})}),$("#funding-info-section").on("click",".save_funding_info",function(){var e,t,n,i,r,a,o,l;return o=$(this),t=o.parents(".funding_and_number"),n=t.find(".funding_body"),r=t.find(".grant_number"),i=$.trim(n.val()),a=$.trim(r.val()),l=o.data("save-funding-url"),e=t.find("ul.error"),""===i||""===a?(e.find("li").html("Please fill out both funder and grant number."),e.show()):(e.hide(),o.prop("disabled",!0),o.after(SusyConfig.image.loading),$.post(l,{funding_body:i,grant_number:a},function(e){return $("#funding-info-section").html(e),$("#funding-list-section").fadeOut().fadeIn()}))}),$("#funding-info-section").on("click",".delete_funding_btn",function(e){var t,n;if(e.preventDefault(),t=$(this),n=t.data("delete-funding-url"),confirm("Are you sure to remove this funding?"))return $.post(n,function(e){return $("#funding-info-section").html(e),$("#funding-list-section").fadeOut().fadeIn()})})})}.call(this),function(){$(function(){var e,t,n;if(0!==$(".show-email-tips").length)return e=$(".show-email-tips"),(t=$("#confirm_email_change")).dialog({modal:!0,autoOpen:!1,width:250,height:110}),(n=$("#change_email_info")).dialog({modal:!0,autoOpen:!1,width:600,height:300,close:function(){return window.location=$("#change_email_info").data("logout-url")},buttons:{Ok:function(){return window.location=$("#change_email_info").data("logout-url")}}}),$("#change_user_email").on("click",function(){var e;return e=$.trim($(".show-email-tips #form_email").val()),$("#invalid-email-node").remove(),/^([\w-\.]+)@((?:[\w\-_]+\.)+)([a-zA-Z]{2,4})/.test(e)?t.dialog("open"):$(".show-email-tips #form_email").after('<span id="invalid-email-node" style="color:red">invalid email</span>'),!1}),$("#confirm_email_change #user-change-email-submit").on("click",function(){return $.post(e.attr("action"),e.serialize(),function(e){var i,r,a;return $("#invalid-email-node").remove(),t.dialog("close"),"-1"===e?$(".show-email-tips #form_email").after('<p id="invalid-email-node" style="color:red">The e-mail address has been registered, please choose another one.</p>'):(n.dialog("open"),n.html(e),a=$("#send-chgemail-email"),r=$("#send-chgemail-email-info"),i={success:"<p>Another e-mail has been sent out.</p>",error:"<p>Sorry, we can't resend the registration out.</p>"},a.bind("click",function(e){return $.get($(this).data("url"),function(e){return r.html(i[e]).addClass(e).show()}).fail(function(){return r.html(i.error).addClass("error").show()}).always(function(){return setTimeout(function(){return r.hide("slow")},5e3)})}))})}),$("#confirm_email_change #user-change-email-cancel").on("click",function(){return t.dialog("close")})}),$(function(){var e,t;if(0!==$(".bind-email-tips").length)return e=$(".bind-email-tips"),$("#confirm_email_bind").dialog({modal:!0,autoOpen:!1,width:250,height:110}),(t=$("#bind_email_info")).dialog({modal:!0,autoOpen:!1,width:600,height:300,close:function(){return window.location=e.attr("action")},buttons:{Ok:function(){return window.location=e.attr("action")}}}),$("#bind_user_email").on("click",function(){var n;return n=$.trim($(".bind-email-tips #form_email").val()),$("#invalid-email-node").remove(),/^([\w-\.]+)@((?:[\w\-_]+\.)+)([a-zA-Z]{2,4})/.test(n)?$.post(e.attr("action"),e.serialize(),function(e){var n,i,r;return $("#invalid-email-node").remove(),$("#confirm_email_bind").dialog("close"),"-1"===e?$(".bind-email-tips #form_email").after('<span id="invalid-email-node" style="color:red">This address is already linked to an account.</span>'):(t.dialog("open"),t.html(e),r=$("#send-bindemail-email"),i=$("#send-bindemail-email-info"),n={success:"<p>Another e-mail has been sent out.</p>",error:"<p>Sorry, we can't resend the registration out.</p>"},r.bind("click",function(e){return $.get($(this).data("url"),function(e){return i.html(n[e]).addClass(e).show()}).fail(function(){return i.html(n.error).addClass("error").show()}).always(function(){return setTimeout(function(){return i.hide("slow")},5e3)})}))}):$(".bind-email-tips #form_email").after('<span id="invalid-email-node" style="color:red">invalid email</span>'),!1}),$("#confirm_email_bind #user-bind-email-submit").on("click",function(){return $.post(e.attr("action"),e.serialize(),function(e){var n,i,r;return $("#invalid-email-node").remove(),$("#confirm_email_bind").dialog("close"),"-1"===e?$(".bind-email-tips #form_email").after('<span id="invalid-email-node" style="color:red">This address is already linked to an account.</span>'):(t.dialog("open"),t.html(e),r=$("#send-bindemail-email"),i=$("#send-bindemail-email-info"),n={success:"<p>Another e-mail has been sent out.</p>",error:"<p>Sorry, we can't resend the registration out.</p>"},r.bind("click",function(e){return $.get($(this).data("url"),function(e){return i.html(n[e]).addClass(e).show()}).fail(function(){return i.html(n.error).addClass("error").show()}).always(function(){return setTimeout(function(){return i.hide("slow")},5e3)})}))})}),$("#confirm_email_bind #user-bind-email-cancel").on("click",function(){return $("#confirm_email_bind").dialog("close")}),$(".send_validate_email_again").on("click",function(){return $.get($(this).data("validate-email-url"),function(e){return t.dialog("open"),t.html(e)})}),$("#confirm_email_unbind").dialog({modal:!0,autoOpen:!1,width:250,height:110}),$(".unbindEmail").on("click",function(){return $("#confirm_email_unbind").data("unbind-url",$(this).data("unbind-email-url")),$("#confirm_email_unbind").dialog("open")}),$("#confirm_email_unbind #user-unbind-email-submit").on("click",function(){return $.get($("#confirm_email_unbind").data("unbind-url"),function(t){return window.location=e.attr("action")})}),$("#confirm_email_unbind #user-unbind-email-cancel").on("click",function(){return $("#confirm_email_unbind").dialog("close")})})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};$(function(){var t,n;if($("#myprofile").length>0)return t=function(e,t){var n,i,r;return r=SusyConfig.url.myprofile_get_articles_path,n=r+e,i="",$.ajax({url:n,dataType:"json",success:function(e){var n;{if(!e.error){for(n in e)i+='<h5><a href="'+e[n].link+'" target="_blank">'+e[n].title+'</a></h5> <p style="font-size: 12px;">'+e[n].description+'</p> <p style="font-size: 10px; color: #333">pubDate:'+e[n].pubDate+"</p>";return t.html(i)}t.html(e.error)}}})},n=function(t){var n,i;if(new RegExp("^\\d+$").test(t.find("input").val()))return i=window.location.href.replace(/&?no_action_days=[\w\.]+&?/,""),n="no_action_days="+t.find("input").val(),window.location=e.call(i,"?")>=0?""+i+n:i+"?"+n;t.nextAll(".errorMsg").show()},$(".myprofile-articles").each(function(e){return t($(this).data("type"),$(this))}),$(".sortField").tablesorter(),$("a.show-hide-button").on("click",function(){var e;return!1===(e=$(this).parents(".collapse-header").next()).is(":visible")?$(this).text($(this).text().replace("expand","collapse")):$(this).text($(this).text().replace("collapse","expand")),e.fadeToggle("slow")}),$("#collapse_all").on("click",function(){return"collapse all"===$(this).val()?($(this).val("expand all"),$("#collapse_all_section").fadeOut(),$(".collapse-header.section").fadeOut(),$(".collapse-header").next().fadeOut(),$(".more-data").fadeOut(),$(".show-hide-button").each(function(e){return $(this).val($(this).val().replace("collapse","expand"))})):($(this).val("collapse all"),$(".collapse-header.section").fadeIn(),$(".collapse-header").next().fadeIn(),$(".more-data").fadeIn(),$(".show-hide-button").each(function(e){return $(this).val($(this).val().replace("expand","collapse"))}))}),$("#no_action_gt_5 span:first-child").on("click",function(){var e,t,i;return t=$(this),i=t.text().replace(/[^0-9]/gi,""),e="No action for > <input class='day' type='text' style='display: inline-block; width: 30px;' value='"+i+"' placeholder='number of submissions'> working days (number of day before submissions)",0===t.find("input").length&&t.empty().html(e),t.next().show(),t.next("input").on("click",function(){return n(t)}),t.find("input").on("keyup",function(e){if(e.preventDefault(),13===e.keyCode)return n(t)})}),$("#no_action_gt_5 span:first-child").trigger("click")})}.call(this),function(){$(function(){if(0!==$(".volunteer_reviewer").length)return $("#publication_file_trigger, #publication_file_name").on("click",function(e){return e.preventDefault(),$("#form_file_pub").trigger("click")}),$("#form_file_pub").on("change",function(e){return e.preventDefault(),$("#publication_file_name").empty().html($(this).val())}),$("form#volunteer-register").on("submit",function(){if(0===$("#form_journal_review_chosen .search-choice").length)return $("#form_journal_review_chosen ul.chosen-choices").css({border:"1px solid #ff7358","box-shadow":"0px 0px 2px #f00"}),!1})})}.call(this),function(){$(function(){var Voucher,addManuscriptVoucher,current_user_email,current_user_emails,current_user_linked_emails,discountVoucherSection;if(current_user_email=SusyConfig.current_user.email,current_user_linked_emails=SusyConfig.current_user.linkedEmails,0!==$("#discount-voucher").length)return discountVoucherSection=$("#discount-voucher"),$(".apc-tabs > span").eq(0).hasClass("current")||$(".apc-tabs > span").eq(1).trigger("click"),(current_user_emails=current_user_linked_emails.split(", ")).push(current_user_email.toLowerCase()),Voucher={beforeValid:function(e){var t;return $("#voucher-message"),t=null,16!==e.length?t="The length of voucher code must be 16.":$(".voucher-code").each(function(n,i){if($.trim($(i).text())===e)return t=e+" already in the list.",!1}),!t||($("#voucher-error").show().html(t),$("#voucher-success").hide(),!1)},append:function(data){var newVoucherNode,voucher,voucherAppend,voucher_box;if(voucher=eval("("+data+")"),this.beforeValid(voucher.code))return voucherAppend=[voucher.code,voucher.createdForEmail,voucher.discount+("1"===voucher.isPercentage||1===voucher.isPercentage?" %":" CHF"),voucher.validTo,"1"===voucher.mutualExclusion||1===voucher.mutualExclusion?'<input value="'+voucher.code+'" class="voucher-codes" type="checkbox" name="group-mutual-exclusion" style="cursor:pointer; vertical-align: middle;">':'<input value="'+voucher.code+'" class="voucher-codes" type="checkbox" style="cursor:pointer; vertical-align: middle;">'],voucher_box=$("#discount-voucher-box"),(newVoucherNode=voucher_box.find("tr:last-child").clone()).find("td").each(function(e,t){return $(t).html(voucherAppend[e])}),voucher_box.append(newVoucherNode)}},discountVoucherSection.on("keyup input propertychange","#voucher-code",function(){var addedVoucherCodes,code;if(code=$("#voucher-code").val(),addedVoucherCodes=[],$(".voucher-code").each(function(){return addedVoucherCodes.push($(this).text().trim())}),Voucher.beforeValid(code))return $.ajax({url:SusyConfig.url.check_voucher_for_manuscript,type:"POST",data:{voucher_code:code,hk:$(".hash_key").val(),added_voucher_codes:addedVoucherCodes},success:function(msg){return(msg=eval("("+msg+")")).error?($("#voucher-error").show().html(msg.error),$("#voucher-success").hide()):($("#voucher-success").show().data("append",msg.voucher),$("#voucher-code").prop("disabled",!0),$("#voucher-error").hide())}})}),discountVoucherSection.on("click","#voucher-success",function(){return Voucher.append($(this).data("append")),$(this).hide().prev().removeAttr("disabled").val("")}),discountVoucherSection.on("click","#confirm-vouchers",function(){return $(this).after(SusyConfig.image.loading),addManuscriptVoucher(SusyConfig.url.manuscript_add_voucher,!0)}),discountVoucherSection.on("change",".voucher-codes",function(){return $(this).after(SusyConfig.image.loading),addManuscriptVoucher($("#confirm-vouchers").data("pre-add-url"))}),addManuscriptVoucher=function(e,t){var n;return null==t&&(t=!1),n=[],$(".voucher-codes:checked").each(function(e,t){return n.push($(t).val())}),$.post(e,{codes:n,hk:$(".hash_key").val()},function(e){return e.error?alert(e.error):(discountVoucherSection.html(e),t?window.location.reload(!0):void 0)})},$(".voucher-codes:checked").length>0?addManuscriptVoucher($("#confirm-vouchers").data("pre-add-url")):void 0})}.call(this),function(){$(function(){var e,t;if(0!==$("#english-editor-notes").length)return t=function(e){var t,n,i;return e.dialog("open"),t=$("#container"),n=t.offset(),i=t.outerWidth(),$("#english-editor-notes").parents("div.ui-dialog").css({top:n.top+"px",left:n.left+i-400+"px"})},e=$("#english-editor-notes").dialog({autoOpen:!1,width:400,height:300,resizable:!0}),t(e),$("#editor2note").on("change",function(){return $("#english-notes-box").load($(this).data("load-url"),{editor_id:$(this).val()})}),$("#editor2note").trigger("change"),$("#english-editor-notes-btn").on("click",function(){return t(e)})})}.call(this),function(){$(function(){var backAction,checkmailsdb,fillForm,form,hideInvitions,showAddForm,updateOptions,updateSections;if(0!==$(".special-issue").length)return $(".remove").on("click",function(){var e;if(e="Are you sure to delete SI "+$(this).data("si-name")+"?",!confirm(e))return!1}),$(".reset-status").on("click",function(){var e;if(e="Are you sure to reset  the status of "+$(this).data("si-name")+" to Pending GE invitation?",!confirm(e))return!1}),$("#search-si").on("keyup, input propertychange",function(){var e;if(!((e=$(this).val()).length<3&&0!==e.length))return $.ajax({url:SusyConfig.url.search_special_issue,data:{term:e},success:function(e){var t;return t=0,$("#si-box > tr").each(function(n,i){var r;return-1===$.inArray(String($(i).data("id")),e)?$(i).hide():($(i).show(),r=t%2==0?"#fff":"#f9f9f9",$(i).css("background",r),t+=1)})}})}),1===$("#edit-si").length&&(updateOptions=function(e,t){return $.getJSON(e,function(e){var n,i,r,a,o,l;for(o=[],i=0,a=e.length;i<a;i++){n=e[i];for(r in n)l=n[r],o.push('<option value="'+r+'">'+l+"</option>")}return o.unshift(o.length>0?'<option value="">All</option>':'<option value="">---</option>'),$("#"+t).html(o.join(""))})},$("#form_id_journal").on("change",function(){return updateOptions(SusyConfig.url.list_sections.replace("/journal/0/","/journal/"+ +$("#form_id_journal").val()+"/"),"form_id_section")})),checkmailsdb=$("#checkMailsdb"),$("#checkMailsdb").on("click",function(){return window.open(checkmailsdb.data("mailsdb-search-url")+"?time="+(new Date).getTime()+"&emails="+$.trim($("#form_email").val())+"&key="+checkmailsdb.data("mailsdb-key"))}),1===$("#guestForm").length&&((form=$("#guestForm")).on("click",".show_hidden_editor_rel",function(e){return $(".hidden_editor_rel").is(":hidden")?($(".hidden_editor_rel").show(),$(".show_hidden_editor_rel").html("show less")):($(".hidden_editor_rel").hide(),$(".show_hidden_editor_rel").html("show more"))}),$("#guestNextBtn").click(function(_this){return function(e){var emailStatus,formEmailValue,specialIssueId;return formEmailValue=$.trim($("#form_email").val()),specialIssueId=$("#special_issue_id").data("special-issue-id"),emailStatus=$("#email_status"),/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(formEmailValue)?(emailStatus.html(""),$("#form_email").attr("readonly",!0),$.get(form.data("guest-check-url"),{email:formEmailValue,special_issue_id:specialIssueId},function(data){var json_data;return $("#checkMailsdb").show(),""===(data=$.trim(data))?showAddForm():($("#guestNextBtn").hide(),$(".guestWarn").html(data),$(""),(json_data=$("#json_guest").html())&&(json_data=eval("("+json_data+")")).firstname?fillForm(json_data):void 0)})):(emailStatus.html("Invalid email address"),emailStatus.css("color","red"))}}(this)),form.on("click","#keep-guest",function(e){return $("#form_update").val(0),$("#submitBtn").click()}),form.on("click","#updateGuest",function(e){return e.preventDefault(),$("#form_update").val(1),$("#submitBtn_check").val("Update Guest Editor"),showAddForm()}),$("#submitBtn").on("click",function(e){if(""===$.trim($("#form_firstname").val())&&""===$.trim($("#form_lastname").val()))return!1}),$("#cancelBtn").click(function(e){return $("#addGuestForm").hide(),$("#form_email").removeAttr("readonly"),$("#guestNextBtn").css("display","inline-block"),$("#resetBtn").click(),hideInvitions()}),backAction=function(){return $(".guestWarn").html(""),$("#guestNextBtn").show(),$("#resetBtn").click(),$("#form_email").removeAttr("readonly"),hideInvitions()},form.on("click","#specialBackBtn",function(e){return e.preventDefault(),backAction()}),showAddForm=function(){return $("#addGuestForm").show(),$(".guestWarn").html(""),$("#guestNextBtn").hide()},fillForm=function(e){return $("#form_email").val(e.email),$("#form_firstname").val(e.firstname),$("#form_lastname").val(e.lastname),$("#form_affiliation").val(e.affiliation),$("#form_telephone").val(e.telephone),$("#form_title").val(e.title),$("#form_url").val(e.url),$("#form_country").val(e.country),$("#form_research_interest").val(e.research_keywords),$("#form_h_index").val(e.h_index),$("#form_hindex_url").val(e.hindex_url)},hideInvitions=function(){return $("#invitations_row").find("#invitations").html(""),$("#invitations_row").hide()},$("a.displayGuestInfo").click(function(e){return e.preventDefault(),$("#display-guest-info").dialog({modal:!0,autoOpen:!1,width:1e3,height:"auto",resizable:!0}).html($(this).prev().html()).dialog("open")}),$("a.editGuestInfo").length>=1&&($("#edit-guest-info").on("click","a.closeDialog",function(e){return e.preventDefault(),$("#edit-guest-info").dialog("close")}),$("a.editGuestInfo").click(function(e){var t;return e.preventDefault(),(t=$("#edit-guest-info")).dialog({modal:!0,autoOpen:!1,width:900,height:600,resizable:!0}),$.get($(this).data("editurl"),function(e){return t.html(e).dialog("open")})}))),$("#si-withdraw").on("click",function(e){var t,n,i;return e.preventDefault(),n=$(this).data("url"),t=$(this).data("list-si-url"),(i=$("#withdraw-si-dialog")).dialog({modal:!0,autoOpen:!1,width:600,height:"auto",resizable:!0,buttons:{Confirm:function(){return $.post(n,{},function(e){return window.location.replace(t)}),$(this).dialog("close")},Cancel:function(){return $(this).dialog("close")}}}),i.dialog("open")}),$("#si-export-report-btn").on("click",function(e){var t,n;return e.preventDefault(),n=$(this).data("uri"),t={},$(this).siblings(".si-export-report-selection").each(function(){return t[$(this).prop("name")]=$(this).val()}),$.post(n,t,function(e){return"success"===e.status?$.alert({icon:"fa fa-check",type:"blue",title:"Success",content:e.message}):$.alert({icon:"fa fa-warning",type:"red",title:"Error",content:e.message})})}),updateOptions=function(e,t){return $.getJSON(e,function(e){var n,i,r,a,o,l;for(o=[],i=0,a=e.length;i<a;i++){n=e[i];for(r in n)l=n[r],o.push('<option value="'+r+'">'+l+"</option>")}return o.unshift(o.length>0?'<option value="">All</option><option value="-1">None</option>':'<option value="">---</option>'),$("#"+t).html(o.join("")),$("#"+t).trigger("chosen:updated")})},updateSections=function(){return updateOptions(SusyConfig.url.list_sections.replace("/journal/0/","/journal/"+ +$("#form_journal_id").val()+"/"),"form_section_id")},$("#form_journal_id").on("change",function(){return updateSections()}),$("#si-update-emphasized").on("click",function(e){var t,n;return e.preventDefault(),t=$(this),n=t.data("uri"),$.post(n).done(function(e){var n,i;if("success"===e.status)return e.data?(n="color-orange",i="Highlighted"):(n="color-gray",i="Highlight"),t.removeClass("color-orange color-gray").addClass(n).prop("title",i)}).fail(function(){return $.alertError("Failed!")})})})}.call(this),function(){$(function(){var e,t,n;if(0!==$(".voucher").length)return e=$(".quickform"),t=e.offset(),n=$(".voucher").dialog({autoOpen:!1,modal:!1,width:320,height:320,buttons:{Confirm:function(){var e,t,n;return n={},t={},$(".enable-voucher").each(function(e,i){var r;if("0"!==$(i).val())return r=$(i).data("reviewer-id"),n[r]=$(i).val(),t[r]=$(i).data("pre-discount")}),(e=$(".ui-dialog-buttonpane button:first-child")).attr("disabled","disabled"),e.children("span").html("Confirming..."),$.post(SusyConfig.url.grant_voucher_to_reviewer,{vouchers:n,pre_discounts:t},function(e){return $(".ui-dialog-buttonpane").hide(),$(".enable-voucher").each(function(e,t){return $(t).hide().next("span").html($(t).val()+" CHF")})})},Close:function(){return n.dialog("close")}}}),n.init=function(){return n.dialog("open").parents("div.ui-dialog").css({top:t.top-10+"px",left:t.left+e.width()-320+"px",width:n.find("table").width()+32+"px"})},n.init(),SusyConfig.voucher_granted&&$(".ui-dialog-buttonpane").hide(),$("#show-grant-box").on("click",function(){return n.init()})})}.call(this),function(){$(function(){return $(".sortField").tablesorter()})}.call(this),function(){$(function(){return $("body").on("click","a.external_editor_invite",function(e){var t;return e.preventDefault(),t=$(this),$.post(t.data("external-editor-checking-url"),{email:$(this).data("editor-email")},function(e){return e?$("#checking_warning").show().html(e):window.location.href=t.data("invite-url")})}),$("body").on("click","#nextinvite",function(e){return e.preventDefault(),window.location.href=$("a.external_editor_invite").data("invite-url")})})}.call(this),function(){$(function(){return $("a.precheck-invite").length>=1&&$("a.precheck-invite").click(function(e){return e.preventDefault(),"no"===$(this).attr("has_pdf")?alert("Please upload the pdf version for pre-check, or refresh if it has already been uploaded"):$.post($(this).data("pre-check-checking-url"),{email:$(this).data("editor-email")},function(e){return e?$("#precheck_warming").show().html(e):window.location.href=$("a.precheck-invite").data("invite-url")})}),$("#precheck_warming").on("click","#next_invite",function(e){return e.preventDefault(),window.location.href=$("a.precheck-invite").data("invite-url")})})}.call(this),function(){$(function(){return $("body").on("click","#reviewersList #addByAcademicEditor",function(e){var t,n,i;return n=$(this).prev("form"),t=$(this),0===(t.data("oalit")?$('#reviewersList form input[name="form[reviewer_ids][]"]:checked'):$('#reviewersList form input[name="reviewer_ids[]"]:checked')).length?(alert("No reviewers are selected."),!1):(i=t.val(),t.val("Adding reviewers ...").attr("disabled",!0),$.post(t.data("url"),n.serialize(),function(e){var n;return t.val(i).removeAttr("disabled"),e.succ?(n=$("#form_recommend_reviewers").val(),n=n.concat(e.content.join("")),$("#form_recommend_reviewers").val(n),$("#search-and-add-reviewers").dialog("close")):alert("added reviewer failed: "+e)}))})})}.call(this),function(){$(function(){var e;if(0!==(e=$("form[data-check-reviewer-invitation-url]")).length)return $('form[data-check-reviewer-invitation-url] input[type="submit"]').on("click",function(t){var n;return t.preventDefault(),n=e.data("check-reviewer-invitation-url"),$.ajax({url:n,type:"post",data:e.serialize(),success:function(t){return 0,""!==t?(t,$("#author-revision-confirm").dialog({resizable:!1,height:200,width:450,modal:!0,buttons:{Close:function(){return $(this).dialog("close")}}})):e.submit()}})}),$("a.editExternalEditorDecision").length>=1&&($("#edit-external-editor-decision").on("click","a.closeDialog",function(e){return e.preventDefault(),$("#edit-external-editor-decision").dialog("close")}),$("a.editExternalEditorDecision").click(function(e){var t;return e.preventDefault(),(t=$("#edit-external-editor-decision")).dialog({modal:!0,autoOpen:!1,width:800,height:600,resizable:!0}),$.get($(this).data("editurl"),function(e){return t.html(e).dialog("open")})})),$("a.editExternalEditorDecisionNotesReply").length>=1&&($("#edit-external-editor-decision-notes-reply").on("click","a.closeDialog",function(e){return e.preventDefault(),$("#edit-external-editor-decision-notes-reply").dialog("close")}),$("a.editExternalEditorDecisionNotesReply").click(function(e){var t;return e.preventDefault(),(t=$("#edit-external-editor-decision-notes-reply")).dialog({modal:!0,autoOpen:!1,width:800,resizable:!0}),$.get($(this).data("editurl"),function(e){return t.html(e).dialog("open")})})),$("a.edit-email-to-authors").click(function(e){var t;return e.preventDefault(),(t=$("#edit-email-to-authors-dialog")).dialog({modal:!0,autoOpen:!1,width:800,height:600,resizable:!0}),$.get($(this).data("url"),function(e){return t.html(e).dialog("open")})})})}.call(this),function(){$(function(){var e,t,n,i,r;return $("#manuscriptDetails").find("#allow-external-editor").on("click",function(){var e,t,n,i,r,a;return r=$(this),t=r.parent().data("hash-key"),e=r.data("url"),i=r.data("lock-img-url"),a=r.data("unlock-img-url"),n=r.attr("src")===a?0:1,$.ajax({type:"POST",data:{is_allow:n,hash_key:t},url:e,success:function(){var e;return r.attr("src")===a?(r.attr("src",i),e="Eic can not see this manuscript"):(r.attr("src",a),e="Eic can see this manuscript"),r.tooltip({content:e})}})}),$("#manuscriptDetails").find("#allow-guest-editor").on("click",function(){var e,t,n,i,r,a;return r=$(this),t=r.parent().data("hash-key"),e=r.data("url"),i=r.data("lock-img-url"),a=r.data("unlock-img-url"),n=r.attr("src")===a?0:1,$.ajax({type:"POST",data:{is_allow:n,hash_key:t},url:e,success:function(){var e;return r.attr("src")===a?(r.attr("src",i),e="GEs can not see this manuscript"):(r.attr("src",a),e="GEs can see this manuscript"),r.tooltip({content:e})}})}),$("#manuscriptDetails").find("#allow-skip").on("click",function(){var e,t,n,i,r;return i=$(this),e=i.data("url"),n=i.data("lock-img-url"),r=i.data("unlock-img-url"),t=i.attr("src")===r?1:0,$.ajax({type:"POST",data:{is_skip:t},url:e,success:function(){var e;return i.attr("src")===r?(i.attr("src",n),e="Skip"):(i.attr("src",r),e="Not Skip"),i.tooltip({content:e})}})}),(t=$(".can_be_done_today")).length>0&&t.each(function(){var e,t;return e=$(this),t=e.data("url"),$.get(t,function(t){return"yes"===t?e.html("(Can be done today)"):"no"===t?e.html("(Can not be done today)"):e.html("")})}),i=$("#manuscript-author-blacklisted-dialog"),$("body").on("click",".manuscript-author-blacklisted",function(e){return e.preventDefault(),(i=i.dialog({modal:!0,autoOpen:!1,title:"Author was blacklisted",width:500,height:"auto",resizable:!0})).html($(this).data("notes")).dialog("open")}),i.data("auto-open")&&(e=[],$(".manuscript-author-blacklisted").each(function(){return e.push($(this).text())}),e.length>0&&(i=i.dialog({modal:!0,autoOpen:!1,title:"Author blacklisted",width:500,height:"auto",resizable:!0})).html(e.join(", ")).dialog("open")),(n=$("#confirm-info")).on("click",'input[type="submit"]',function(){var e,t,i,r,a,o;if(o=n.data("is-wm"),e=n.data("conversion-rejected"),r=n.data("has-supp"),i=n.data("has-ga"),a=!1,$('textarea[name^="form[affiliation_"]').each(function(){var e,t,n,i;if(t=$(this).prop("id").replace("_affiliation_","_country_"),e=$(this).val(),n=44==+$("#"+t).val(),i=/Hospital/i.test(e),n&&i)return a=!0}),a){if(!o)return alert("Chinese hospital, please check with Website Manager."),!1;if(!confirm("Chinese hospital, are you sure we can publish it?"))return!1}return t=e?"files":"PDF file",!!confirm("Are you sure that DOI and article number are added in "+t+"?")&&!((r||i)&&!confirm("Are you sure that GA/Supplementary are added?"))}),$("#manuscript-peer-review-confirm-btn").on("click",function(e){var t,n;return e.preventDefault(),(t=$(this)).prop("disabled",!0),n=t.data("confirm-url"),$.get(n,function(e){return $.confirm({icon:"fa fa-info",type:"blue",title:"Peer Review Confirm",content:e,useBootstrap:!1,boxWidth:"80%",buttons:{confirm:{btnClass:"btn-blue",action:function(){return $.post(n,function(e){return"success"===e.status?e.redirect_url?window.location.href=e.redirect_url:window.location.reload():alert(e.message)})}},cancel:function(){}}})}).always(function(){return t.prop("disabled",!1)})}),$("#show-hide-preprints-info").on("click",function(){var e;return e=$(this),e.siblings(".preprints-info").toggle({duration:400,complete:function(){return $(this).is(":visible")?e.html("<i>Less</i>..."):e.html("<i>More</i>...")}})}),$("#ms-additional-info").on("click",function(e){var t;return e.preventDefault(),t=$(this),$(".ms-additional-info").toggle(),$(".ms-additional-info").is(":visible")?t.html("Collapse [-]"):t.html("Display more [+]")}),(r=function(){var e,t,n,i,a,o,l;if(0!==(t=$("#basel-time")).length)return a=new Date,e=new Date(a.toLocaleString(void 0,{timeZone:"Europe/Zurich"})),n=e.getHours(),i=e.getMinutes(),o=e.getSeconds(),n=n<10?"0"+n:n,i=i<10?"0"+i:i,o=o<10?"0"+o:o,l="Now: "+n+":"+i+":"+o,t.html(l),setTimeout(r,1e3)})(),$(".link-pre-manuscript").on("click",function(e){return e.preventDefault(),$(this).hide().next(".add-pre-manuscript-section").show()}),$(".add-pre-manuscript-section").on("click",".cancel",function(e){var t;return e.preventDefault(),(t=$(this).parent()).find("input[data-auto-complete-url]").val(""),t.find(".add-pre-hash-key-value").val(""),t.hide(),t.prev(".link-pre-manuscript").show()}),$(".add-pre-manuscript-section").on("keyup","input[data-auto-complete-url]",function(){var e,t;return e=$(this),t=e.data("auto-complete-url"),e.autocomplete({source:t,select:function(t,n){return e.val(n.item.value),e.next(".add-pre-hash-key-value").val(n.item.hash_key)}})}),$(".add-pre-manuscript-section").on("click",".add-pre-manuscript-btn",function(e){var t,n,i,r;return e.preventDefault(),t=$(this),r=t.data("uri"),n=t.parent(),(i=n.find(".add-pre-hash-key-value").val())?$.post(r,{pre_hash_key:i},function(e){return"success"===e.status&&e.html?(n.after(e.html),n.prev(".link-pre-manuscript").remove(),n.remove()):$.alertError(e.message)}).fail(function(){return $.alertError("Failed!")}):($.alertError("Please enter a manuscript ID"),!1)})})}.call(this),function(){$(function(){if(0!==$(".show-more-content").length)return $(".show-more-content").on("click",function(e){var t;return(t=$(this)).hide(),t.siblings(".simple-content").hide(),t.siblings(".show-less-content").show(),t.siblings(".full-content").show()}),$(".show-less-content").on("click",function(e){var t;return(t=$(this)).hide(),t.siblings(".full-content").hide(),t.siblings(".show-more-content").show(),t.siblings(".simple-content").show()})})}.call(this),function(){$(function(){var e;if(0!==(e=$("form[data-check-is-public-url]")).length)return $("#form_submit").on("click",function(t){var n,i;return t.preventDefault(),n=e.data("check-is-public-url"),i=e.data("hash-key"),$.ajax({url:n,type:"POST",data:i,success:function(t){return""!==t?$("#wm-check-is-public-confirm").dialog({resizable:!1,height:200,width:450,modal:!0,buttons:{Close:function(){return $(this).dialog("close")}}}):e.submit()}})})})}.call(this),function(){$(function(){var e;if(0!==$("#susy_user_login").length)return e={success:"<p>Another e-mail has been sent out.</p>",error:"<p>Sorry, we can't resend the registration out.</p>"},$("#maincol").on("click","#resend-register-email",function(t){return t.preventDefault(),$.get($(this).data("url"),function(t){return $("#maincol").find("#resend-register-email-info").html(e[t]).addClass(t).show()}).fail(function(){return $("#maincol").find("#resend-register-email-info").html(e.error).addClass("error").show()}).always(function(){return setTimeout(function(){return $("#maincol").find("#resend-register-email-info").hide("slow")},5e3)})})})}.call(this),function(){$(function(){var hasDepartments,hasSecureCode,journalApc,membershipInstituteId,preSelectedMembershipInstitute,preSelectedMembershipSecureCode,selectedMembershipId,uploadDiv;if(uploadDiv=$("#apc"),journalApc=uploadDiv.data("journal-apc"),!(0===uploadDiv.length||journalApc<=0)&&(preSelectedMembershipInstitute=uploadDiv.data("pre-selected-membership-institute"),preSelectedMembershipSecureCode=uploadDiv.data("pre-selected-membership-secure-code"),hasDepartments=uploadDiv.data("has-departments"),preSelectedMembershipInstitute&&!preSelectedMembershipSecureCode))return membershipInstituteId=$("#selectMembershipInstitute").val(),selectedMembershipId=uploadDiv.data("membership-id"),hasSecureCode=0,preSelectedMembershipInstitute&&!selectedMembershipId?1===hasDepartments?$("#selectMembershipInstitute").trigger("change"):($('input[name="re-select-membership"]').on("change",function(e){var t,n;return membershipInstituteId=$(this).val(),n=$(this).siblings("label").data("membership-name"),t=$(this).siblings("label").data("membership-discount"),hasDepartments=+$(this).siblings("label").data("has-departments"),hasSecureCode=+$(this).siblings("label").data("has-secure-code"),$("#selectMembershipInstitute").val($(this).val()),$("#selectMembershipInstitute").trigger("change"),$("#selectMembershipInstitute").trigger("chosen:updated"),$("#last-display").find("span[data-membership-name]").html(n),$("#last-display").find("span[data-membership-discount]").html(t+"% discount")}),$("#author-membership-confirm").dialog({modal:!0,autoOpen:!0,width:600,height:400,resizable:!0,buttons:{Confirm:function(){var hash_key;if($(this).dialog("close"),1!==hasDepartments&&1!==hasSecureCode)return hash_key=$(".hash_key").val(),$(".show-flag").hide(),$(".add-institute").hide(),$("#message").hide(),$.ajax({type:"POST",data:{institute_id:membershipInstituteId},success:function(msg){return 1===(msg=eval("("+msg+")")).is_eligible?("non-uk-institute"===msg.college_block&&$("#"+msg.college_block).html(msg.college_page),$("#"+msg.college_block).slideDown(1e3),$("#submitEligible").attr("elementOpen",msg.college_block),$("#submitEligible").show()):$.ajax({type:"POST",data:{hash_key:$(".hash_key").val(),institute_id:membershipInstituteId,is_eligible:0},success:function(){return window.location.reload(!0)},url:SusyConfig.url.submit_membership_eligible})},url:SusyConfig.url.check_membership_eligible})},Cancel:function(){return $(this).dialog("close"),$("#selectMembershipInstitute").val(null),$("#selectMembershipInstitute").trigger("change"),$("#selectMembershipInstitute").trigger("chosen:updated")}}}),$(".ui-dialog-titlebar-close").hide()):($(".show-flag").hide(),$(".add-institute").hide(),$("#message").hide(),$("#last-display").show())})}.call(this),function(){$(function(){var e;if(0!==$("#recommend-title-story").length)return e=$("#recommend-title-story-browser").dialog({modal:!0,autoOpen:!1,width:700,height:"auto",resizable:!0,buttons:{Confirm:function(){var e,t;return e=$(this),t=$("#recommend-title-story").data("url"),$.post(t,e.find("form").serialize(),function(t){return"success"===t.status?(e.dialog("close"),alert(t.message),window.location.reload()):alert(t.message)})},Close:function(){return $(this).dialog("close")}}}),$("#recommend-title-story").on("click",function(t){return t.preventDefault(),e.dialog("open")})})}.call(this),function(){$(function(){var e,t;if(0!==$(".show_ip_info").length)return 0===$("#ip_location_info").length&&(t=$('<div id="ip_location_info" title="IP Info" style="display: none;"></div>'),$("body").append(t)),e=$("#ip_location_info").dialog({autoOpen:!1,width:600,height:"auto",resizable:!0}),$(".show_ip_info").on("click",function(){var t,n;return t=$(this),n=SusyConfig.url.get_ip_info_url,$.getJSON(n,{ip:t.data("ip-location")},function(t){var n;return n='<table style="padding: 10px 10px 10px 60px;">',$.each(t,function(e,t){return n+='<tr><td style="text-align: right;">'+e.replace(/(\w)/,function(e){return e.toUpperCase()})+":</td><td><b>"+t+"</b></td></tr>"}),n+="</table>",e.html(n).dialog("open")})})})}.call(this),function(){$(function(){if(0!==$(".review_due_date_input").length)return $(".review_due_date_input").prev("strong").on("click",function(){var e,t;return(t=$(this)).hide(),(e=t.next(".review_due_date_input")).show(),e.datepicker({dateFormat:"d MM yy",minDate:0,onSelect:function(){var n,i;return n=e.val(),i=e.data("uri"),$.post(i,{due_date:n},function(i){return i?(e.hide(),t.html(n),t.show()):alert("Failed")})}})})})}.call(this),function(){$(function(){if(0!==$(".author-remove-file").length)return $(".author-remove-file").on("click",function(e){var t,n;return e.preventDefault(),t=$(this),n=t.data("remove-url"),$.post(n,{},function(e){return"success"===e.status?window.location.reload():alert("error")})})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f,p,m;if(0!==(u=$("#submission-stage-apc")).length)return"0"===$("#discount-reason").val()?($("#invoice-discount-row").hide(),$("#invoice-waiver-row").hide(),$("#discount-comment-row").hide()):($("#discount-comment-row").show(),"7"===$("#discount-reason").val()?($("#discount-comment-row").show(),$("#discount-comment").prop("required",!0)):($("#discount-comment-row").hide(),$("#discount-comment").prop("required",!1)),$("#invoice-waiver-row").show()),d=$("#submission-stage-apc-information"),l=d.data("journal-apc"),s=d.data("basefees"),r=d.data("membership-discount"),a=d.data("membership-id"),o=d.data("editor-email-send"),h=s,f=function(){return $("#selectMembershipInstituteShare").data("is-all-discounts-allowed")||1===$("#selectMembershipInstituteShare option:selected").data("is-other-discount-allowed")?($("#author-voucher-prepare").prop("disabled",!1).parents(".voucher_prepare").show(),$("#discount-reason").prop("disabled",!1)):($("#author-voucher-prepare").prop("disabled",!0).parents(".voucher_prepare").hide(),$("#discount-reason").val("0").trigger("change").prop("disabled",!0),$("#invoice-discount").val("0"),$("#invoice-fees-waiver").val("0.00").trigger("change"))},p=function(){var e,t,n,i,a,o,s,c;if(e=d.data("basefees"),t=$("#invoice-discount").val(),s=$("#invoice-fees-waiver").val(),e-=l*(t/100),e-=s,o=$("#selectMembershipInstituteShare"),a=$("#selectMembershipInstituteShare option:selected"),null==(i=a.data("discount"))&&(i=0),i?e=e-l*i/100+l*r/100:e+=l*r/100,e<0&&alert('Invalid amount. Please click "Set as free" and go ahead.'),o.data("is-all-discounts-allowed")||($("#discount-reason").val()>0||$("#author_voucher_container").find('input[name="author_vouchers[]"]').length>0?(o.find("option[data-is-other-discount-allowed=0]").prop("disabled",!0),o.trigger("chosen:updated")):(o.find("option").prop("disabled",!1),o.trigger("chosen:updated"))),h=e,"0"===t&&"0"===s&&h<0&&(h="0 ("+h+")"),"0"!==t||"0"!==s)return n=l*($("#invoice-discount").val()/100),c=$("#invoice-fees-waiver").val(),$("#submission-stage-apc-basefees").find(".fees-val").text(e),$("#submission-stage-apc-discount").find(".fees-val").text(n),$("#submission-stage-apc-waiver").find(".fees-val").text(c),n>0?$("#submission-stage-apc-discount").show():$("#submission-stage-apc-discount").hide(),c>0?$("#submission-stage-apc-waiver").show():$("#submission-stage-apc-waiver").hide()},c=function(){var e,t,n,i,r,a,o,l,s,c;return l=0,o=0,n=+$("#selectMembershipInstituteShare option:selected").data("discount")||0,o+=n,a="Discount Voucher(s): \n",$(".author-vouchers").each(function(e,t){var n,i,r;return r=e+1,"%"===document.getElementById("author-voucher-type"+r).innerHTML?(n=parseFloat($(t).val()),a+=n+"% \n",o+=n):(i=parseFloat($(t).data("value")),a+=i+"CHF \n",l+=i)}),e=d.data("journal-apc"),s=e,"0"===(r=$("#discount-reason")).val()&&s<s*(o/100)+l&&(r.find('option[value="7"]').prop("selected",!0),r.trigger("change"),i="APC: "+e+"CHF \n",$("#discount-comment").val(i+a)),"0"===r.val()?(alert("Please select a discount reason."),!1):(0===l?(t=100-o,$("#invoice-discount").val(t)):(s-=s*(o/100),c=s-=l,$("#invoice-fees-waiver").val(c)),p())},f(),p(),$("#selectMembershipInstituteShare").on("change",function(){return f(),p()}),$("#discount-reason").on("change",function(){return"0"===$("#discount-reason").val()?($("#invoice-discount-row").hide(),$("#invoice-discount").val(0),$("#invoice-fees-waiver").val("0"),p(),$("#invoice-waiver-row").hide(),$("#discount-comment").val(""),$("#discount-comment-row").hide(),$("#discount-comment").prop("required",!1)):("7"===$("#discount-reason").val()?($("#discount-comment-row").show(),$("#discount-comment").prop("required",!0)):($("#discount-comment-row").hide(),$("#discount-comment").prop("required",!1)),$("#invoice-discount-row").show(),$("#invoice-waiver-row").show()),p()}),$("#invoice-fees-waiver").on("change",function(){return+$(this).val()>s&&(alert("Invalid waiver"),$(this).val("0")),p()}),$("#invoice-discount").on("change",function(){return+$(this).val()>100-d.data("membership-discount")&&(alert("Invalid discount"),$(this).val(0)),p()}),$("#set-invoice-free-btn").on("click",function(){return c()}),t=function(){return $.confirm({icon:"fa fa-money",type:"blue",title:"Manuscript APC",content:"<p>Please confirm that the total of "+h+" CHF is correct.</p>",buttons:{confirm:{btnClass:"btn-blue",action:function(){return $.ajax({type:"post",url:u.data("url"),data:u.serialize(),success:function(e){if(e&&($("#other-manual-discount").hide(),$("#later-author-discount").hide(),$("#submission-stage-apc-discount").show(),$("#submission-stage-apc-waiver").show(),e.redirect_url))return window.location.href=e.redirect_url}})}},cancel:function(){}}})},i=function(){var e;return o?+$("#selectMembershipInstituteShare").val()!==a?$.confirm({icon:"fa fa-institution",type:"orange",title:"IOAP Caution",boxWidth:"100%",useBootstrap:!1,content:"The IOAP participant has been changed. A notification email will be sent to IOAP library immediately. Please confirm.",buttons:{confirm:{btnClass:"btn-blue",action:function(){return t()}},cancel:function(){}}}):t():(e=$("#selectMembershipInstituteShare option:selected").data("ioap-name"))?$.confirm({icon:"fa fa-institution",type:"orange",title:"IOAP Caution",boxWidth:"100%",useBootstrap:!1,content:"Please confirm the IOAP participant is "+e+". A notification email will be sent to IOAP library immediately after your confirmation.",buttons:{confirm:{btnClass:"btn-blue",action:function(){return t()}},cancel:function(){}}}):t()},n=$("#submission-stage-apc-confirm-diag").dialog({modal:!0,width:400,height:200,autoOpen:!1,resizable:!1,title:"Manuscript APC",buttons:{Confirm:function(){return $.ajax({type:"post",url:u.data("url"),data:u.serialize(),success:function(e){if($(".ui-dialog-buttonpane button:contains('Confirm')").button("disable"),$(".ui-dialog-buttonpane button:contains('Cancel')").button("disable"),e&&(n.dialog("close"),$("#other-manual-discount").hide(),$("#later-author-discount").hide(),$("#submission-stage-apc-discount").show(),$("#submission-stage-apc-waiver").show(),e.redirect_url))return window.location.href=e.redirect_url}})},Cancel:function(){return $(this).dialog("close")}}}),u.find("input[type=submit]").on("click",function(e){var t;return""===$("#discount-comment").val()&&"7"===$("#discount-reason").val()&&($("#invoice-discount").val()>0||parseFloat($("#invoice-fees-waiver").val())!==parseFloat("0"))?($("#invoice-discount-row").show(),$("#invoice-waiver-row").show(),$("#discount-comment-row").show(),e.preventDefault(),alert("Please fill out the discount / waiver explanation"),!1):(e.preventDefault(),p(),$(this).data("save")?((t=$(this)).prop("disabled",!0),t.after(SusyConfig.image.loading),$.ajax({type:"post",url:u.data("url"),data:u.serialize(),success:function(){return window.location.reload(!0)},error:function(){return $.alert("Error!"),t.data("disabled",!1),t.next("img").remove()}}),!0):i())}),e=$("#author-voucher-prepare"),m=$("#warning_prepare"),$("#author_voucher_container").on("click",".rm-author-voucher",function(){var e,t;if(t="Are you sure remove "+$(this).parent().prev().text()+" ?",confirm(t))return e=$(this),$.get($(this).data("path"),function(t){if("1"===t)return e.parents(".row").fadeOut(800,function(){return $(this).remove()}),window.location.reload()})}),$("#author-voucher-prepare").val(""),$("#add-new-author-voucher").on("click",function(){var t,n;if(!(t=$(this)).data("disabled")){if(n=$(".author-vouchers").length,""!==$.trim(e.val()))return t.data("disabled",!0),t.after(SusyConfig.image.loading),$.get($(this).data("path"),{voucher_length:n,code:$.trim(e.val()),invoice_id:$(this).data("invoice-id")},function(e){if("failed"!==e.status)return $("#author_voucher_container").append(e),m.hide(),$("#author-voucher-prepare").val(""),window.location.reload();m.html(e.message).css("color","red").fadeOut(100).fadeIn(100)}).always(function(){return t.data("disabled",!1),t.next("img").remove()});m.html("Please enter voucher code.").css("color","red").fadeOut(100).fadeIn(100)}}),$("#pre-check-add-info").on("click",function(e){var t;return e.preventDefault(),t=$(this),$(".pre-check-add-info").toggle(),$(".pre-check-add-info").is(":visible")?t.html("Collapse [-]"):t.html("Display more [+]")}),$("#apc-pending-decision-manuscripts").on("click",function(e){return e.preventDefault(),$(".apc-pending-decision-manuscripts-dialog").dialog({modal:!0,autoOpen:!1,title:"Pending Decision Manuscripts",width:400,height:300,resizable:!0}),$(".apc-pending-decision-manuscripts-dialog").html("loading..."),$.get($(this).data("get-url"),function(e){return $(".apc-pending-decision-manuscripts-dialog").html(e).dialog("open")})}),$("#apc-pending-pre-decision-manuscripts").on("click",function(e){return e.preventDefault(),$(".apc-pending-pre-check-decision-manuscripts-dialog").dialog({modal:!0,autoOpen:!1,title:"Pending Pre-check Decision Manuscripts",width:400,height:300,resizable:!0}).dialog("open")})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f,p,m,v,g,b,_,w,y,k,x,C,D,S;if(0!==$("#english-invoice-form-fields").length)return f=$("#english-invoice-form"),h=+f.data("english-id"),d=+f.data("editing-type"),p=+f.data("english-level"),S=+f.data("with-manuscript"),f.data("name"),f.data("invoice-email"),f.data("order-email"),f.data("discount"),f.data("membership-discount"),f.data("membership-id"),f.data("address1"),f.data("address2"),f.data("city"),f.data("zipcode"),f.data("country"),g=f.data("payment-currency"),v=f.data("exchange-rate"),t=f.data("apc-exchange-rates"),u=+f.data("china-id"),y=+f.data("switzerland-id"),D=f.data("vat-countries"),x=0,k=0,$(document).on("ready",function(){return m(),r(),i(),c()}),$("#english-invoice-num-words").on("change",function(){return l()}),$("#english-invoice-membership-institute").on("change",function(){return o()}),$("#english-invoice-payment-currency").on("change",function(){return a()}),$("#english-invoice-country").on("change",function(){return r()}),$("#english-invoice-membership-discount").on("change",function(){return i()}),$("#english-invoice-discount").on("change",function(){return i()}),$("#english-invoice-fees-waiver").on("change",function(){return i()}),$("#add-english-invoice-voucher").on("click",function(){return e()}),$("#english-invoice-voucher-container").on("click",".rm-english-voucher",function(){return b($(this))}),$("#english-invoice-disable-vat").on("click",function(){return s()}),$("#english-invoice-modify-link").on("click",function(e){return e.preventDefault(),$(this).parents("fieldset").hide().prev("fieldset").show()}),$("#english-invoice-display-date").datepicker({dateFormat:"yy-mm-dd",showAnim:"fadeIn",changeMonth:!0,changeYear:!0}),f.on("submit",function(e){if(e.preventDefault(),f[0].checkValidity())return $("#save-english-invoice").append(SusyConfig.image.loading),$("#save-english-invoice .submit").prop("disabled",!0),$.post(f.attr("action"),f.serialize(),function(e){var t,n,i,r,a;return $("#save-english-invoice img").remove(),$("#save-english-invoice .submit").prop("disabled",!1),a=f.data("status"),i=f.data("open-url"),t=f.data("billing-confirmed"),r=f.data("send-invoice-url"),n=$("#english-invoice-payment-currency").val(),"CNY"!==g&&"CNY"!==n||g===n?"pending"!==a||t?"open"===a||"paid"===a?(window.location=i,!0):($("#english-invoice-form-fields").hide().next("fieldset").show(),_()):(window.location=r,!0):(window.location=i,!0)})}),_=function(){return $("html, body").animate({scrollTop:$("legend:nth(1)").offset().top},500)},o=function(){var e,t;return t=$("#english-invoice-membership-institute"),t.val()?(e=$("#english-invoice-membership-institute option:selected").data("discount"),$("#english-invoice-membership-discount").val(e)):$("#english-invoice-membership-discount").val(0),i()},c=function(){var e,t,n;if(!(t=$("#english-invoice-membership-institute")).is(":disabled"))return n=t.val(),(e=f.data("author-with-memberships"))&&!n&&alert('The author is from the "'+e+'" institution(s) but the membership was not selected. Please check.'),!f.data("is-author-with-membership")&&n?alert("The author email domain is not compatible with the selected IOAP participant. Please check."):void 0},a=function(){var e,n,i,r,a,o,l,c;return c=$("#english-invoice-payment-currency"),e=c.val(),$(".english-invoice-currency").html(e),i=$("#english-invoice-exchange-rate"),a=$("#english-invoice-fees-waiver"),o=i.val(),n=t[e],e===g&&(n=v),i.val(n),l=parseFloat(a.val()),r=(l*n/o).toFixed(2),a.val(r),s(),C()},r=function(){var e,t,n,i,r,o,l;for(o=$("#english-invoice-country").val(),l=$("#english-invoice-payment-currency").val(),e=["CHF","USD","EUR","GBP"],n="",44===Number(o)&&"CNY"===g?(e.unshift("CNY"),$("input:radio[name='payment_method']:eq(0)").attr("checked",!0),$("input:radio[name='payment_method']:gt(0)").parent().hide()):$("input:radio[name='payment_method']:gt(0)").parent().show(),i=0,r=e.length;i<r;i++)n+=l===(t=e[i])?'<option value="'+t+'" selected>'+t+"</option>":'<option value="'+t+'">'+t+"</option>";return $("#english-invoice-payment-currency").html(n),a()},s=function(){var e,t,n,r;return n=$("#english-invoice-country").val(),e=$("#english-invoice-payment-currency").val(),t=$("#english-invoice-disable-vat"),D[n]?$("#disable_vat_block").show():($("#disable_vat_block").hide(),t.prop("checked",!1)),r=t&&t.is(":checked")?0:Number(n)===u&&"CNY"!==e?0:Number(n)===y&&"CHF"!==e?0:D[n]?$.number(D[n],1,".",""):0,$("#english-invoice-vat").val(r),i()},l=function(){var e,t,r;return r=$("#english-invoice-num-words"),t=r.val(),e=n(t),$("#english-invoice-original-fees-apc").val(e),i()},m=function(){var e,t,n,i,r,a,o,l,s;return a=parseFloat($("#english-invoice-original-fees-apc").val()),l=parseFloat($("#english-invoice-original-fees-plagiarism-check").val()),o=parseFloat($("#english-invoice-original-fees-layout").val()),s=parseFloat($("#english-invoice-original-fees-waiver").val()),e=parseFloat($("#english-invoice-exchange-rate").val()),t=(a*e).toFixed(2),i=(l*e).toFixed(2),n=(o*e).toFixed(2),r=(s*e).toFixed(2),$("#english-invoice-fees-apc").val(t),$("#english-invoice-fees-plagiarism-check").val(i),$("#english-invoice-fees-layout").val(n),$("#english-invoice-fees-waiver").val(r)},n=function(e){var t,n,i,r;return h<=2142?(i=0,r=.06,n=.04,e<0?i.toFixed(2):(1===S&&(r=.05,n=.03),i=e<=5e3?(e*r).toFixed(2):(5e3*r+(e-5e3)*n).toFixed(2))):(i=0,t=105,r=.02,2===p?(t=175,r=.025):3===p&&(t=180,r=.04),e<=0||2===d||0===d?i.toFixed(2):i=(t+e*r).toFixed(2))},e=function(){var e,t,n,i;return t=$("#add-english-invoice-voucher").data("url"),e=$("#add-english-invoice-voucher").data("add-voucher-url"),n=$("#english-invoice-voucher-prepare").val().trim(),i=$("#warning-message"),$.get(t,{voucher_code:n},function(t){return"success"===t.status?(i.html("").fadeOut(100),$("#english-invoice-voucher-prepare-row").hide(),$.post(e,{voucher_code:n},function(e){return $("#english-invoice-voucher-container").html(e),C()})):i.html(t.message).css("color","red").fadeOut(100).fadeIn(100),C()})},b=function(e){var t,n;if(t="Are you sure remove discount voucher: "+e.siblings(".english-voucher-code").val()+" ?",confirm(t))return n=e.data("path"),$.post(n,function(e){return $("#english-invoice-voucher-container").html(e),C()})},C=function(){var e;return x=0,k=0,e=parseFloat($("#english-invoice-exchange-rate").val()),w(),$("#english-invoice-voucher-container").find(".english-discount-vouchers").each(function(){var t,n,i;return t=$(this).find(".english-voucher-discount"),$(this).find(".english-voucher-type").html().indexOf("%")>=0?x+=Number(t.data("value")):(n=Number(t.data("value")),k+=n,i=n*e,t.val(i.toFixed(2)))}),i()},w=function(){return 0===$("#english-invoice-voucher-container").find(".english-discount-vouchers").length?$("#english-invoice-voucher-prepare-row").show():$("#english-invoice-voucher-prepare-row").hide()},i=function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f;return e=$("#english-invoice-payment-currency").val(),r=parseFloat($("#english-invoice-original-fees-apc").val()),o=parseFloat($("#english-invoice-original-fees-plagiarism-check").val()),a=parseFloat($("#english-invoice-original-fees-layout").val()),l=parseFloat($("#english-invoice-fees-waiver").val()),f=parseFloat($("#english-invoice-vat").val()),s=parseFloat($("#english-invoice-membership-discount").val()),t=parseFloat($("#english-invoice-discount").val()),n=parseFloat($("#english-invoice-exchange-rate").val()),d=s+t,h=l+k*n,r*=n,o*=n,a*=n,i=r+o+a,r=r.toFixed(2),o=o.toFixed(2),a=a.toFixed(2),d>100?(u=0,c=0):(u=i-i*(d/100),(u-=h)<0&&(u=0),c=u*(1+f/100),u=u.toFixed(2),"CNY"===e&&(c=Math.round(c)),c=c.toFixed(2)),$("#english-invoice-fees-apc").val(r),$("#english-invoice-fees-plagiarism-check").val(o),$("#english-invoice-fees-layout").val(a),$("#english-invoice-total-without-vat").val(u),$("#english-invoice-total").val(c)}})}.call(this),function(){$(function(){var e;if(0!==$("#ms-send-final-dlg").length)return e=$("#ms-send-final-dlg").dialog({modal:!0,autoOpen:!1,width:800,height:"auto",resizable:!0}),$("#ms-send-final").on("click",function(t){return t.preventDefault(),$.get($(this).data("url"),function(t){return e.html(t).dialog("open")})})})}.call(this),function(){$(function(){var e,t,n,i;if(0!==$("#website-editor-notes").length)return t=$("#website-editor-notes"),(e=t.data("url"))&&t.load(e),i=function(e){var n,i;return e.dialog("open"),n=$("#container"),i=n.offset(),t.parents("div.ui-dialog").css({top:i.top+10+"px",left:i.left+n.width()-350+"px"})},n=t.dialog({autoOpen:!1,width:400,height:300,resizable:!0}),i(n)})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s;if($("#wechat-user-info").length>0&&((r=function(){return $("#form_wechat_subscribe_all_journals_1").is(":checked")?$("#wechat-subscribed-journals-section").show():$("#wechat-subscribed-journals-section").hide()})(),$('input[name="form[wechat_subscribe_all_journals]"]').on("change",r),l=$("#wechat-user-info"),s=$("#wechat-user-name"),e=l.data("wechat-user-info-url"),$.getJSON(e,{},function(e){var t;return t="",e&&e.headimgurl&&(t+='<img src="'+e.headimgurl+'" style="height: 60px; vertical-align: top;" alt="">'),e&&e.nickname&&(t+=e.nickname),s.html(t)}),(o=$("#wechat-unbind-btn")).on("click",function(e){var t,n;return e.preventDefault(),n=o.data("url"),(t=$("#wechat-unbind-dialog").dialog({modal:!0,autoOpen:!1,width:500,height:"auto",resizable:!0,buttons:{Confirm:function(){return $.post(n,{},function(){return window.location.reload()}),t.dialog("close")},Cancel:function(){return t.dialog("close")}}})).dialog("open")})),0!==$("#wechat_account_scan_qrcode").length)return a=$("#wechat_account_scan_qrcode"),n=a.data("large-image"),i=$("#wechat_account_scan_qrcode_dialog").dialog({title:"Scan QR code to follow the WeChat account",modal:!0,autoOpen:!1,width:600,minHeight:600,height:"auto",resizable:!0}),t='<img width="560" src="'+n+'" alt="Wechat qrcode">',a.on("click",function(e){return i.html(t).dialog("open")})})}.call(this),function(){$(function(){if(0!==$(".assign-si-to-new-me").length)return $(".assign-si-to-new-me").click(function(e){var t;return e.preventDefault(),(t=$("#select-managing-editors")).dialog({modal:!0,autoOpen:!1,width:700,height:500,resizable:!0}),$.get($(this).data("url"),function(e){return t.html(e),t.dialog("open")})})})}.call(this),function(){$(function(){var e,t;return e=$("#edit-authors-profile-dlg").dialog({modal:!0,autoOpen:!1,width:800,height:"auto",resizable:!0}),$("#edit-authors-profile-btn").on("click",function(t){return t.preventDefault(),e.dialog("open")}),(t=$("#edit-authors-profile-form")).find('input[type="submit"]').on("click",function(n){var i;return n.preventDefault(),i=t.attr("action"),$.post(i,t.serialize(),function(n){return"success"===n.status?(t.find(".error-message").removeClass("color-red").addClass("color-green").html(n.message).fadeIn().delay(1500).fadeOut(),setTimeout(function(){return e.dialog("close")},2e3)):t.find(".error-message").removeClass("color-green").addClass("color-red").html(n.message).fadeIn()})})})}.call(this),function(){$(function(){var e;return e=$("#change-pre-decision-comments-dlg").dialog({modal:!0,autoOpen:!1,width:800,height:"auto",resizable:!0}),$("#change-comments").on("click",function(t){return t.preventDefault(),$("#change-pre-decision-comments-dlg").empty().load($(this).data("editurl")),e.dialog("open")}),$("#change-pre-decision-comments-dlg").on("click",'input[type="submit"]',function(t){var n,i,r,a,o;return t.preventDefault(),window.confirm("Are you sure to update the decision?"),n=$("#change-comments-form"),o=n.attr("action"),i=$.trim(n.find("#form_comments").val()),r=$.trim(n.find("#form_comments_for_author").val()),a=n.find("input:checked").val(),$.post(o,{id:n.data("comments-id"),comments:i,comments_for_author:r,decision:a},function(t){if("1"===t)return e.dialog("close"),window.location.reload(!0)})})})}.call(this),function(){$(function(){var e,t,n;return t=$("#pre-english-upload-file-dlg").dialog({modal:!0,autoOpen:!1,width:800,height:"auto",resizable:!0}),n=$("#pre-layout-upload-file-dlg").dialog({modal:!0,autoOpen:!1,width:800,height:"auto",resizable:!0}),$("#pre-english-upload-file-btn").on("click",function(e){var n;return e.preventDefault(),n=$(this).data("url"),$.get(n,function(e){return t.html(e).dialog("open")})}),$("#pre-layout-upload-file-btn").on("click",function(e){var t;return e.preventDefault(),t=$(this).data("url"),$.get(t,function(e){return n.html(e).dialog("open")})}),(e=$("#english-editing-upload-form .error:visible").first())&&e.length>0&&$("html, body").animate({scrollTop:e.offset().top},500),$("#english-editing-submit-btn").on("click",function(e){var t;return e.preventDefault(),t=$(this).parents("form"),$.confirm({icon:"fa fa-info",type:"blue",useBootstrap:!1,boxWidth:"100%",title:"Confirm Upload Files",content:"PLEASE DOUBLE CHECK THIS IS THE CORRECT FILE, i.e., the title and the manuscript ID are correct.",buttons:{confirm:{btnClass:"btn-blue",action:function(){return t.submit()}},cancel:function(){}}})})})}.call(this),function(){$(function(){var e,t;return t=$("#add_blacklisted_conference_dialog"),e=t.dialog({modal:!0,autoOpen:!1,width:550,height:200,resizable:!0,buttons:{Confirm:function(){return $.ajax({type:"post",data:t.children().serialize(),url:t.data("link"),success:function(){return window.location.reload()}})},Cancel:function(){return $(this).dialog("close")}}}),$("#add_blacklisted_conference").on("click",function(){return $("input[name='conference_name']").val(""),$("input[name='conference_link']").val(""),e.dialog("open")}),$(".delete_blacklisted_conference").on("click",function(e){var t,n,i;return e.preventDefault(),t=$(this),i=$("#delete_blacklisted_conference_dialog").dialog({modal:!0,autoOpen:!1,width:800,height:250,resizable:!0,buttons:{Delete:function(){return $.ajax({type:"post",data:"ids="+t.data("id"),url:$("#delete_blacklisted_conference_dialog").data("link"),success:function(){return window.location.reload()}})},Cancel:function(){return $(this).dialog("close")}}}),n="<strong>Conference Name: </strong>"+$(this).data("name")+"<br><br><strong>Conference Link: </strong>"+$(this).data("link"),i.html(n).dialog("open")}),$(".edit_blacklisted_conference").on("click",function(e){var t;return e.preventDefault(),t=$(this),$("input[name='id']").val(t.data("id")),$("input[name='conference_name']").val(t.data("name")),$("input[name='conference_link']").val(t.data("link")),$("#edit_blacklisted_conference_dialog").dialog({modal:!0,autoOpen:!1,width:550,height:200,resizable:!0,buttons:{Confirm:function(){return $.ajax({type:"post",data:$("#edit_blacklisted_conference_dialog").children().serialize(),url:$("#edit_blacklisted_conference_dialog").data("link"),success:function(){return window.location.reload()}})},Cancel:function(){return $(this).dialog("close")}}}).dialog("open")})})}.call(this),function(){var e;(e=jQuery).fn.extend({mdpiSticky:function(){var t,n,i;if(0!==this.length)return t=this,n=t.offset().top,i=t.outerWidth(),e(window).scroll(function(){return e(window).scrollTop()>n?t.addClass("fixed_sticky").css("width",i):t.removeClass("fixed_sticky").css("width","auto")})}})}.call(this),function(){$(function(){return $("body").on("click",".see_editor_history",function(e){var t;return e.preventDefault(),(t=$("#decision_history_info")).dialog({modal:!0,autoOpen:!1,width:800,height:600,resizable:!0}),t.html("loading..."),$.get($(this).data("get-url"),function(e){return t.html(e).dialog("open")})}),$("#decision_history_info").on("click",".load-more-history",function(e){var t,n;return e.preventDefault(),n=$(this).data("load-more-url"),t=$(this),$.get(n,function(e){return t.parents("tr").after(e),t.parents("tr").remove()})})})}.call(this),function(){$(function(){var e;if(0!==$("#upload-ms-files-dialog").length)return e=$("#upload-ms-files-dialog").dialog({modal:!0,autoOpen:!1,width:800,height:"auto",resizable:!0}),$(".upload-ms-files-btn").on("click",function(t){var n,i;return t.preventDefault(),n=$(this).data("title"),i=$(this).data("url"),e.html(""),$.get(i,function(t){return e.dialog({title:n}).html(t).dialog("open")})}),$("#upload-ms-files-dialog").on("click",'input[type="submit"]',function(t){var n,i,r;return t.preventDefault(),i=$(this),n=i.parents("form.ajax-form"),r=n.prop("action"),i.after(SusyConfig.image.loading),i.prop("disabled",!0),$.ajax({url:r,type:"POST",cache:!1,data:new FormData(n[0]),processData:!1,contentType:!1}).done(function(t){return i.next("img").remove(),i.prop("disabled",!1),t.redirect_url?(e.dialog("close"),window.location.href=t.redirect_url):"success"===t.status?window.location.reload():$("#upload-ms-files-dialog").html(t)})})})}.call(this),function(){$(function(){var e;if(0!==(e=$(".edit-sci-affiliation")).length)return e.on("click",function(e){var t,n;return e.preventDefault(),(n=$(this)).parent().hide(),(t=n.parent().next(".update_sci_reviewer_affiliation")).show(),t.children("img").on("click",function(){return $.post(t.children("input").data("uri"),{new_aff:t.children("input").val()},function(e){return e?window.location.reload():alert("Please add affiliation!")})})})})}.call(this),function(){$(function(){var e;if(0!==$(".publish-sci-papers").length)return e=$("#pop-publish-sci-papers").dialog({modal:!0,autoOpen:!1,width:600,height:"auto",resizable:!0}),$(".publish-sci-papers").on("click",function(t){var n,i,r;return t.preventDefault(),r=$(this).data("version"),n="Publish Version "+r,i=$(this).data("url"),e.html(""),$.get(i,function(t){return e.dialog({title:n}).html(t).dialog("open"),$(".versionInfo").append("<span>.v"+r+"</span>")})}),e.on("click",'input[type="submit"]',function(t){var n,i,r;return t.preventDefault(),i=$(this),n=i.parents("form.ajax-form"),r=n.prop("action"),i.after(SusyConfig.image.loading),i.prop("disabled",!0),$.ajax({url:r,type:"POST",cache:!1,data:new FormData(n[0]),processData:!1,contentType:!1}).done(function(t){return i.next("img").remove(),i.prop("disabled",!1),"success"===t?(e.dialog("close"),window.location.reload()):e.html("failed")})})})}.call(this),function(){$(".display-decision-history").on("click",function(e){var t;return e.preventDefault(),t=$(this),$(".decision-history").toggle(),$(".decision-history").is(":visible")?t.html("Collapse [-]"):t.html("Display decision history [+]")})}.call(this),function(){$(function(){var e,t,n,i;if(0!==$("#ajax-submit-form-dialog").length)return e=$("#ajax-submit-form-dialog"),n=e.dialog({modal:!0,autoOpen:!1,width:800,height:"auto",resizable:!0}),i=function(){return $.ui.dialog.prototype._focusTabbable=function(){return!1}},t=function(e,t){return null==t&&(t="Error"),$.alert({icon:"fa fa-warning",type:"red",title:t,content:e})},$(".ajax-form-submit-btn").on("click",function(e){var t,r,a;return e.preventDefault(),r=$(this).data("title"),a=$(this).data("url"),n.html(""),t={},$(this).parents("form").find(".ajax-form-name").each(function(){var e;if(e=$(this).prop("name"))return t[e]=$(this).val()}),$.get(a,t,function(e){return i(),n.dialog({title:r}).html(e).dialog("open")})}),e.on("click",'input[type="submit"]',function(i){var r,a,o;return i.preventDefault(),a=$(this),r=a.parents("form.ajax-form"),o=r.prop("action"),a.after(SusyConfig.image.loading),a.prop("disabled",!0),$.ajax({url:o,type:"POST",cache:!1,data:new FormData(r[0]),processData:!1,contentType:!1}).always(function(){return a.next("img").remove(),a.prop("disabled",!1)}).done(function(i){return i.redirect_url?(n.dialog("close"),window.location.href=i.redirect_url):"success"===i.status?window.location.reload():i.message?t(i.message):e.html(i)}).fail(function(){return t("Failed!")})})})}.call(this),function(){$(function(){return $("body").on("click",".editableInputInfo img.editableButton",function(){var e;return(e=$(this).parents(".editableInputInfo")).siblings(".editableInputField").show(),e.hide()}),$("body").on("click",".editableInputField img.editableConfirm",function(){var e,t,n,i,r;return e=$(this),n=e.attr("src"),e.attr("src",SusyConfig.image_src.loading),i=e.parents(".editableInputField"),t=i.find(".editableInput"),r=e.data("uri"),$.post(r,{data:t.val()},function(r){var a;return r.error?(e.attr("src",n),e.hide(),alert(r.error),!1):(r.price&&i.parent().siblings(".price").html(r.price).fadeOut().fadeIn(),a=r.data?r.data:t.val(),i.siblings(".editableInputInfo").find(".editableName").html(a),i.siblings(".editableInputInfo").show(),i.hide(),e.attr("src",n))})}),$("body").on("keyup",".editableInputField .editableInput",function(e){if(13===(e.keyCode?e.keyCode:e.which))return $(this).siblings(".editableConfirm").trigger("click")}),$("body").on("click",".editableInputField a.cancel",function(e){var t;return e.preventDefault(),(t=$(this).parents(".editableInputField")).siblings(".editableInputInfo").show(),t.hide()}),$("body").on("change focus",".editableInput",function(e){var t,n;if(t=$(this),n=t.data("auto-complete-url"))return t.autocomplete({source:n,minLength:5,select:function(e,n){var i;return $(".ui-helper-hidden-accessible").remove(),t.data("number-only")&&(n.item.value=n.item.value.match(/\d+/)),i=t.next(".editableConfirm").css({display:"block"}),setTimeout(function(){return i.css({display:"inline"})},50)}})}),$("body").on("click",".editable-text-info .editable-button",function(e){var t;return e.preventDefault(),(t=$(this).parents(".editable-text-info")).hide(),t.next(".editable-text-field").show()}),$("body").on("click",".editable-text-field .cancel",function(e){var t;return e.preventDefault(),(t=$(this).parents(".editable-text-field")).hide(),t.prev(".editable-text-info").show()}),$("body").on("click",".editable-text-field .editable-confirm-button",function(e){var t,n,i,r,a,o,l,s,c;return e.preventDefault(),t=$(this),o=t.prop("src"),c=t.data("uri"),l=t.parents(".editable-text-field"),i=l.prev(".editable-text-info"),r=i.find(".editable-name"),s=l.find("textarea"),n=s.val().trim(),a=SusyConfig.image_src.loading,t.prop("src",a),$.post(c,{data:n},function(e){return e.data?(r.prop("title",e.data).text(e.data).fadeOut().fadeIn(),i.show(),l.hide()):e.message?$.alert(e.message):$.alert("Failed!")}).always(function(){return t.prop("src",o)})}),$("body").on("keyup",".editable-text-field textarea",function(e){if(13===(e.keyCode?e.keyCode:e.which))return $(this).siblings(".editable-confirm-button").trigger("click")})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c;if(0!==(o=$("#pre-payment-form-div")).length)return a=o.find("form"),r=+a.data("country-id"),c=a.data("vat-countries"),e=a.data("apc-exchange-rates"),n=function(){var e,t,n;return e=!0,a.find("input[name], select[name], textarea[name]").each(function(t,n){i($(this))||(e=!1)}),n=$("#pre_payment_amount"),parseFloat(n.val())<=0&&(e=!1,(t=n.parent()).addClass("error"),l(t,"Please enter a valid amount.")),e},i=function(e){var t,n,i,r,a,o;return n=!0,a=e.prop("required"),r=e.prop("pattern")?new RegExp(e.prop("pattern")):null,o=e.val(),i=e.parent("div"),t=null,a&&""===o?(i.addClass("error"),t="Please fill out this field.",n=!1):r&&!r.test(o)?(i.addClass("error"),t=e.prop("title")?e.prop("title"):"Please enter a valid value.",n=!1):i.removeClass("error"),l(i,t),n},l=function(e,t){var n;return null==t&&(t=null),n=e.find("span.error_message"),null===t&&n.length>0?n.remove():(0===n.length&&(e.append('<span class="error_message"></span>'),n=e.find("span.error_message")),n.html(t))},t=function(){var t,n,i,a,o;return a=$("#pre_payment_currency").val(),$(".payment_currency").text(a),t=parseFloat($("#pre_payment_amount").val())||0,i=e[a],$('input[name="form[exchange_rate]"]').val(i),n=parseFloat(t/i),$('input[name="form[amount_in_chf]"]').val(n.toFixed(2)),$("#pre_payment_amount_in_chf").text(n.toFixed(2)),"CHF"===a?$("#pre_payment_amount_in_chf").parent().hide():$("#pre_payment_amount_in_chf").parent().show(),c[r]&&"CHF"===a?(o=$.number(c[r],1,".",""),$("#pre_payment_vat").parent().show()):($("#pre_payment_vat").parent().hide(),o=0),$("#pre_payment_vat").text(o),$('input[name="form[vat]"]').val(o),s()},s=function(){var e,t,n;return e=parseFloat($("#pre_payment_amount").val())||0,n=$('input[name="form[vat]"]').val(),t=parseFloat(e*(1+n/100)),$("#pre_payment_total_amount").text(t.toFixed(2))},t(),o.on("change","#pre_payment_currency, #pre_payment_amount",function(){return t()}),o.on("submit","form",function(e){var t;return e.preventDefault(),!!n()&&(s(),a=o.find("form"),(t=a.find('input[type="submit"]')).prop("disabled",!0),t.after(SusyConfig.image.loading),$.post(a.attr("action"),a.serialize(),function(e){return $("#pre-payment-form-div").html(e)}))}),o.on("click","#edit-pre-payment-form",function(e){return e.preventDefault(),$("#pre-payment-success").hide(),$("#pre-payment-form").show()}),o.on("click","#remove-pre-payment-invoice",function(e){var t;return e.preventDefault(),t=$(this).data("uri"),$.post(t,function(e){return $("#pre-payment-form-div").html(e)})}),o.on("click","#pre_payment_invoice_download_link",function(e){return e.preventDefault(),window.open($(this).prop("href")),window.location.reload()}),$("body").on("click","#show_pre_payment_invoices_button",function(e){return $(this).next("div").slideToggle()})})}.call(this),function(){$(function(){var e;if(0!==$("#manage-publishers").length)return $("#manage-publishers").on("change","#publisher-select-year",function(e){var t;if(t=$(this).find(":selected").data("uri"))return window.location.href=t}),$("#manage-publishers").on("click",".remove-publisher-role",function(e){var t,n;if(n=$(this).data("uri"),t=$(this).data("message"),n&&t)return confirm(t)?$.post(n,function(e){return window.location.reload()}):void 0}),e=$("#update-publisher-managing-journals-dialog").dialog({modal:!0,autoOpen:!1,width:800,height:600,resizable:!0,buttons:{Confirm:function(){var e,t,n;return t=$(this),e=t.find("form"),n=e.prop("action"),$.post(n,e.serialize(),function(e){return t.dialog("close"),window.location.reload()})},Close:function(){return $(this).dialog("close")}}}),$("#manage-publishers").on("click",".update-publisher-managing-journals",function(t){var n;return n=$(this).data("uri"),$.get(n,function(t){return e.html(t).dialog("open"),$(".chosen-select").chosen({no_results_text:"No journal found!",search_contains:!0})})})})}.call(this),function(){$(function(){return $("a.change-award-status").on("click",function(e){return e.preventDefault(),$("#award-status-dialog").dialog({modal:!0,autoOpen:!1,width:400,height:200,resizable:!0}).load($(this).data("load-url")).dialog("open")})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l;if(r=$("a.manuscript-special-issue-notes img"),l=$("a.manuscript-special-issue-notes").length,o=$("#special_issue_id").length,0!==l&&0!==r.length)return a=r.offset(),e=$("#container"),t=e.offset(),n=e.outerWidth(),(i=$(".quickform").eq(0).height()/2)<300&&(i=300),1===l?1===o?window.showNotes("a.manuscript-special-issue-notes","#manuscript-special-issue-notes",!1,function(e,i){return $("#manuscript-special-issue-notes").parents("div.ui-dialog").css({top:t.top+"px",left:t.left+n-350+"px",width:"350px",opacity:1})},function(e,t){return $("#manuscript-special-issue-notes").parents("div.ui-dialog").show().animate({opacity:0,width:"1px",height:"1px",top:a.top+"px",left:a.left+"px"},function(){return $(this).hide()})},{height:300}):window.showNotes("a.manuscript-special-issue-notes","#manuscript-special-issue-notes",!1,function(e,r){return $("#manuscript-special-issue-notes").parents("div.ui-dialog").css({top:t.top+i+10+"px",left:t.left+n-350+"px",width:"350px",opacity:1})},function(e,t){return $("#manuscript-special-issue-notes").parents("div.ui-dialog").show().animate({opacity:0,width:"1px",height:"1px",top:a.top+"px",left:a.left+"px"},function(){return $(this).hide()})},{height:i}):window.showNotes("a.manuscript-special-issue-notes","#manuscript-special-issue-notes",!1,function(e,t){return $("#manuscript-special-issue-notes").parents("div.ui-dialog").css({top:$(document).scrollTop+($(window).height()-300)/2+"px",width:"350px",height:"300px",opacity:1})},function(e,t){return $("#manuscript-special-issue-notes").parents("div.ui-dialog").show().animate({opacity:0,width:"1px",height:"1px",top:a.top+"px",left:a.left+"px"},function(){return $(this).hide()})}),1===r.length?$("a.manuscript-special-issue-notes").trigger("click"):void 0})}.call(this),function(){$(function(){if($("a.displayVoucher").length>=1)return $("a.displayVoucher").click(function(e){var t,n,i;return e.preventDefault(),n="voucher-"+$(this).data("reviewer-rel-id"),t="display-voucher-"+$(this).data("reviewer-rel-id"),i=$(this),$(this).data("voucher-granted")?$("#"+t).dialog({modal:!0,autoOpen:!1,width:550,height:220,resizable:!0}).html($("#"+n).html()).dialog("open"):$("#"+t).dialog({modal:!0,autoOpen:!1,width:550,height:320,resizable:!0,buttons:{Confirm:function(){var e,t,r,a,o;return o={},r={},t=$(this).find(".enable-voucher"),a=t.data("reviewer-id"),o[a]=t.val(),r[a]=t.data("pre-discount"),(e=$(".ui-dialog-buttonpane button:first-child")).attr("disabled","disabled"),e.children("span").html("Confirming..."),$.post(SusyConfig.url.grant_voucher_to_reviewer,{vouchers:o,pre_discounts:r},function(e){return $(".ui-dialog-buttonpane").hide(),alert("The voucher has been granted."),i.html("Voucher Info"),i.attr("data-voucher-granted","true"),t.hide().next("span").html(t.val()),$("#"+n).find(".enable-voucher").hide().next("span").html(t.val())})},Close:function(){return $("#"+t).dialog("close")}}}).html($("#"+n).html()).dialog("open")})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f;if(0!==$("#process_publishing_section").length)return $("#process_publishing_section form").preventDuplicateSubmission(),u=$("#publishing_process_step_2"),l=$("#publishing_download_archive_file"),c=l.data("prepare-url"),s=l.data("download-url"),d=l.data("processing-url"),n=$("#check-pdf-errors-section"),h=function(){var e;return e=$("#form_another_si_file").parents(".row"),1===u.data("has-si-file")?e.show():e.hide()},f=function(e){var t,n,i;return t=e+"%",(i=l.find(".progress")).show(),(n=i.find(".progress-bar")).prop("aria-valuenow",e),n.css("width",t),n.html(t)},o=function(e){var t,n,i,r;return e.preventDefault(),(t=l.find("#download_archive_file_btn")).val("Downloading...").prop("disabled",!0),n=l.find(".error"),i=0,r=0,$.get(c,function(e){var a;return 200===e.status&&e.size&&e.filename?(n.html("").hide(),i=e.size,$.get(s),a=setInterval(function(){return r>=100?(clearInterval(a),window.location.reload()):$.get(d,function(e){return r=(e.size/i*100).toFixed(2),""===e&&(r=100),f(r)})},2e3)):(t.val("Download").prop("disabled",!1),n.html("Download archive file failed, please check the file at redmine issue.").fadeOut().fadeIn(),!1)})},function(){if(0!==$("#publishing_archive_file_info").length)return $.get(c,function(e){var t;return!(200!==e.status||!e.size||!e.filename)&&(t=(e.size/1024/1024).toFixed(2),$("#publishing_archive_file_info").html(e.filename+": "+t+"MB"))})}(),h(),u.find("form").on("submit",function(){if($("#form_another_si_file").length>0&&""!==$("#form_another_si_file").val()&&!confirm("Are you sure the 2nd Supplementary File is needed?"))return!1}),l.on("click","#download_archive_file_btn",o),$("#process_publishing_section").on("click",".remove-file",function(e){var t;if(e.preventDefault(),t=$(this).data("uri"),confirm("Are you sure to remove this file?"))return $.get(t,function(e){return window.location.reload()})}),t=function(e){var t,n,i,r;return r=e.data("original-lastname").trim(),i=e.val().trim(),""===r||""===i||r.toLowerCase()===i.toLowerCase()?e.next(".error").hide():(t=e.next(".error"),n="Last name should be '"+r+"', please check.",t.length>0?t.html(n).fadeOut().fadeIn():e.after('<div class="error">'+n+"</div>").next(".error").fadeOut().fadeIn())},function(){return $("#author-info input[data-original-lastname]").each(function(){return t($(this))})}(),$("#author-info").on("change","input[data-original-lastname]",function(){return t($(this))}),e=function(e){var t,n,i,r;return r=e.data("original-email").trim(),t=e.val().trim(),""===r||""===t||r.toLowerCase()===t.toLowerCase()?e.next(".error").hide():(n=e.next(".error"),i="Email should be '"+r+"', please check.",n.length>0?n.html(i).fadeOut().fadeIn():e.after('<div class="error">'+i+"</div>").next(".error").fadeOut().fadeIn())},function(){return $("#author-info input[data-original-email]").each(function(){return e($(this))})}(),$("#author-info").on("change","input[data-original-email]",function(){return e($(this))}),n.length>0?(i=n.data("uri"),r=$("#confirm-info").find('input[type="submit"]'),a=r.next(".error"),$.get(i,function(e){var t;return t=!1,e.length>0&&(t=!0,$.each(e,function(i,r){if(n.append("<li>"+r+"</li>"),1===e.length&&r.indexOf("file size")>=0)return t=!1})),t?(r.prop("disabled",!0),a.length>0?a.show():r.after('<div class="error">Please check PDF file above.</div>')):(r.prop("disabled",!1),a.hide())})):void 0})}.call(this),function(){$(function(){var e,t,n;if(0!==$("#multipleEmailsForm").length)return $.fn.extend({getFieldValue:function(e){return $.trim($(this).find(e).val())}}),$.fn.extend({getEmails:function(e){return $("span.dynamicEmail",$(this).find(e).parent("div")).map(function(){return $(this).attr("data-rel")})}}),$.fn.extend({addFieldError:function(e,t){var n,i;return null==t&&(t="The field can't be blank"),n='<span class="error-message">'+t+"</span>",(i=$(this).find(e).parent("div").addClass("error")).find(".error-message").length>0?i.find(".error-message").html(t):i.append(n)}}),$.fn.extend({validateEmailForm:function(){var e,t,n,i,r;return t=$(this).getFieldValue(".mailFrom"),i=$(this).getEmails(".mailTo"),n=$(this).getFieldValue(".mailSubject"),e=$(this).getFieldValue(".mailBody"),r=!0,""===t&&($(this).addFieldError(".mailFrom"),r=!1),0===i.length&&($(this).addFieldError(".mailTo",'Please add one or more "TO" recipients'),r=!1),""===n&&($(this).addFieldError(".mailSubject","The mail subject can't be empty"),r=!1),""===e&&($(this).addFieldError(".mailBody","The mail body can't be empty"),r=!1),r&&$(this).find(".error").each(function(){return $(this).removeClass("error").find(".error-message").remove()}),r}}),t=".mailTo, .mailCc, .mailBcc",n=function(){return $("#multipleEmailsForm").attr("action")},e=function(e,t,n){var i,r,a,o,l,s,c;if(a=t.parent("div").find("div.displayEmails"),10===(l=e.which)||13===l||n){for(e.preventDefault(),s=0,c=(r=$.trim(t.val()).split(", ")).length;s<c;s++)i=r[s],-1===a.html().indexOf(i)&&-1!==i.indexOf("@")&&(o=i.replace("<","&lt;").replace("<","&gt;"),t.val(""),$('<span class="dynamicEmail" data-rel="'+i+'">'+o+'<a href="#" class="_removeEmail">x</a></span><br>').appendTo(a));return $("#multipleEmailsForm").on("click","a._removeEmail",function(e){var t,n;return e.preventDefault(),n=$(this).parent("span"),t=n.next("br"),n.remove(),t.remove()})}},$("#multipleEmailsForm").on("keypress",t,function(t,n){return e(t,$(this),n)}).blur(function(t){return e(t,$(this),!0)}),$(t).trigger("keypress",[!0]),$(t).autocomplete({source:$("#multipleEmailsForm").data("email-autocomplete-url"),minLength:3,select:function(e,t){var n;return n=$(this),setTimeout(function(){return n.trigger("keypress",[!0]),n.val("")},200)}}),$("#sendingMultipleEmails").on("click",function(e){var t,i,r,a,o,l,s;if(e.preventDefault(),o=$(this),a=o.data("referer-url"),t=o.data("auto-redirect"),r=$("#multipleEmailsForm").find(".multiple_email_section"),i=!0,r.each(function(){var e;if(!(i=$(this).validateEmailForm()))return e=$(this).find("div.error").first(),$("html, body").animate({scrollTop:e.offset().top},500),!1}),i)return o.hide().after("<div style='display: inline-block; height: 24px; line-height: 24px;'>"+SusyConfig.image.loading+" Sending emails ...</div>"),s=r.length,l=0,r.each(function(){var e,i,r,c,u,d,h;return h=n(),$(this).data("send-email-url")&&(h=$(this).data("send-email-url")),c=$(this).getFieldValue(".mailFrom"),d=$(this).getEmails(".mailTo"),r=$(this).getEmails(".mailCc"),e=$(this).getEmails(".mailBcc"),u=$(this).getFieldValue(".mailSubject"),i=$(this).getFieldValue(".mailBody"),$.post(h,{action_uri:n(),from:c,to:d.get().join(", "),cc:r.get().join(", "),bcc:e.get().join(", "),subject:u,body:i},function(e){return+e>0?(l++,s===l?t?window.location=a:(o.nextAll("div").remove(),o.after('<div>Your messages have been successfully delivered. <a href="'+a+'">Back to the previous page</a></div>')):void 0):(o.nextAll("div").remove(),o.show().after('<div class="error"> Sorry, it seems something went wrong, send email failed! Error: '+e+"</div>"))})})})})}.call(this),function(){$(function(){var e,t,n;if(0!==$("#uploadedAttachments").length&&0!==$("#uploadAttachmetDialog").length)return e=function(){return $("#mailForm").length>0?$("#mailForm").attr("action"):$("#multipleEmailsForm").length>0?$("#multipleEmailsForm").attr("action"):$("form.QuickForm2").attr("action")},n=function(n){var i;return i=n.html(),new AjaxUpload(n,{action:$("#addAttachment").data("url"),name:"attachment",data:{action_uri:e()},onSubmit:function(e,t){return n.html(SusyConfig.image.loading),this.disable()},onComplete:function(e,r){return""!==r?$("#uploadAttachmentInfo").html(r):$("#uploadAttachmentInfo").html("Uploaded attachment: "+e),$("#uploadAttachmentInfo").show(),t(),n.html(i),this.enable()}})},t=function(){return $("#uploadedAttachments").load($("#addAttachment").data("load-url"))},$("#uploadAttachmetDialog").dialog({modal:!0,autoOpen:!1,beforeclose:function(e,t){},width:400,height:200,resizable:!1,buttons:{Done:function(){return $(this).dialog("close")}}}),$("#addAttachment").on("click",function(e){return e.preventDefault(),$("#uploadAttachmentInfo").hide(),$("#uploadAttachmetDialog").dialog("open"),n($("#uploadAttachmentBtn"))}),$("#uploadedAttachments").on("click","a.deleteAttachment",function(e){return e.preventDefault(),$.get($(this).attr("href"),function(e){return t()}),$(this).replaceWith(SusyConfig.image.loading)}),t()})}.call(this),function(){$(function(){var e,t,n,i,r,a,o;if(t=$("a.manuscript-special-issue-guest-editor-notes img"),0!==(o=$("a.manuscript-special-issue-guest-editor-notes").length)&&0!==t.length)return n=t.offset(),$("#manuscriptDetails"),i=$("#maincol"),r=i.offset(),a=i.outerWidth(),(e=$(".quickform").eq(0).height()/2)<300&&(e=300),1===o?window.showNotes("a.manuscript-special-issue-guest-editor-notes","#manuscript-special-issue-guest-editor-notes",!1,function(t,n){return $("#manuscript-special-issue-guest-editor-notes").parents("div.ui-dialog").css({top:$(document).scrollTop+($(window).height()-300)/2+"px",left:r.left+a/4+"px",width:"350px",height:e+"px",opacity:1})},function(e,t){return $("#manuscript-special-issue-guest-editor-notes").parents("div.ui-dialog").show().animate({opacity:0,width:"1px",height:"1px",top:n.top+"px",left:n.left+"px"},function(){return $(this).hide()})},{height:e}):window.showNotes("a.manuscript-special-issue-guest-editor-notes","#manuscript-special-issue-guest-editor-notes",!1,function(e,t){return $("#manuscript-special-issue-guest-editor-notes").parents("div.ui-dialog").css({top:$(document).scrollTop+($(window).height()-300)/2+"px",left:r.left+a/4+"px",width:"350px",height:"300px",opacity:1})},function(e,t){return $("#manuscript-special-issue-guest-editor-notes").parents("div.ui-dialog").show().animate({opacity:0,width:"1px",height:"1px",top:n.top+"px",left:n.left+"px"},function(){return $(this).hide()})})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o;if(0!==(o=$("#english-invoice-form")).length){for(o.data("credit-surcharge"),o.data("apc-exchange-rates"),o.data("vat-countries"),+o.data("china-id"),+o.data("switzerland-id"),+o.data("credit-payment-id"),a=o.data("save-url"),o.data("disable-vat"),o.data("english-invoice-payment-currency"),r={},n=0,i=(t=["english-invoice-name","english-invoice-address1","english-invoice-address2","english-invoice-city","english-invoice-zipcode","english-invoice-country"]).length;n<i;n++)r[e=t[n]]=$("#"+e).val();return $("#save-english-invoice-btn").on("click",function(){var e,t,n,i,r,o,l,s,c,u,d,h;for(h={},i=0,o=(n=["english-invoice-membership-institute","english-invoice-address1","english-invoice-address2","english-invoice-city","english-invoice-name","english-order-email","english-invoice-email","english-invoice-country","english-invoice-zipcode","english-invoice-telephone","english-invoice-fax","english-invoice-authorvat","form__token"]).length;i<o;i++)t=n[i],h[(e=$("#"+t)).attr("name")]=e.val();for(h.payment_method=$('input[name="payment_method"]:checked').val(),s=document.getElementById("english-invoice-payment-currency"),h.payment_currency=s.options[s.selectedIndex].value,d=!0,r=0,l=(u=["english-invoice-name","english-order-email","english-invoice-email","english-invoice-address1","english-invoice-city","english-invoice-country","english-invoice-zipcode"]).length;r<l;r++)c=u[r],""===(e=$("#"+c)).val()?(d=!1,e.parent("div").addClass("error")):e.parent("div").removeClass("error");if(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test($("#english-invoice-email").val())?$("#english-invoice-email").parent("div").removeClass("error"):(d=!1,$("#english-invoice-email").parent("div").addClass("error")),void 0===h.payment_currency?($("#english-invoice-payment-currency div").addClass("error"),d=!1):$("#english-invoice-payment-currency div").removeClass("error"),void 0===h.payment_method?($("#section-payment-method div").addClass("error"),d=!1):$("#section-payment-method div").removeClass("error"),d)return $.post(a,h,function(e){var t;if(e)return $("div.author-invoice").hide(),(t=$("div.author-invoice:last")).html(e).show(),$("html, body").animate({scrollTop:t.offset().top},500)});$("html, body").animate({scrollTop:$("#english-invoice-address-sec").offset().top},500)}),$("div.author-invoice").on("click","#english-invoice-confirm-btn",function(){return window.location.href=$(this).data("url")}),$("div.author-invoice").on("click","#english-invoice-modify-link",function(e){return e.preventDefault(),$("div.author-invoice").show(),$("div.author-invoice:last").hide()})}})}.call(this),function(){0!==$("#searchAllReviewers").length&&($("#searchAllReviewers").on("click",function(e){var t;return e.preventDefault(),(t=$("#all-reviewers-dialog")).dialog({modal:!0,autoOpen:!1,width:1200,height:"auto",resizable:!0,buttons:[{text:"Add Selected Reviewer",click:function(){var e,n;return n=t.data("uri"),e=[],$("#all-reviewers-dialog").find(".check_reviewer:checked").each(function(){var t;return t={},$(this).siblings(".reviewer_info_form").find("*[name]").each(function(){var e,n;return n=$(this).val(),e=$(this).prop("name"),t[e]=n}),e.push(t)}),0===e.length?(alert("Please select at least one reviewer"),!1):$.post(n,{form:e},function(e){return e>0?window.location.reload():alert("Add reviewers failed")})}},{text:"Close",click:function(){return $(this).dialog("close")}}]}),t.dialog("open")}),$("#all-reviewers-search-input").on("keyup",function(e){if(13===e.keyCode)return $("#all-reviewers-search-btn").click()}),$("#all-reviewers-search-btn").on("click",function(e){var t,n,i,r;return e.preventDefault(),(r=$(this)).val("Searching").prop("disabled",!0),t=$("#all-reviewers-search-input").val().trim(),n=$("#mdpi-reviewers-section"),i=$("#scilit-reviewers-section"),n.html(SusyConfig.image.loading),i.html(SusyConfig.image.loading),$.get(n.data("uri"),{keywords:t},function(e){return n.html(e),r.val("Search").prop("disabled",!1)}),$.get(i.data("uri"),{keywords:t},function(e){return i.html(e),r.val("Search").prop("disabled",!1)})}),$("#manuscript-reviewers-search-input").on("keyup",function(e){if(13===e.keyCode)return $("#manuscript-reviewers-search-btn").click()}),$("#manuscript-reviewers-search-btn").on("click",function(e){var t,n,i,r;return e.preventDefault(),(r=$(this)).val("Searching").prop("disabled",!0),t=$("#manuscript-reviewers-search-input").val().trim(),n=$("#mdpi-reviewers-section"),i=$("#scilit-reviewers-section"),n.html(SusyConfig.image.loading),i.html(SusyConfig.image.loading),$.get(n.data("uri2"),{keywords:t},function(e){return n.html(e),r.val("Search").prop("disabled",!1)}),$.get(i.data("uri"),{keywords:t},function(e){return i.html(e),r.val("Search").prop("disabled",!1)})}),$("#special-issue-reviewers-search-input").on("keyup",function(e){if(13===e.keyCode)return $("#special-issue-reviewers-search-btn").click()}),$("#special-issue-reviewers-search-btn").on("click",function(e){var t,n,i,r;return e.preventDefault(),(r=$(this)).val("Searching").prop("disabled",!0),t=$("#special-issue-reviewers-search-input").val().trim(),n=$("#mdpi-reviewers-section"),i=$("#scilit-reviewers-section"),n.html(SusyConfig.image.loading),i.html(SusyConfig.image.loading),$.get(n.data("uri3"),{keywords:t},function(e){return n.html(e),r.val("Search").prop("disabled",!1)}),$.get(i.data("uri"),{keywords:t},function(e){return i.html(e),r.val("Search").prop("disabled",!1)})}),$("#mdpi-reviewers-section").on("click",".show-refine-journals",function(){return $(this).next().slideToggle()}),$("#mdpi-reviewers-section").on("click",".refine-journal-btn",function(e){var t,n;return e.preventDefault(),t=[],n=$(this).data("url"),$(this).parent().find("input.journal_id:checked").each(function(){return t.push($(this).val())}),$(this).prop("disabled",!0).after(SusyConfig.image.loading),$.get(n,{journal_id:t.join(",")},function(e){return $("#mdpi-reviewers-section").html(e)})}),$("#mdpi-reviewers-section").on("change","#filter_volunteer_reviewer",function(e){var t,n;return e.preventDefault(),n=$(this).data("url"),t=$(this).is(":checked")?1:0,$(this).next().after(SusyConfig.image.loading),$.get(n,{filter_volunteer:t},function(e){return $("#mdpi-reviewers-section").html(e)})}),$("#scilit-reviewers-section").on("click",".show-abstract",function(){var e,t;return t=$(this).data("abstract-id"),e=$(this),$("#"+t).toggle("slow",function(){return $(this).is(":visible")?e.html("Hide Abstract"):e.html("Show Abstract")})}),$("#all-reviewers-dialog").on("click",".rdb_overview",function(e){var t,n;return e.preventDefault(),n=$(this).data("url"),t=$("#rdb-overview-dialog").dialog({modal:!0,autoOpen:!1,width:800,height:500,resizable:!0}),$.get(n,function(e){return t.html(e).dialog("open")})}),$("#all-reviewers-dialog").on("click",".historyInvitations",function(e){var t,n;return e.preventDefault(),(t=$("#manuscript-history-reviewer-invitations")).dialog({modal:!0,autoOpen:!1,width:600,height:300,resizable:!0}),n=$(this).data("url"),$.get(n,function(e){return t.html(e).dialog("open")})}),$("#all-reviewers-dialog").on("click",".show_reviewer_info_btn",function(e){var t,n;return e.preventDefault(),n=$(this).data("dialog-id"),(t=$("#"+n)).dialog({modal:!0,autoOpen:!1,width:600,height:"auto",resizable:!0}),t.dialog("open")}))}.call(this),function(){$(function(){var e,t,n;if(0!==$("#ethics_checklist_section").length)return(e=$("#ethics_checklist_section")).load(e.data("ethics-url"),function(){return n()}),t=function(){var e;return $("#form_checklist_1_0").is(":checked")&&$("#form_checklist_1a_1").is(":checked")?(e="<div id='check-approval-label' style='color:red; font-weight:bold;'>Contact authors to confirm ethical approval and obtain the name of the review board and approval number.</div>",0===$("#check-approval-label").length?$("#form_checklist_1a_1").parent().append(e):void 0):$("#check-approval-label").remove()},n=function(n){return null==n&&(n=null),t(),n?"1"===n.val()&&n.is(":checked")?n.parent().next(".children").show():n.parent().next(".children").hide():e.find('input[type="radio"]').each(function(){var e;if("1"===(e=$(this)).val()&&e.is(":checked"))return e.parent().next(".children").show()})},e.on("click",'input[type="submit"]',function(t){var i,r,a;return t.preventDefault(),r=$(this),i=$(this).parents("form"),a=i.prop("action"),r.after(SusyConfig.image.loading),r.prop("disabled",!0),$.ajax({url:a,type:"POST",cache:!1,data:new FormData(i[0]),processData:!1,contentType:!1}).done(function(t){return r.next("img").remove(),r.prop("disabled",!1),"success"===t.status?window.location.reload():(e.html(t),n())})}),e.on("change",'input[type="radio"]',function(){return n($(this))}),e.on("click",".edit_ethics_form",function(){return e.find(".edit_form").show(),e.find(".show_checklist").hide()})})}.call(this),function(){$(function(){var e;if(0!==$("#same-title-ms-act").length)return e=$("#manuscript-same-browser").dialog({modal:!0,autoOpen:!1,width:800,height:400,resizable:!0}),$("#same-title-ms-act").on("click",function(t){return t.preventDefault(),$.get($(this).data("url"),function(t){return e.html(t).dialog("open")})})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d,h;if(0!==$("#selectMembershipInstituteShare").length||0!==$("#selectMembershipInstitute").length){if($("#submission-stage-apc-information").length>0)h=$("#submission-stage-apc-information"),a=h.data("hash-key"),c=+h.data("membership-id"),u=+h.data("membership-payment-type"),o=h.data("journal-apc"),l=h.data("manuscript-apc-confirmed"),s=+$("#selectMembershipInstituteShare").val();else{if(!($("#form-invoice").length>0))return;r=$("#form-invoice"),a=r.data("hash-key"),c=+r.data("membership-institute-id"),u=+r.data("membership-payment-type-selection"),s=+$("#selectMembershipInstitute").val()}return i=function(e){var t;return(e=+e)===c&&2===u?(t="Institute Removed from Central: Invoiced to author!",$("#membership_payment_type_selection").html(t).show()):$("#membership_payment_type_selection").hide()},t=function(e){return e=+e,$.get(SusyConfig.url.check_eligible_url,{hash_key:a,membership_id:e},function(t){var n;switch(t){case"0":n="Check eligibility for central billing with authors";break;case"1":n="Authors confirmed central billing";break;case"2":n="Authors not eligible for central billing";break;default:n=47===e||64===e?"Check eligibility for central billing with authors":""}return n?$("#is_eligible").html(n).show():$("#is_eligible").html("").hide()})},e=function(e){var t;return t=$("#is_central_payment").data("central-payment-text"),$.get(SusyConfig.url.check_central_payment_url,{hash_key:a,membership_id:e},function(e){var n;switch(e){case"1":n=t+" - ON";break;case"2":n=t+" - OFF";break;default:n=""}return n?$("#is_central_payment").html(n).show():$("#is_central_payment").html("").hide()})},t(s),e(s),i(s),$("#selectMembershipInstituteShare").chosen({no_results_text:"Institutional Open Access Program not found!",width:"100%",search_contains:!0}),$("#selectMembershipInstituteShare").length>0&&((n=function(e){var t,n,i,r;if(i=$('#selectMembershipInstituteShare option[value="'+e+'"]'),!l&&1===i.length&&i.data("is-central-for-corresponding"))return r=i.data("ioap-name"),n=i.data("discount"),t="Only "+r+" <b>corresponding</b> authors are entitled to the "+n+"% APC discount of the "+r+" IOAP. Please double-check if the corresponding author is affiliated with "+r+".",$.alert({icon:"fa fa-warning",type:"orange",useBootstrap:!1,boxWidth:"100%",title:"Caution",content:t})})(s),$("#selectMembershipInstituteShare").on("change",function(){var r,a;return a=$("#selectMembershipInstituteShare option:selected").data("discount"),a=a||0,$("#ioap-percentage").text(a),$("#ioap-amount").text(a/100*o),(r=$("#selectMembershipInstituteShare option:selected").data("country-id"))&&$('input[name="country_id"]').val(r),$('input[name="member_institute_id"]').val($("#selectMembershipInstituteShare").val()),t($("#selectMembershipInstituteShare").val()),e($("#selectMembershipInstituteShare").val()),i($("#selectMembershipInstituteShare").val()),n($("#selectMembershipInstituteShare").val())})),"#selectMembershipInstitute".length>0?((d=function(){return $("#selectMembershipInstitute option:selected").data("is-central-payment")?$("#billing_switch_central_payment").show():$("#billing_switch_central_payment").hide()})(),$("#selectMembershipInstitute").on("change",function(){return t($("#selectMembershipInstitute").val()),e($("#selectMembershipInstitute").val()),i($("#selectMembershipInstitute").val()),d()}),$("#billing_switch_central_payment").on("change",'input[type="checkbox"]',function(){var t,n;return n=$("#billing_switch_central_payment").data("url"),t=$(this).is(":checked")?1:0,$(this).siblings("label").prop("title",null!=t?t:{"Turn OFF":"Turn ON"}),s=$("#selectMembershipInstitute").val(),$.post(n,{membership_id:s,payment_type:t},function(){return e(s)})})):void 0}})}.call(this),function(){$(function(){var e;if(0!==$(".ithenticate-section").length)return $(".ithenticate-section").on("click",".ithenticate-upload-btn",function(t){var n,i,r,a;if(t.preventDefault(),r=$(this),i=r.parents(".ithenticate-section"),n=i.find(".ithenticate-message"),confirm("Are you sure to upload file to iThenticate?"))return $.blockUI({message:'<p class="margin-1">File uploading to iThenticate server. Please wait ...</p>'}),a=r.data("upload-url"),$.post(a,function(t){return $.unblockUI(),"ERROR"===t.status?n.addClass("error").html(t.message).show():"OK"===t.status?(r.hide(),n.removeClass("error").html("File uploaded - waiting for report").show(),e(i)):alert("iThenticate service is unstable, please refresh the page and try to upload file later.")})}),e=function(e){var t,n,i,r;return n=e.find(".ithenticate-upload-btn"),t=e.find(".ithenticate-message"),r=e.data("status-url"),i=e.data("report-url"),$.get(r,function(e){var r,a,o,l,s,c,u;return"OK"===e.status&&e.data?(n.hide(),s=parseInt(e.data.response_status),u=e.data.name,o=e.data.percent_match,c=e.data.submit_date,r=e.data.is_pending,l=e.data.report_id,200===s?(a="<b>Uploaded by "+u+"</b><br><b>Uploaded at: "+c+"</b><br><b>Percent match: "+o+"%</b>",a+=!r&&l?"<br><b><a target='_blank' rel='noopener noreferrer' href='"+i+"'>iThenticate report</a></b>":"<br><b>Pending... <a href='javascript:void(0);' onclick='window.location.reload(false);'>Refresh</a></b>",t.removeClass("error").html(a).show()):s?n.show():(a="Uploaded by "+u+", uploaded at: "+c+", but no response.",t.addClass("error").html(a).show(),n.show())):(n.show(),404===e.code?t.removeClass("error").html("").hide():e.message?t.addClass("error").html(e.message).show():t.addClass("error").html("Unknown error.").show())})},$(".ithenticate-section").each(function(){return e($(this))})})}.call(this),function(){$(function(){return window.showNotes(".assignedEditorNotes","#assigned-editor-notes-dialog"),$(".delete-ae-absence").on("click",function(e){var t;if(e.preventDefault(),t=$(this).data("url"),confirm("Do you want to delete this absence?"))return $.post(t,function(e){return"success"===e.status?window.location.reload():alert("Failed")})})})}.call(this),function(){$(function(){var e;if(0!==$(".notify").length)return setTimeout(function(){return $(".notify-backdrop").remove(),$(".notify-delay").remove()},5e3),$(document).on("click",".notify-backdrop",function(e){return e.preventDefault(),hide($(".notify"))}),$(document).on("click",".notify-buttons > button",function(e){return e.preventDefault(),hide($(this).parent().parent())}),$(document).on("click","[data-close='notify']",function(t){return t.preventDefault(),e($(this).parent())}),e=function(e){return $("body").removeClass("notify-open"),$(".notify-backdrop").css("opacity",0),""!==e.data("animation")?(e.addClass(e.data("animation")),$("body").removeClass("notify-open-drop"),setTimeout(function(){return $(".notify-backdrop").remove(),e.remove()},500)):($(".notify-backdrop").remove(),e.remove())}})}.call(this),function(){$(function(){var e,t,n,i,r,a,o,l,s,c,u,d,h,f;if(0!==$("#common-invoice-edit-form").length)return s=$("#common-invoice-edit-form"),e=s.data("apc-exchange-rates"),c=s.data("invoice-exchange-rate"),u=s.data("invoice-payment-currency"),d=s.data("invoice-vat"),f=s.data("vat-countries"),a=function(){var e,t;return e=$("#form_related_id").val(),t=SusyConfig.url.ajax_get_ioap_info_url.replace(/0$/,e),$.get(t,function(e){return $("#form_country_id").val(e.country_id).trigger("chosen:updated"),$("#form_institution").val(e.institute),$("#form_department").val(e.department),$("#form_name").val(e.name),$("#form_invoice_email").val(e.invoice_email),$("#form_order_email").val(e.email),$("#form_address1").val(e.address1),$("#form_address2").val(e.address2),$("#form_city").val(e.city),$("#form_zipcode").val(e.zipcode)})},t=function(){var e;return e=$("#form_country_id").val(),f[e]?(d=parseFloat(f[e]),$("#form_vat").prop("disabled",!1).val(d)):$("#form_vat").val(0),n()},n=function(){var t,n;return t=$("#form_payment_currency").val(),$(".invoice-currency").text(t),n=t===u?c:e[t],$("#form_exchange_rate").val(n),h()},l=function(){var e,t;return e=parseFloat($("#form_exchange_rate").val()),t=$("#form_fees_waiver_val").val(),!$.isNumeric(t)||t<0?(alert("Invalid waiver"),!1):(t=parseFloat(t)/e,$("#form_fees_waiver").val(t),h())},r=function(){var e;return e=$("#form_discount").val(),!$.isNumeric(e)||e<0||e>100?(alert("Invalid discount"),!1):h()},o=function(){var e;return e=$("#form_vat").val(),!$.isNumeric(e)||e<0||e>100?(alert("Invalid vat"),!1):h()},i=function(){return $("#form_vat_disabled").is(":checked")?$("#form_vat").val(0).prop("disabled",!0):$("#form_vat").prop("disabled",!1).val(d),h()},h=function(){var e,t,n,i,r,a,o,l,s,c,u;return n=parseFloat($("#form_exchange_rate").val()),e=parseFloat($("#form_fees_base").val()),c=parseFloat($("#form_fees_waiver").val()),i=parseFloat($("#form_discount").val()),s=$("#form_vat_disabled").is(":checked")?0:parseFloat($("#form_vat").val()),o=e*(100-i)/100-c,r=o*(100+s)/100,t=(e*n).toFixed(2),u=(c*n).toFixed(2),l=(o*n).toFixed(2),a=(r*n).toFixed(2),o<0?(alert("Total amount is below zero, please check"),!1):($("#fees_base_val").text(t),$("#form_fees_waiver_val").val(u),$("#total_without_vat_val").text(l),$("#total_with_vat_val").text(a))},$("#form_related_id").on("change",a),$("#form_country_id").on("change",t),$("#form_payment_currency").on("change",n),$("#form_fees_waiver_val").on("change",l),$("#form_discount").on("change",r),$("#form_vat").on("change",o),$("#form_vat_disabled").on("change",i),s.on("submit",h),t()}),$(function(){if(0!==$("#common-invoices-list").length)return $("#common-invoices-list").on("click",".common-invoice-reminder-button",function(e){var t,n;return e.preventDefault(),n=$(this).data("send-reminder-url"),t=[],$("input.reminder-checkbox:checked").each(function(){return t.push($(this).val())}),0===t.length?$.alert("No invoices selected!"):(n=n.replace(/0$/,t.join(",")),window.location.href=n)}),$("#common-invoices-show-reminders").on("change",function(e){var t,n;return e.preventDefault(),t=$(this).data("original-url"),n=$(this).data("show-reminders-url"),$(this).is(":checked")?window.location.href=n:window.location.href=t})})}.call(this),function(){$(function(){var e;if(0!==$("#display_feed").length)return e=$("#feed_browser").dialog({modal:!0,autoOpen:!1,width:700,height:500,resizable:!0}),$("#display_feed").on("click",function(t){return t.preventDefault(),$.get($(this).data("url"),function(t){return e.html(t).dialog("open")})}),$("#feed_browser").on("click","a.feed-contents",function(e){return e.preventDefault(),$("#feed_contents_dialog").dialog({modal:!1,autoOpen:!1,width:700,height:500,resizable:!0}).html("").load($(this).data("url")).dialog("open")})}),$(function(){var e;if(0!==$(".display_feed").length)return e=$("#feed_browser").dialog({modal:!0,autoOpen:!1,width:700,height:500,resizable:!0}),$(".display_feed").on("click",function(t){return t.preventDefault(),$.get($(this).data("url"),function(t){return e.html(t).dialog("open")})}),$("#feed_browser").on("click","a.feed-contents",function(e){return e.preventDefault(),$("#feed_contents_dialog").dialog({modal:!1,autoOpen:!1,width:700,height:500,resizable:!0}).html("").load($(this).data("url")).dialog("open")})})}.call(this),function(){$(function(){if(0!==$(".form-check-parent").length)return $(".form-check-parent").on("change",function(e){return e.preventDefault(),$(this).prop("checked")?$(".form-check-child").prop("checked",!0):$(".form-check-child").prop("checked",!1)})})}.call(this),function(){$(function(){var e,t,n;if(0!=="#user-manage-accounts".length)return n=$("#user-manage-accounts"),e=$("#user-add-email-section"),t=$("#user-merge-accounts-section"),n.find("form").on("submit",function(e){return e.preventDefault()}),n.on("click",".set-primary-email, .unlink-email",function(e){var t,n,i,r;return e.preventDefault(),r=$(this).data("uri"),n=$(this).data("message"),$(this).hasClass("danger")?(t="fa fa-trash",i="red"):(t="fa fa-info",i="blue"),$.confirm({icon:t,type:i,title:"Confirm",content:n,useBootstrap:!1,boxWidth:"60%",buttons:{confirm:{btnClass:"btn-blue",action:function(){return $.post(r,function(e){return e.error?$.alert(e.error):e.redirect_url?window.location.href=e.redirect_url:window.location.reload()})}},cancel:function(){}}})}),$("#user-add-email-btn").on("click",function(n){var i,r,a,o;return n.preventDefault(),i=$(this),o=i.data("uri"),r=$("#user-add-email-input").val().trim(),a=$("#user-add-email-input").next(".error"),r?(a.hide(),o=o.replace(/\/email$/,"/"+r),i.prop("disabled",!0),i.after(SusyConfig.image.loading),$.get(o,function(n){return n.error?(t.html("").hide(),a.html(n.error).fadeOut().fadeIn()):(a.hide(),e.hide(),t.html(n).show())}).always(function(){return i.prop("disabled",!1),i.next("img").remove()})):a.html("Please enter email.").fadeOut().fadeIn()}),$("#user-add-email-input").on("keyup",function(e){if(e.preventDefault(),13===(e.keyCode?e.keyCode:e.which))return $("#user-add-email-btn").trigger("click")}),t.on("click","#back",function(n){return n.preventDefault(),t.html("").hide(),e.show()}),t.on("click","#merge-account-submit-btn",function(e){var n,i,r;return e.preventDefault(),n=$(this),r=n.data("uri"),(i=t.find('input[type="password"]').val().trim())?(n.prop("disabled",!0),n.after(SusyConfig.image.loading),$.post(r,{password:i},function(e){return e.error?$.alert(e.error):e.redirect_url?window.location.href=e.redirect_url:window.location.reload()}).always(function(){return n.prop("disabled",!1),n.next("img").remove()})):$.alert("Please enter password")})})}.call(this),function(){$(function(){return $(".words_confirm_section").on("click",".words_confirm_btn",function(e){var t,n,i;return e.preventDefault(),t=$(this),n=t.parents(".words_confirm_section"),i=t.data("uri"),$.confirm({icon:"fa fa-info",type:"blue",title:"Confirm words number",content:"Have you checked the words number?",buttons:{confirm:{btnClass:"btn-blue",action:function(){var e;return e=t.clone(),n.html(SusyConfig.image.loading),$.post(i,function(t){return t?n.html(t):n.html(e)}).fail(function(){return n.html(e)})}},cancel:function(){}}})})})}.call(this),function(){$(function(){var e,t,n,i,r;return n=!1,r=function(){return $(window).width()<767&&!n?(n=!0,$("table.responsive-table").each(function(){return t($(this))}),!0):n&&$(window).width()>767?(n=!1,$("table.responsive-table").each(function(){return i($(this))})):void 0},t=function(t){var n;return t.wrap('<div class="table-wrapper" />'),(n=t.clone()).removeClass("responsive-table"),t.closest(".table-wrapper").append(n),n.wrap('<div class="pinned" />'),t.wrap('<div class="scrollable" />'),e(t,n)},i=function(e){return e.closest(".table-wrapper").find(".pinned").remove(),e.unwrap(),e.unwrap()},e=function(e,t){var n,i,r;return i=e.find("tr"),r=t.find("tr"),n=[],i.each(function(e){return n[e]=$(this).outerHeight(!0)}),r.each(function(e){return $(this).height(n[e])})},$(window).load(r),$(window).on("redraw",function(){return n=!1,r()}),$(window).on("resize",r)})}.call(this),function(){$(function(){var e,t,n;if(0!==$(".expand-form").length)return t=$(".expand-form").find(".row"),e=function(){return t.hide(),t.first().show(),t.last().show()},n=function(){return t.slideDown()},$(".expand-form").find("legend").append('<div class="float-right"><a href="javascript:void(0);" id="show-hide-button" class="button small secondary margin-0">expand</a></div>'),e(),$("#show-hide-button").on("click",function(){return"expand"===$(this).text()?($(this).text($(this).text().replace("expand","collapse")),n()):($(this).text($(this).text().replace("collapse","expand")),e())})}),$(function(){var e,t,n;if(0!==$(".expand-manuscript-form").length)return t=$(".expand-manuscript-form").find(".row"),e=function(){return t.each(function(e,t){if($(t).find(".fold-element").length>0)return $(t).hide()})},n=function(){return t.each(function(e,t){if($(t).find(".fold-element").length>0)return $(t).show()})},$(".expand-manuscript-form").find("legend").append('<div class="float-right"><a href="javascript:void(0);" id="show-hide-button" class="button small secondary margin-0">expand</a></div>'),e(),$("#show-hide-button").on("click",function(){return"expand"===$(this).text()?($(this).text($(this).text().replace("expand","collapse")),n()):($(this).text($(this).text().replace("collapse","expand")),e())})})}.call(this),function(){$(function(){var e,t,n,i,r,a,o;if(0!==$("#special-issue-planned-papers-form").length)return o=$("#special-issue-planned-papers-form"),i=$("#edit-planned-papers-dialog"),n=i.dialog({modal:!0,autoOpen:!1,width:1200,height:"auto",resizable:!0}),r=function(){return $(".date-select").datepicker({dateFormat:"yy-mm-dd",showAnim:"fadeIn",changeMonth:!0,changeYear:!0}),$(".tag-editor").tagEditor({delimiter:";",maxLength:200,forceLowercase:!1,joinWithSpace:!0})},t=function(){var e;if(e=i.find("#form_status_id").val(),$("#status-interested-section").removeClass("background-color-warning"),$("#status-agreed-section").removeClass("background-color-warning"),$("#status-title-provided-section").removeClass("background-color-warning"),$("#status-submitted-section").removeClass("background-color-warning"),e>=1&&$("#status-interested-section").addClass("background-color-warning"),e>=2&&$("#status-agreed-section").addClass("background-color-warning"),e>=3&&$("#status-title-provided-section").addClass("background-color-warning"),e>=4)return $("#status-submitted-section").addClass("background-color-warning")},e=function(){var e,t,n;if(e=$("#form_hash_key"),t=e.val())return n=e.data("uri"),n=n.replace(/\/0$/,"/"+t),$.get(n,function(e){var t,n,i,r,a,o;if(e.article_title&&$("#form_article_title").val(e.article_title),e.article_abstract&&$("#form_article_abstract").val(e.article_abstract),e.authors.length>0){for(i=[],t=[],r=0,a=(o=e.authors).length;r<a;r++)n=o[r],i.push(n.name),n.corresponding&&n.affiliation&&t.push(n.affiliation);if($("#form_author_names").tagEditor("destroy"),$("#form_author_names").tagEditor({initialTags:i,delimiter:";",maxLength:200,forceLowercase:!1,joinWithSpace:!0}),t.length>0)return $("#form_affiliation").val(t[0])}})},function(){var e;if((e=window.location.hash)&&1===$(e).length)return $("html, body").animate({scrollTop:$(e).offset().top},500)}(),a=function(){return $.ui.dialog.prototype._focusTabbable=function(){return!1}},o.on("submit",function(e){return e.preventDefault(),o.find(".add-planned-paper-btn").trigger("click")}),o.on("click",".add-planned-paper-btn",function(e){var t,n,l,s;return e.preventDefault(),s=$(this).data("uri"),n=o.find('input[type="email"]'),l=o.prop("action"),t=n.val().trim(),$.get(s,{email:t},function(e){return"failed"===e.status&&e.message?($.alert({icon:"fa fa-warning",type:"red",title:"Error",content:e.message}),!1):(s=l+"?email="+t,$.get(s,function(e){return a(),i.html(""),i.html(e).dialog("open"),r()}))})}),o.on("click",".edit-planned-paper-btn",function(e){var n;return e.preventDefault(),n=$(this).prop("href"),$.get(n,function(e){return a(),i.html(""),i.html(e).dialog("open"),r(),t()})}),i.on("click",'input[type="submit"]',function(e){var t,a,o;return e.preventDefault(),a=$(this),t=a.parents("form.ajax-form"),o=t.prop("action"),a.after(SusyConfig.image.loading),a.prop("disabled",!0),$.ajax({url:o,type:"POST",cache:!1,data:new FormData(t[0]),processData:!1,contentType:!1}).done(function(e){return a.next("img").remove(),a.prop("disabled",!1),e.redirect_url?(n.dialog("close"),window.location.href=e.redirect_url):"success"===e.status?(window.location.hash="#special-issue-planned-papers-form",window.location.reload(!0)):e.message?$.alert({icon:"fa fa-warning",type:"red",title:"Error",content:e.message}):(i.html(e),r())})}),i.on("change","#form_status_id",t),i.on("change","#form_hash_key",e)})}.call(this),function(){$(function(){return window.showNotes("a.editor-notes-btn","#academic-editor-notes-dialog")})}.call(this),function(){$(function(){var e,t;if($(".user-hint-btn").on("click",function(e){var t,n;return e.preventDefault(),(t=$(this).parent().next(".menu")).not(":visible")&&t.show(),n=t.data("menu"),introJs().setOptions({showStepNumbers:!1,showBullets:!1,steps:[{element:"#left-menu-main-container ul.menu.user-hint[data-menu='"+n+"']",intro:t.data("hint")}]}).start()}),$('#left-menu-main-container div[data-hint-enabled="1"]').length>0&&(t=function(){return $.post(SusyConfig.url.user_hinted_url)},e=[],$("#left-menu-main-container ul.menu.user-hint").each(function(t,n){var i,r;return $(this).not(":visible")&&$(this).show(),i="menu-user-hint-step"+t,$(this).prop("id",i),r={element:"#"+i,intro:$(this).data("hint")},e.push(r)}),e.length>0))return introJs().setOptions({steps:e}).start().oncomplete(function(){return t()}).onskip(function(){return t()})})}.call(this);